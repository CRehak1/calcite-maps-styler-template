/*! Storymaps-MyStory - v1.0.0 - 2015-10-09, 06:08:16 PM - Copyright Esri 2015 */define("my/models/Credentials",[],function(){"use strict";var e={},t=function(){e={userName:"",token:"",portal:null,orgId:"",groups:[],firstName:"",accountCreatedDate:null}},n=function(t){for(var n in t)t.hasOwnProperty(n)&&t[n]&&(n==="portal"?e[n]=$.extend(!0,{},t[n]):n==="groups"?e[n]=t[n].slice():e[n]=t[n])},r=function(){var t=$.extend(!0,{},e.portal),n={userName:e.userName,token:e.token,portal:t,orgId:e.orgId,groups:e.groups.slice(),firstName:e.firstName,accountCreatedDate:e.accountCreatedDate};return n},i=function(){t()};return t(),{setCredentials:n,getCredentials:r,destroyCredentials:i}}),define("my/helpers/Formatter",["dojo/number","dojo/date/locale"],function(e,t){"use strict";var n=function(e){var t="",n="";return e?(n=r(e),n.length>=230?t=n.slice(0,230)+"...":t=n):t=i18n.storyMap.placeholders.noDescription,t},r=function(e){var t=e.replace(/<.*?>.*?/gi,"").replace(/&amp;/gi,"&").replace(/&#39;/gi,"'").replace(/&quot;/gi,'"').replace(/&nbsp;/gi," ");return t},i=function(e){var t=e.replace(/http(s?):\/\//gi,"");return t},s=function(e){var t="",n=e||"";return t=r(n),t},o=function(t){var n="";return app.cfg.isEnglish?n=t===1?window.engStrings.numViewsSingle.replace(/{{NUM_VIEWS}}/g,e.format(t)):window.engStrings.numViewsPlural.replace(/{{NUM_VIEWS}}/g,e.format(t)):n=i18n.storyMap.numViews.replace(/{{NUM_VIEWS}}/g,e.format(t)),n},u=function(e){var t="";return app.cfg.isEnglish?t=window.engStrings.authorsStories.replace(/{{USER_NAME}}/g,e):t=i18n.header.userStories.replace(/{{USER_NAME}}/g,e),t},a=function(e){if(e instanceof Date){var n=t.format(e,{selector:"date",formatLength:"long"});return n}return e},f=function(e){var t=a(e),n=i18n.storyMap.modified.replace(/{{DATE}}/g,t);return n},l=function(e){var t="";for(var n=0;n<e.typeKeywords.length;n++)switch(e.typeKeywords[n].toLowerCase()){case"map tour":return t="Map Tour",t;case"mapjournal":return t="Map Journal",t;case"swipe":case"spyglass":case"swipespyglass":return t="Swipe/Spyglass",t;case"mapseries":return t="Map Series",t;default:}for(var r=0;r<e.tags.length;r++)switch(e.tags[r].toLowerCase()){case"map tour":return t="Map Tour",t;case"map journal":return t="Map Journal",t;case"swipe":case"spyglass":return t="Swipe/Spyglass",t;case"shortlist":return t="Shortlist",t;case"countdown":return t="Countdown",t;case"playlist":return t="Playlist",t;case"side accordion":return t="Side Accordion",t;case"basic":t||(t="Basic");break;case"custom":t||(t=i18n.types.custom);break;default:}return t||(t=i18n.types.notSpecified),t},c=function(e){var t="";return app.cfg.isEnglish?t=e===1?window.engStrings.totalStoriesSingle.replace(/{{NUM_STORIES}}/g,e):window.engStrings.totalStoriesPlural.replace(/{{NUM_STORIES}}/g,e):t=i18n.header.totalStories.replace(/{{NUM_STORIES}}/g,e),t},h=function(e,t){var n={enable:!0,login:app.cfg.bitly.login,key:app.cfg.bitly.key},r=["http://api.bitly.com/v3/shorten?callback=?","https://api-ssl.bitly.com/v3/shorten?callback=?"],i=location.protocol==="http:"?r[0]:r[1],s=e;$.getJSON(i,{format:"json",apiKey:n.key,login:n.login,longUrl:s},function(e){var n="";!e||!e.data.url?n=s:n=e.data.url,typeof t=="function"&&t(n)}).fail(function(){typeof t=="function"&&t(s)})},p=function(e){var t="",n=i18n.content.info.ownedBy;return e?t=n.replace(/{{USER_NAME}}/g,e):t=n.replace(/{{USER_NAME}}/g,i18n.content.info.unknownUser),t},d=function(e){var t="";return e&&(t=e.replace(/(.*?):\/\//,"//")),t},v=function(e,t){var n="";return e==="story"?t==="public"?n=i18n.content.notification.storyPublic:t==="organization"?n=i18n.content.notification.storyOrg:t==="private"&&(n=i18n.content.notification.storyPrivate):e==="map"?t==="public"?n=i18n.content.notification.mapPublic:t==="organization"?n=i18n.content.notification.mapOrg:t==="private"&&(n=i18n.content.notification.mapPrivate):e==="layer"?t==="public"?n=i18n.content.notification.layerPublic:t==="organization"?n=i18n.content.notification.layerOrg:t==="private"&&(n=i18n.content.notification.layerPrivate):e==="content"&&(t==="public"?n=i18n.content.notification.contentPublic:t==="organization"?n=i18n.content.notification.contentOrg:t==="private"&&(n=i18n.content.notification.contentPrivate)),n},m=function(e,t,n,r,i,s){var o="";return n?o=g(e,s):r?o=i18n.content.notification.premiumPublicSuccess:i?o=i18n.content.notification.subscriptionPublicSuccess:o=v(t,e),o},g=function(e,t){var n="";return window.builderIntegration?n=y(e,t):e==="public"?n=i18n.content.notification.storyAndContentPublic:e==="organization"?n=i18n.content.notification.storyAndContentOrg:e==="private"&&(n=i18n.content.notification.storyAndContentPrivate),n},y=function(e,t){var n="";return e==="public"?n=b(t):e==="organization"?n=w(t):e==="private"&&(n=E(t)),n},b=function(e){var t="";return e==="both"?t=i18n.content.notification.layersAndMapsPublic:e==="maps"?t=i18n.content.notification.mapsPublic:e==="layers"&&(t=i18n.content.notification.layersPublic),t},w=function(e){var t="";return e==="both"?t=i18n.content.notification.layersAndMapsOrg:e==="maps"?t=i18n.content.notification.mapsOrg:e==="layers"&&(t=i18n.content.notification.layersOrg),t},E=function(e){var t="";return e==="both"?t=i18n.content.notification.layersAndMapsPrivate:e==="maps"?t=i18n.content.notification.mapsPrivate:e==="layers"&&(t=i18n.content.notification.layersPrivate),t};return{formatDescription:n,removeURLProtocol:i,formatTitle:s,formatNumViews:o,formatPageBanner:u,cleanHtmlText:r,formatDateString:a,formatModifiedString:f,getStoryMapType:l,formatNumStories:c,formatBitlyLink:h,formatMapLayerOwner:p,unProtocolUrl:d,formatNotificationString:m}}),define("my/helpers/ImageHelper",[],function(){"use strict";window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var e="assets/images/my-stories/placeholders/",t=["forest.png","boat.png","desert.png","mts.png","city.png","spaceship.png"],n=0,r=function(){var r=t[n],i="";return n===t.length-1?n=0:n++,i=e+r,i};return{getRandomPlaceholderImage:r}}),define("my/models/Item",["dojo/Deferred","esri/request","esri/arcgis/utils","my/models/Credentials","my/helpers/Formatter","my/helpers/ImageHelper"],function(e,t,n,r,i,s){"use strict";var o=function(e){var t=e.item,n=window.location.protocol+"//www.arcgis.com/home/item.html?id=",r=i.unProtocolUrl(t.url),o=window.location.protocol+r,a=u(t.thumbnailUrl),f={index:e.index,title:i.formatTitle(t.title),id:t.id,type:e.type?e.type:i.getStoryMapType(t),modified:t.modified,modifiedLocalizedDate:i.formatDateString(t.modified),modifiedStr:i.formatModifiedString(t.modified),accessLevel:t.access==="org"?"organization":t.access==="account"?"organization":t.access==="shared"?"private":t.access,hasOwnImage:a?!0:!1,thumbnail:a?t.thumbnailUrl:s.getRandomPlaceholderImage(),largeThumbnail:t.largeThumbnail,url:o,userItemUrl:"",agolUrl:n+t.id,shortUrl:"",embedUrl:'<iframe width="100%" height="800px" src="'+o+'"></iframe>',numViews:t.numViews,numViewsStr:i.formatNumViews(t.numViews),description:i.formatDescription(t.description),snippet:t.snippet,collectionTag:"",yourTags:null,allTags:t.tags,allClear:!0,nominatedToGallery:!1,ignoreServiceOkItemNot:!1,typeKeywords:t.typeKeywords};return f},u=function(e){var t=!0,n=null,r=!1;return e===null?t=!1:(n=new RegExp("(//www.arcgis.com/sharing.rest.content.items/).*(/info/thumbnail/ago_downloaded.png).*"),r=n.test(e),r&&(t=!1)),t},a=function(e,t){e.index=t},f=function(i,s){var o=new e,u=r.getCredentials(),a={f:"json"},f=n.arcgisUrl.split("/items")[0],l=f+"/users/"+u.userName+"/items/"+i.id+"/update",c=i.userItemUrl+"/update",h=i.userItemUrl?c:l,p={};return s.title&&(i.title=s.title,a.title=s.title),s.snippet&&(i.snippet=s.snippet,a.snippet=s.snippet),s.typeKeywords&&(i.typeKeywords=s.typeKeywords,a.typeKeywords=s.typeKeywords),p=t({url:h,content:a},{usePost:!0}),p.then(function(){o.resolve()},function(){o.reject()}),o.promise},l=function(e){var r=n.arcgisUrl.split("/items")[0],i=r+"/users/"+e.user+"/items/"+e.item.id+"/delete",s=e.item.userItemUrl+"/delete",o=e.item.userItemUrl?s:i,u=t({url:o,content:{f:"json"}},{usePost:!0});u.then(function(){e.success&&typeof e.success=="function"&&e.success()},function(t){var n=!1;t.message==="Unable to delete item. Delete protection is turned on."&&(n=!0),e.error(n)})};return{createItem:o,updateItemIndex:a,updateItem:f,deleteItem:l}}),define("handlebars/safe-string",["exports"],function(e){function t(e){this.string=e}t.prototype.toString=function(){return""+this.string},e["default"]=t}),define("handlebars/utils",["./safe-string","exports"],function(e,t){function o(e){return r[e]}function u(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function c(e){return e instanceof n?e.toString():e==null?"":e?(e=""+e,s.test(e)?e.replace(i,o):e):e+""}function h(e){return!e&&e!==0?!0:l(e)&&e.length===0?!0:!1}function p(e,t){return(e?e+".":"")+t}var n=e["default"],r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,s=/[&<>"'`]/;t.extend=u;var a=Object.prototype.toString;t.toString=a;var f=function(e){return typeof e=="function"};f(/x/)&&(f=function(e){return typeof e=="function"&&a.call(e)==="[object Function]"});var f;t.isFunction=f;var l=Array.isArray||function(e){return e&&typeof e=="object"?a.call(e)==="[object Array]":!1};t.isArray=l,t.escapeExpression=c,t.isEmpty=h,t.appendContextPath=p}),define("handlebars/exception",["exports"],function(e){function n(e,n){var r;n&&n.firstLine&&(r=n.firstLine,e+=" - "+r+":"+n.firstColumn);var i=Error.prototype.constructor.call(this,e);for(var s=0;s<t.length;s++)this[t[s]]=i[t[s]];r&&(this.lineNumber=r,this.column=n.firstColumn)}var t=["description","fileName","lineNumber","message","name","number","stack"];n.prototype=new Error,e["default"]=n}),define("handlebars/base",["./utils","./exception","exports"],function(e,t,n){function h(e,t){this.helpers=e||{},this.partials=t||{},p(this)}function p(e){e.registerHelper("helperMissing",function(){if(arguments.length===1)return undefined;throw new i("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var i=n.inverse,s=n.fn;if(t===!0)return s(this);if(t===!1||t==null)return i(this);if(a(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var o=m(n.data);o.contextPath=r.appendContextPath(n.data.contextPath,n.name),n={data:o}}return s(t,n)}),e.registerHelper("each",function(e,t){if(!t)throw new i("Must pass iterator to #each");var n=t.fn,s=t.inverse,o=0,u="",l,c;t.data&&t.ids&&(c=r.appendContextPath(t.data.contextPath,t.ids[0])+"."),f(e)&&(e=e.call(this)),t.data&&(l=m(t.data));if(e&&typeof e=="object")if(a(e))for(var h=e.length;o<h;o++)l&&(l.index=o,l.first=o===0,l.last=o===e.length-1,c&&(l.contextPath=c+o)),u+=n(e[o],{data:l});else for(var p in e)e.hasOwnProperty(p)&&(l&&(l.key=p,l.index=o,l.first=o===0,c&&(l.contextPath=c+p)),u+=n(e[p],{data:l}),o++);return o===0&&(u=s(this)),u}),e.registerHelper("if",function(e,t){return f(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){f(e)&&(e=e.call(this));var n=t.fn;if(!r.isEmpty(e)){if(t.data&&t.ids){var i=m(t.data);i.contextPath=r.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}return t.inverse(this)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var r=e,i=t["default"],s="2.0.0";n.VERSION=s;var o=6;n.COMPILER_REVISION=o;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};n.REVISION_CHANGES=u;var a=r.isArray,f=r.isFunction,l=r.toString,c="[object Object]";n.HandlebarsEnvironment=h,h.prototype={constructor:h,logger:d,log:v,registerHelper:function(e,t){if(l.call(e)===c){if(t)throw new i("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){l.call(e)===c?r.extend(this.partials,e):this.partials[e]=t},unregisterPartial:function(e){delete this.partials[e]}};var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(d.level<=e){var n=d.methodMap[e];typeof console!="undefined"&&console[n]&&console[n].call(console,t)}}};n.logger=d;var v=d.log;n.log=v;var m=function(e){var t=r.extend({},e);return t._parent=e,t};n.createFrame=m}),define("handlebars/runtime",["./utils","./exception","./base","exports"],function(e,t,n,r){function f(e){var t=e&&e[0]||1,n=o;if(t!==n){if(t<n){var r=u[n],i=u[t];throw new s("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new s("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function l(e,t){if(!t)throw new s("No environment passed to template");if(!e||!e.main)throw new s("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n=function(n,r,o,u,a,f,l,c,h){a&&(u=i.extend({},u,a));var p=t.VM.invokePartial.call(this,n,o,u,f,l,c,h);if(p==null&&t.compile){var d={helpers:f,partials:l,data:c,depths:h};l[o]=t.compile(n,{data:c!==undefined,compat:e.compat},t),p=l[o](u,d)}if(p!=null){if(r){var v=p.split("\n");for(var m=0,g=v.length;m<g;m++){if(!v[m]&&m+1===g)break;v[m]=r+v[m]}p=v.join("\n")}return p}throw new s("The partial "+o+" could not be compiled when running in runtime-only mode")},r={lookup:function(e,t){var n=e.length;for(var r=0;r<n;r++)if(e[r]&&e[r][t]!=null)return e[r][t]},lambda:function(e,t){return typeof e=="function"?e.call(t):e},escapeExpression:i.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n){var r=this.programs[e],i=this.fn(e);return t||n?r=c(this,e,i,t,n):r||(r=this.programs[e]=c(this,e,i)),r},data:function(e,t){while(e&&t--)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=i.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler},o=function(t,n){n=n||{};var i=n.data;o._setup(n),!n.partial&&e.useData&&(i=d(t,i));var s;return e.useDepths&&(s=n.depths?[t].concat(n.depths):[t]),e.main.call(r,t,r.helpers,r.partials,i,s)};return o.isTop=!0,o._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,t.helpers),e.usePartial&&(r.partials=r.merge(n.partials,t.partials)))},o._child=function(t,n,i){if(e.useDepths&&!i)throw new s("must pass parent depths");return c(r,t,e[t],n,i)},o}function c(e,t,n,r,i){var s=function(t,s){return s=s||{},n.call(e,t,e.helpers,e.partials,s.data||r,i&&[t].concat(i))};return s.program=t,s.depth=i?i.length:0,s}function h(e,t,n,r,i,o,u){var a={partial:!0,helpers:r,partials:i,data:o,depths:u};if(e===undefined)throw new s("The partial "+t+" could not be found");if(e instanceof Function)return e(n,a)}function p(){return""}function d(e,t){if(!t||!("root"in t))t=t?a(t):{},t.root=e;return t}var i=e,s=t["default"],o=n.COMPILER_REVISION,u=n.REVISION_CHANGES,a=n.createFrame;r.checkRevision=f,r.template=l,r.program=c,r.invokePartial=h,r.noop=p}),define("handlebars.runtime",["./handlebars/base","./handlebars/safe-string","./handlebars/exception","./handlebars/utils","./handlebars/runtime","exports"],function(e,t,n,r,i,s){var o=e,u=t["default"],a=n["default"],f=r,l=i,c=function(){var e=new o.HandlebarsEnvironment;return f.extend(e,o),e.SafeString=u,e.Exception=a,e.Utils=f,e.escapeExpression=f.escapeExpression,e.VM=l,e.template=function(t){return l.template(t,e)},e},h=c();return h.create=c,h["default"]=h,s=h["default"],s}),define("my/helpers/HandlebarsHelpers",["Handlebars"],function(e){"use strict";(function(){e.registerHelper("ifEquals",function(e,t,n){return e===t?n.fn(this):n.inverse(this)}),e.registerHelper("ifGreaterThan",function(e,t,n){return e>t?n.fn(this):n.inverse(this)}),e.registerHelper("injectValueQuoted",function(e,t){var n=e.replace(/{{LAYER_NAME}}/g,'"'+t+'"');return n})})()}),define("text",{}),define("lib-build/hbars",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("lib-build/hbars!my/content/Infographics",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'	<div class="infographic">\r\n		<div class="infographic-text">\r\n			<h5 class="header-font infographic-title">'+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+'</h5>\r\n			<h3 class="item-subtitle infographic-value header-font">'+u((i=(i=t.value||(e!=null?e.value:e))!=null?i:o,typeof i===s?i.call(e,{name:"value",hash:{},data:r}):i))+'</h3>\r\n		</div>\r\n		<div class="infographic-image">\r\n			<div class="infographic-icon '+u((i=(i=t.img||(e!=null?e.img:e))!=null?i:o,typeof i===s?i.call(e,{name:"img",hash:{},data:r}):i))+'"></div>\r\n		</div>\r\n	</div>\r\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return i=t.each.call(e,e!=null?e.infographics:e,{name:"each",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null?i:""},useData:!0})}),define("lib-build/hbars!my/content/scanning/ScanProgress",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a='<div id="scanning-in-progress" class="scanning-row container">\r\n	<div id="progress-bar-container" class="centered">\r\n		';return i=(s=(s=t.progressBarWidget||(e!=null?e.progressBarWidget:e))!=null?s:u,typeof s===o?s.call(e,{name:"progressBarWidget",hash:{},data:r}):s),i!=null&&(a+=i),a+"\r\n	</div>				\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/scanning/ScanDone",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a="function",f=t.helperMissing;return'<div id="scanning-done" class="scanning-row container">\r\n	<div class="progress-row">\r\n		<h2 class="progress-title">'+u(o((i=e!=null?e.labels:e)!=null?i.done:i,e))+" "+u((s=(s=t.issueStr||(e!=null?e.issueStr:e))!=null?s:f,typeof s===a?s.call(e,{name:"issueStr",hash:{},data:r}):s))+"</h2>\r\n	</div>\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/scanning/ScanStop",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'<div id="scanning-aborted" class="scanning-row container">\r\n	<div class="progress-row">\r\n		<h2 class="progress-title">'+u((i=(i=t.stoppedStatement||(e!=null?e.stoppedStatement:e))!=null?i:o,typeof i===s?i.call(e,{name:"stoppedStatement",hash:{},data:r}):i))+"</h2>				\r\n	</div>\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/scanning/ScanError",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return'<div id="scanning-error" class="scanning-row container">\r\n	<div class="progress-row leader-1">\r\n		<h2 class="progress-title">'+o(s((i=e!=null?e.labels:e)!=null?i.scanAllError:i,e))+"</h2>				\r\n	</div>\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/Header",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f=this.lambda;return'<div id="header-container" class="container">\r\n	<div class="row">\r\n		<div class="column-14 plumb-left">\r\n			<h1 id="title">'+a((s=(s=t.title||(e!=null?e.title:e))!=null?s:u,typeof s===o?s.call(e,{name:"title",hash:{},data:r}):s))+'</h1>\r\n			<h4 id="num-stories" class="header-stat icon-open-book"></h4>\r\n			<h4 id="num-issues" class="header-stat icon-stories-error-inverse"></h4>\r\n		</div>\r\n		<div id="quote-container" class="column-10">				\r\n			<p id="header-quote-text">'+a(f((i=e!=null?e.data:e)!=null?i.mainQuote:i,e))+'</p>\r\n			<span id="header-quote-author">-- '+a(f((i=e!=null?e.data:e)!=null?i.quoteSource:i,e))+'</span>\r\n		</div>\r\n	</div>\r\n	<div id="header-controls" class="row">\r\n		<div class="tooltip above column-5 plumb-left">\r\n			<input id="search" class="clear-button header-fadeable header-disabled" type="text" placeholder="'+a(f((i=e!=null?e.data:e)!=null?i.searchStories:i,e))+'">\r\n			<div class="tooltip-wrapper header-fadeable-tooltip">\r\n				<span class="tooltip-content">'+a(f((i=e!=null?e.data:e)!=null?i.headerDisabledTooltip:i,e))+'</span>\r\n			</div>\r\n		</div>		\r\n		<div class="column-13">\r\n			<div id="sort" class="header-dropdown-container">\r\n				<div class="tooltip above header-fadeable header-disabled">					\r\n					<div id="sort-button" class="btn header-dropdown-button clear-button header-fadeable header-disabled header-button">\r\n						<span id="sort-text">'+a(f((i=e!=null?e.data:e)!=null?i.sort:i,e))+'</span>\r\n						<div id="sort-arrow" class="icon-sort-down-2"></div>\r\n					</div>\r\n					<br>\r\n					<div id="sort-dropdown" class="header-dropdown">\r\n						<div class="dropdown-option selected" data-criteria="modified">\r\n							<span class="icon-stories-check-inverted dropdown-check"></span>\r\n							<span class="dropdown-option-text">'+a(f((i=e!=null?e.data:e)!=null?i.dateModified:i,e))+'</span>\r\n						</div>\r\n						<div class="dropdown-option" data-criteria="title">\r\n							<span class="icon-stories-check-inverted dropdown-check"></span>\r\n							<span class="dropdown-option-text">'+a(f((i=e!=null?e.data:e)!=null?i.title:i,e))+'</span>\r\n						</div>\r\n						<div class="dropdown-option" data-criteria="num-views">\r\n							<span class="icon-stories-check-inverted dropdown-check"></span>\r\n							<span class="dropdown-option-text">'+a(f((i=e!=null?e.data:e)!=null?i.views:i,e))+'</span>\r\n						</div>\r\n						<div class="dropdown-option" data-criteria="all-clear">\r\n							<span class="icon-stories-check-inverted dropdown-check"></span>\r\n							<span class="dropdown-option-text">'+a(f((i=e!=null?e.data:e)!=null?i.errors:i,e))+'</span>\r\n						</div>					\r\n					</div>\r\n					<div class="tooltip-wrapper header-fadeable-tooltip">\r\n						<span class="tooltip-content">'+a(f((i=e!=null?e.data:e)!=null?i.headerDisabledTooltip:i,e))+'</span>\r\n					</div>\r\n				</div>			\r\n			</div><!--\r\n		 --><div id="filter" class="header-dropdown-container">\r\n				<div class="tooltip above header-fadeable header-disabled">\r\n					<div id="filter-button" class="btn header-dropdown-button clear-button header-fadeable header-disabled header-button">\r\n						<span>'+a(f((i=e!=null?e.data:e)!=null?i.filter:i,e))+'</span>\r\n						<div id="sort-arrow" class="icon-sort-down-2"></div>\r\n					</div>\r\n					<br>\r\n					<div id="filler" class="icon-stories-check-inverted"></div>\r\n					<div id="filter-dropdown" class="header-dropdown">\r\n						<div>\r\n							<div class="dropdown-subheader">'+a(f((i=e!=null?e.data:e)!=null?i.apps:i,e))+'</div>\r\n							<div class="dropdown-option" data-category="type" data-value="Map Journal">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.engStrings:e)!=null?i.mapJournal:i,e))+'</span>\r\n							</div>\r\n							<div class="dropdown-option" data-category="type" data-value="Map Tour">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.engStrings:e)!=null?i.mapTour:i,e))+'</span>\r\n							</div>\r\n							<div class="dropdown-option" data-category="type" data-value="Map Series">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.engStrings:e)!=null?i.mapSeries:i,e))+'</span>\r\n							</div>\r\n							<div class="dropdown-option" data-category="type" data-value="Swipe/Spyglass">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.engStrings:e)!=null?i.swipeSpyglass:i,e))+'</span>\r\n							</div>\r\n						</div>\r\n						<div>\r\n							<div class="dropdown-subheader">'+a(f((i=e!=null?e.data:e)!=null?i.sharing:i,e))+'</div>\r\n							<div class="dropdown-option" data-category="accessLevel" data-value="public">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.sharingLevels:e)!=null?i["public"]:i,e))+'</span>\r\n							</div>\r\n							<div class="dropdown-option" data-category="accessLevel" data-value="organization">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.sharingLevels:e)!=null?i.organization:i,e))+'</span>\r\n							</div>\r\n							<div class="dropdown-option" data-category="accessLevel" data-value="private">\r\n								<span class="icon-stories-check-inverted dropdown-check"></span>\r\n								<span class="dropdown-option-text">'+a(f((i=e!=null?e.sharingLevels:e)!=null?i["private"]:i,e))+'</span>\r\n							</div>\r\n						</div>\r\n					</div>\r\n					<div class="tooltip-wrapper header-fadeable-tooltip">\r\n						<span class="tooltip-content">'+a(f((i=e!=null?e.data:e)!=null?i.headerDisabledTooltip:i,e))+'</span>\r\n					</div>\r\n				</div>\r\n			</div><!--\r\n		 --><div id="clear" class="header-dropdown-container">\r\n		 		<div id="clear-button" class="btn header-dropdown-button clear-button header-fadeable header-disabled header-button">\r\n		 			<span id="search-results"></span>\r\n		 			<span id="clear-icon" class="icon-clear-second"></span>\r\n		 		</div>\r\n			</div>\r\n		</div>		\r\n		<div class="column-6 plumb-right">			\r\n			<div class="tooltip above right">\r\n				<div id="scan-all-stories" class="btn clear-button header-fadeable header-disabled header-button icon-analytics">'+a(f((i=e!=null?e.data:e)!=null?i.checkYourStories:i,e))+'</div>\r\n				<div class="tooltip-wrapper header-fadeable-tooltip">\r\n					<span class="tooltip-content">'+a(f((i=e!=null?e.data:e)!=null?i.headerDisabledTooltip:i,e))+'</span>\r\n				</div>\r\n			</div>\r\n			<div id="create-story-button-container" class="tooltip above">\r\n				<div id="create-story-btn" class="btn modal-show clear-button header-fadeable create-story-disabled header-button icon-map-pin" data-modal="create-story">'+a(f((i=e!=null?e.data:e)!=null?i.createStory:i,e))+'</div>\r\n				<div class="tooltip-wrapper create-disabled-tooltip create-story">\r\n					<span class="tooltip-content">'+a(f((i=e!=null?e.data:e)!=null?i.headerDisabledTooltip:i,e))+"</span>\r\n				</div>\r\n			</div>\r\n		</div>		\r\n	</div>		\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/Loading",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'	<p class="progress-title single-text">'+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+"</p>\r\n"},3:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'	<h2 class="progress-title">'+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+"</h2>\r\n"},5:function(e,t,n,r){return" small"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.small:e,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(3,r),data:r}),i!=null&&(s+=i),s+='<div class="loader',i=t["if"].call(e,e!=null?e.small:e,{name:"if",hash:{},fn:this.program(5,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s+'">\r\n	<span class="side side-left"><span class="fill"></span></span>\r\n	<span class="side side-right"><span class="fill"></span></span>		\r\n</div>'},useData:!0})}),define("lib-build/hbars!my/content/dialogs/DeleteDialog",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return'<div class="modal delete-modal" data-modal="delete-item">\r\n	<div class="dialog-header">\r\n		<a class="modal-dismiss icon-close" href="#"></a>\r\n		<h4>'+o(s((i=e!=null?e.data:e)!=null?i.title:i,e))+'</h4>\r\n	</div>\r\n	<div class="dialog-body">		\r\n		<p>'+o(s((i=e!=null?e.data:e)!=null?i.warningText:i,e))+'</p>\r\n		<button class="btn item-delete icon-delete modal-dismiss" id="delete-confirm">'+o(s((i=e!=null?e.data:e)!=null?i.deleteText:i,e))+'</button>		\r\n		<button class="btn modal-dismiss icon-cancel" id="delete-cancel">'+o(s((i=e!=null?e.data:e)!=null?i.cancel:i,e))+"</button>\r\n	</div>	\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/dialogs/ShareDialog",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return" no-show"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a=t.helperMissing,f="function",l='<div class="modal share-modal" data-modal="share-story">\r\n	<div id="share-header" class="dialog-header padding-leader-1 padding-trailer-1">\r\n		<h3 class="dialog-title">'+u(o((i=e!=null?e.labels:e)!=null?i.title:i,e))+'</h3>\r\n	</div>	\r\n	<div id="share-body" class="dialog-body">\r\n		<div class="centered leader-1">			\r\n			<div id="not-public-container" class="trailer-half';return i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.sharingLevel:e,"public",{name:"ifEquals",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(l+=i),l+'">\r\n				<span id="not-public-explanation">'+u(o((i=e!=null?e.labels:e)!=null?i.notPublicWarning:i,e))+'</span>\r\n			</div>\r\n			<div class="link-text-container">\r\n				<div id="shortlink-icon" class="link-text-icon share icon-copy" data-clipboard-text="'+u((s=(s=t.shortLink||(e!=null?e.shortLink:e))!=null?s:a,typeof s===f?s.call(e,{name:"shortLink",hash:{},data:r}):s))+'" data-link-type="share"></div>\r\n				<input id="item-sharing-link-text" class="share-text small-link" value="'+u((s=(s=t.shortLink||(e!=null?e.shortLink:e))!=null?s:a,typeof s===f?s.call(e,{name:"shortLink",hash:{},data:r}):s))+'" readonly/>\r\n				<span id="shortlink-copied-message" class="embed-alert-text copied-message">'+u(o((i=e!=null?e.labels:e)!=null?i.copied:i,e))+'</span>\r\n			</div>\r\n		</div>\r\n		<hr id="share-line">\r\n		<div>\r\n			<div class="centered">\r\n				<h4 id="embed-explanation">'+u(o((i=e!=null?e.labels:e)!=null?i.embedStory:i,e))+'</h4>\r\n			</div>\r\n			<div id="dimensions-container" class="leader-1 trailer-1 row">\r\n				<div class="embed-dimensions static centered column-6">\r\n					<h5 class="dimensions-title">'+u(o((i=e!=null?e.labels:e)!=null?i.small:i,e))+'</h5>\r\n					<h5 class="dimensions">640px / 480px</h5>\r\n				</div>\r\n				<div class="embed-dimensions static centered column-6">\r\n					<h5 class="dimensions-title">'+u(o((i=e!=null?e.labels:e)!=null?i.medium:i,e))+'</h5>\r\n					<h5 class="dimensions">800px / 600px</h5>\r\n				</div>\r\n				<div class="embed-dimensions static centered active column-6">\r\n					<h5 class="dimensions-title">'+u(o((i=e!=null?e.labels:e)!=null?i.large:i,e))+'</h5>\r\n					<h5 class="dimensions">100% / 800px</h5>\r\n				</div>\r\n				<div class="embed-dimensions custom centered column-6">\r\n					<h5 class="dimensions-title embed-custom-title">'+u(o((i=e!=null?e.labels:e)!=null?i.custom:i,e))+'</h5>\r\n					<input class="embed-custom-size width" type="text" placeholder="'+u(o((i=e!=null?e.labels:e)!=null?i.widthAbbreviation:i,e))+'">\r\n					<span> / </span>\r\n					<input class="embed-custom-size height" type="text" placeholder="'+u(o((i=e!=null?e.labels:e)!=null?i.heightAbbreviation:i,e))+'">\r\n				</div>\r\n				<span id="embed-error-text" class="embed-alert-text">'+u(o((i=e!=null?e.labels:e)!=null?i.emptyDimension:i,e))+'</span>									\r\n			</div>		\r\n			<div id="embed-text-container" class="leader-half trailer-1">\r\n				<div id="embed-icon" class="link-text-icon embed icon-copy" data-clipboard-text="'+u((s=(s=t.embedUrl||(e!=null?e.embedUrl:e))!=null?s:a,typeof s===f?s.call(e,{name:"embedUrl",hash:{},data:r}):s))+'" data-link-type="embed"></div>				\r\n				<textarea id="embed-link" class="share-text" rows="4" readonly>'+u((s=(s=t.embedUrl||(e!=null?e.embedUrl:e))!=null?s:a,typeof s===f?s.call(e,{name:"embedUrl",hash:{},data:r}):s))+'</textarea>\r\n				<span id="embed-copied-message" class="embed-alert-text copied-message">'+u(o((i=e!=null?e.labels:e)!=null?i.copied:i,e))+'</span>\r\n			</div>\r\n			<div class="centered trailer-half">\r\n				<button id="example-button" class="btn clear">'+u(o((i=e!=null?e.labels:e)!=null?i.seeExample:i,e))+'</button>\r\n			</div>\r\n		</div>\r\n		<button id="close-share" class="btn modal-dismiss close-dialog">'+u(o((i=e!=null?e.dialogLabels:e)!=null?i.close:i,e))+"</button>\r\n	</div>	\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/tabs/Maps",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return"column-9"},3:function(e,t,n,r){return"column-7"},5:function(e,t,n,r){return""},7:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u='			<td class="';return i=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(8,r),inverse:this.program(10,r),data:r}),i!=null&&(u+=i),u+'">'+o(s((i=e!=null?e.data:e)!=null?i.storyComponent:i,e))+"</td>\r\n"},8:function(e,t,n,r){return"column-3"},10:function(e,t,n,r){return"column-5"},12:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='		<tr class="media-row';return s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'">				\r\n			<td class="column-2 item-status-column">\r\n				<div class="tooltip above">\r\n					<div class="media-item-status',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(15,r,i),inverse:this.program(17,r,i),data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'"></div>\r\n					<div class="tooltip-wrapper',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(19,r,i),data:r}),s!=null&&(c+=s),c+='">\r\n						<div class="tooltip-content">\r\n',s=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(21,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='						</div>\r\n					</div>\r\n				</div>					\r\n			</td>\r\n			<td class="media-title map',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(23,r,i),inverse:this.program(25,r,i),data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" title="'+f((o=(o=t.title||(e!=null?e.title:e))!=null?o:a,typeof o===u?o.call(e,{name:"title",hash:{},data:r}):o))+'">'+f((o=(o=t.title||(e!=null?e.title:e))!=null?o:a,typeof o===u?o.call(e,{name:"title",hash:{},data:r}):o)),s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(27,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(27,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(27,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='\r\n			</td>\r\n			<td class="column-6">\r\n				<div class="sharing-status',s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n					<div class="tooltip above sharing-button-container map">\r\n						<div class="lock-icon icon-locked ',s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(29,r,i),data:r}),s!=null&&(c+=s),c+='"></div>\r\n						<div class="tooltip-wrapper">\r\n							<p class="tooltip-content',s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">'+f(l((s=(s=e!=null?e.info:e)!=null?s.templateStrings:s)!=null?s.ownedBy:s,e))+'</p>\r\n						</div>					\r\n					</div>\r\n					<div class="sharing-icons',s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(31,r,i),data:r}),s!=null&&(c+=s),c+='">							\r\n					    <div class="tooltip above sharing-button-container map private',s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"private",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"shared",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n							<button class="map-sharing toggle-button server-button icon-user private temp-disabled',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"private",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"shared",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-sharing="private" data-type="map"></button>\r\n							<div class="tooltip-wrapper">\r\n								<p class="tooltip-content">'+f(l((s=i[1]!=null?i[1].sharingLevel:i[1])!=null?s["private"]:s,e))+'</p>\r\n							</div>								\r\n						</div><!--\r\n					 --><div class="tooltip above sharing-button-container map organization',s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"organization",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n							<button class="map-sharing toggle-button icon-community server-button organization temp-disabled',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"organization",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-sharing="organization" data-type="map"></button>\r\n							<div class="tooltip-wrapper">\r\n								<p class="tooltip-content">'+f(l((s=i[1]!=null?i[1].sharingLevel:i[1])!=null?s.organization:s,e))+'</p>\r\n							</div>								\r\n						</div><!--\r\n					 --><div class="tooltip above sharing-button-container map public',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"public",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n							<button class="map-sharing toggle-button server-button icon-stories-globe public temp-disabled',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"public",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,i[1]!=null?i[1].publicDisabled:i[1],{name:"if",hash:{},fn:this.program(37,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-sharing="public" data-type="map"></button>\r\n							<div class="tooltip-wrapper">\r\n								<p class="tooltip-content">',s=t["if"].call(e,i[1]!=null?i[1].publicDisabled:i[1],{name:"if",hash:{},fn:this.program(40,r,i),inverse:this.program(45,r,i),data:r}),s!=null&&(c+=s),c+="</p>\r\n							</div>								\r\n						</div>\r\n					</div>						\r\n				</div>\r\n				",s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(47,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+="						\r\n				",s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(49,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+="\r\n				",s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(51,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='					\r\n			</td>\r\n			<td class="sections',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(25,r,i),inverse:this.program(53,r,i),data:r}),s!=null&&(c+=s),c+='">\r\n',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(55,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=i[1]!=null?i[1].data:i[1])!=null?s.storyComponent:s,(s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.component:s)!=null?s.mapTour:s,{name:"ifEquals",hash:{},fn:this.program(5,r,i),inverse:this.program(59,r,i),data:r}),s!=null&&(c+=s),c+="			</td>			\r\n",s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(84,r,i),data:r}),s!=null&&(c+=s),c+="		</tr>\r\n",s=t["if"].call(e,(s=(s=e!=null?e.info:e)!=null?s.layers:s)!=null?s.length:s,{name:"if",hash:{},fn:this.program(92,r,i),inverse:this.program(138,r,i),data:r}),s!=null&&(c+=s),c},13:function(e,t,n,r){return" issue-row"},15:function(e,t,n,r){return" icon-stories-error issue"},17:function(e,t,n,r){return" icon-stories-check ok"},19:function(e,t,n,r){return" no-show"},21:function(e,t,n,r){var i=this.lambda,s=this.escapeExpression;return"								<span>"+s(i(e!=null?e.text:e,e))+"</span><br>\r\n"},23:function(e,t,n,r){return" column-9"},25:function(e,t,n,r){return" column-7"},27:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.errors:s)!=null?s.noMapName:s,e))},29:function(e,t,n,r){return"locked"},31:function(e,t,n,r){return" locked"},33:function(e,t,n,r){return" incompatible-access-level"},35:function(e,t,n,r){return" active"},37:function(e,t,n,r){var i;return i=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(38,r),inverse:this.noop,data:r}),i!=null?i:""},38:function(e,t,n,r){return" disabled-public"},40:function(e,t,n,r,i){var s;return s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(41,r,i),inverse:this.program(43,r,i),data:r}),s!=null?s:""},41:function(e,t,n,r,i){var s=this.lambda,o=this.escapeExpression;return o(s(i[3]!=null?i[3].cantSharePublicMessage:i[3],e))},43:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[3]!=null?i[3].sharingLevel:i[3])!=null?s["public"]:s,e))},45:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].sharingLevel:i[2])!=null?s["public"]:s,e))},47:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'<h5 class="item-not-public">'+u(o((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.errors:s)!=null?s.notPublic:s,e))+"</h5>"},49:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'<h5 class="item-deleted">'+u(o((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.errors:s)!=null?s.deleted:s,e))+"</h5>"},51:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'<h5 class="item-inaccessible">'+u(o((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.errors:s)!=null?s.inaccessible:s,e))+"</h5>"},53:function(e,t,n,r){return" column-5"},55:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(56,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},56:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='					<button class="view-item btn edit-item edit-error ';return s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(57,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(57,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+'" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'">'+f(l((s=(s=i[3]!=null?i[3].labels:i[3])!=null?s.actions:s)!=null?s.fix:s,e))+"</button>\r\n"},57:function(e,t,n,r){return"no-show"},59:function(e,t,n,r,i){var s,o="";return s=t.each.call(e,(s=e!=null?e.info:e)!=null?s.sections:s,{name:"each",hash:{},fn:this.program(60,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},60:function(e,t,n,r,i){var s,o='					<div class="tooltip above section">\r\n';return s=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(61,r,i),inverse:this.program(72,r,i),data:r}),s!=null&&(o+=s),o+='						<div class="tooltip-wrapper">\r\n							<p class="tooltip-content">',s=t["if"].call(e,e!=null?e.title:e,{name:"if",hash:{},fn:this.program(77,r,i),inverse:this.program(79,r,i),data:r}),s!=null&&(o+=s),s=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(81,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o+"</p>\r\n						</div>							\r\n					</div>						\r\n"},61:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(62,r),inverse:this.program(67,r),data:r}),i!=null&&(s+=i),s+"							\r\n"},62:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='								<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n							 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(63,r),inverse:this.program(65,r),data:r}),i!=null&&(f+=i),f+"\r\n								</span>\r\n"},63:function(e,t,n,r){return"\r\n								"},65:function(e,t,n,r){return",<!--\r\n							 -->"},67:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='								<span class="section-action-container">\r\n									<span class="section-link" data-type="main-stage-action" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n								 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(68,r),inverse:this.program(70,r),data:r}),i!=null&&(f+=i),f+"\r\n"},68:function(e,t,n,r){return"\r\n										</span>\r\n									"},70:function(e,t,n,r){return"<!--\r\n									-->,</span>\r\n"},72:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='							<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n						 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(73,r),inverse:this.program(75,r),data:r}),i!=null&&(f+=i),f+"\r\n							</span>\r\n"},73:function(e,t,n,r){return"\r\n							"},75:function(e,t,n,r){return",<!--\r\n						 -->"},77:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))},79:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.info:s)!=null?s.untitledSection:s,e))},81:function(e,t,n,r,i){var s;return s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(82,r,i),data:r}),s!=null?s:""},82:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return" ("+u(o((s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.contentType:s)!=null?s.mainStage:s,e))+")"},84:function(e,t,n,r,i){var s,o='			<td class="column-4">\r\n';return s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(85,r,i),data:r}),s!=null&&(o+=s),o+"			</td>\r\n"},85:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(86,r,i),data:r}),s!=null&&(o+=s),o},86:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(87,r,i),inverse:this.program(89,r,i),data:r}),s!=null&&(o+=s),o},87:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a='							<a href="'+u(o(i[1]!=null?i[1].url:i[1],e))+'" class="view-item btn transparent icon-edit edit-item ';return s=t["if"].call(e,i[1]!=null?i[1].deleted:i[1],{name:"if",hash:{},fn:this.program(57,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),s=t["if"].call(e,i[1]!=null?i[1].inaccessible:i[1],{name:"if",hash:{},fn:this.program(57,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a+'" target="_blank">'+u(o((s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.actions:s)!=null?s.editMap:s,e))+"</a>\r\n"},89:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(90,r,i),data:r}),s!=null&&(o+=s),o},90:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda;return'								<a href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'" class="view-item btn transparent icon-window-lines" target="_blank">'+f(l((s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.actions:s)!=null?s.viewMap:s,e))+"</a>\r\n"},92:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='				<tr class="layer-title-row expandable-layer" data-map-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'">				\r\n					<td class="column-8 pre-2">'+f(l((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.layers:s)!=null?s.layersHeader:s,e))+"</td>						\r\n				</tr>\r\n";return s=t.each.call(e,(s=e!=null?e.info:e)!=null?s.layers:s,{name:"each",hash:{},fn:this.program(93,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c},93:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='				<tr class="layer-row expandable-layer';return s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-map-id="'+f(l((s=e!=null?e.info:e)!=null?s.mapId:s,e))+'">				\r\n					<td class="column-1 pre-1 item-status-column">\r\n						<div class="tooltip above">\r\n							<div class="media-item-status',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(15,r,i),inverse:this.program(94,r,i),data:r}),s!=null&&(c+=s),c+='"></div>\r\n							<div class="tooltip-wrapper',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(97,r,i),data:r}),s!=null&&(c+=s),c+='">\r\n								<div class="tooltip-content">\r\n',s=t["if"].call(e,(s=e!=null?e.info:e)!=null?s.isScannable:s,{name:"if",hash:{},fn:this.program(99,r,i),inverse:this.program(102,r,i),data:r}),s!=null&&(c+=s),c+='								</div>\r\n							</div>\r\n						</div>								\r\n					</td>\r\n					<td class="media-title layer',s=t["if"].call(e,i[3]!=null?i[3].isBuilder:i[3],{name:"if",hash:{},fn:this.program(23,r,i),inverse:this.program(25,r,i),data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.isPremiumContent:e,{name:"if",hash:{},fn:this.program(104,r,i),inverse:this.program(106,r,i),data:r}),s!=null&&(c+=s),c+='"><span class="layer-title',s=t["if"].call(e,e!=null?e.isPremiumContent:e,{name:"if",hash:{},fn:this.program(108,r,i),inverse:this.program(110,r,i),data:r}),s!=null&&(c+=s),c+='" title="'+f((o=(o=t.title||(e!=null?e.title:e))!=null?o:a,typeof o===u?o.call(e,{name:"title",hash:{},data:r}):o))+'">'+f((o=(o=t.title||(e!=null?e.title:e))!=null?o:a,typeof o===u?o.call(e,{name:"title",hash:{},data:r}):o))+"</span>",s=t["if"].call(e,e!=null?e.isPremiumContent:e,{name:"if",hash:{},fn:this.program(112,r,i),inverse:this.program(114,r,i),data:r}),s!=null&&(c+=s),c+='</td>\r\n					<td class="column-7">\r\n						<div class="',s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,(s=e!=null?e.info:e)!=null?s.partOfMap:s,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.hostedOnAGOL:e,{name:"if",hash:{},fn:this.program(117,r,i),inverse:this.program(19,r,i),data:r}),s!=null&&(c+=s),c+='">\r\n							<div class="tooltip above sharing-button-container layer">\r\n								<div class="lock-icon icon-locked ',s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(29,r,i),data:r}),s!=null&&(c+=s),c+='"></div>\r\n								<div class="tooltip-wrapper">\r\n									<p class="tooltip-content',s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">'+f(l((s=(s=e!=null?e.info:e)!=null?s.templateStrings:s)!=null?s.ownedBy:s,e))+'</p>\r\n								</div>								\r\n							</div>\r\n							<div class="sharing-icons',s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(31,r,i),data:r}),s!=null&&(c+=s),c+='">										\r\n							    <div class="tooltip above sharing-button-container layer private',s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"private",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"shared",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n									<button class="map-sharing toggle-button server-button icon-user private temp-disabled',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"private",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"shared",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-map-id="'+f(l((s=e!=null?e.info:e)!=null?s.mapId:s,e))+'" data-sharing="private" data-type="layer"></button>\r\n									<div class="tooltip-wrapper">\r\n										<p class="tooltip-content">'+f(l((s=i[3]!=null?i[3].sharingLevel:i[3])!=null?s["private"]:s,e))+'</p>\r\n									</div>								\r\n								</div><!--\r\n							 --><div class="tooltip above sharing-button-container layer organization',s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"organization",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n									<button class="map-sharing toggle-button server-button icon-community organization temp-disabled',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"organization",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.sharedBelowLevel:e,{name:"if",hash:{},fn:this.program(33,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-map-id="'+f(l((s=e!=null?e.info:e)!=null?s.mapId:s,e))+'" data-sharing="organization" data-type="layer"></button>\r\n									<div class="tooltip-wrapper">\r\n										<p class="tooltip-content">'+f(l((s=i[3]!=null?i[3].sharingLevel:i[3])!=null?s.organization:s,e))+'</p>\r\n									</div>								\r\n								</div><!--\r\n							 --><div class="tooltip above sharing-button-container layer public',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"public",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='">\r\n									<button class="map-sharing toggle-button server-button icon-stories-globe public temp-disabled',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.access:e,"public",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,i[3]!=null?i[3].publicDisabled:i[3],{name:"if",hash:{},fn:this.program(37,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-map-id="'+f(l((s=e!=null?e.info:e)!=null?s.mapId:s,e))+'" data-sharing="public" data-type="layer"></button>\r\n									<div class="tooltip-wrapper">\r\n										<p class="tooltip-content">',s=t["if"].call(e,i[3]!=null?i[3].publicDisabled:i[3],{name:"if",hash:{},fn:this.program(119,r,i),inverse:this.program(124,r,i),data:r}),s!=null&&(c+=s),c+="</p>\r\n									</div>								\r\n								</div>\r\n							</div>\r\n							",s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(126,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+="									\r\n						</div>\r\n						",s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(128,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+="\r\n						",s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(130,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+="								\r\n					</td>\r\n",s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(132,r,i),data:r}),s!=null&&(c+=s),c+"				</tr>\r\n"},94:function(e,t,n,r){var i;return i=t["if"].call(e,(i=e!=null?e.info:e)!=null?i.isScannable:i,{name:"if",hash:{},fn:this.program(17,r),inverse:this.program(95,r),data:r}),i!=null?i:""},95:function(e,t,n,r){return" icon-stories-warning warning"},97:function(e,t,n,r){var i;return i=t["if"].call(e,(i=e!=null?e.info:e)!=null?i.isScannable:i,{name:"if",hash:{},fn:this.program(19,r),inverse:this.program(5,r),data:r}),i!=null?i:""},99:function(e,t,n,r){var i,s="";return i=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(100,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},100:function(e,t,n,r){var i=this.lambda,s=this.escapeExpression;return"											<span>"+s(i(e!=null?e.text:e,e))+"</span><br>\r\n"},102:function(e,t,n,r,i){var s=this.lambda,o=this.escapeExpression;return"										<span>"+o(s(i[4]!=null?i[4].unscannableWarning:i[4],e))+"</span>\r\n"},104:function(e,t,n,r){return" premium-title"},106:function(e,t,n,r){var i;return i=t["if"].call(e,e!=null?e.isSubscriptionContent:e,{name:"if",hash:{},fn:this.program(104,r),inverse:this.noop,data:r}),i!=null?i:""},108:function(e,t,n,r){return" premium"},110:function(e,t,n,r){var i;return i=t["if"].call(e,e!=null?e.isSubscriptionContent:e,{name:"if",hash:{},fn:this.program(108,r),inverse:this.noop,data:r}),i!=null?i:""},112:function(e,t,n,r,i){var s,o=t.helperMissing,u=this.escapeExpression;return'<div class="tooltip above premium-info-tooltip"><div class="premium-info-icon icon-info-information"></div><div class="tooltip-wrapper"><p class="tooltip-content">'+u((t.injectValueQuoted||e&&e.injectValueQuoted||o).call(e,(s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.tooltipErrors:s)!=null?s.layerConsumesCredits:s,i[1]!=null?i[1].title:i[1],{name:"injectValueQuoted",hash:{},data:r}))+"</p></div></div>"},114:function(e,t,n,r,i){var s;return s=t["if"].call(e,e!=null?e.isSubscriptionContent:e,{name:"if",hash:{},fn:this.program(115,r,i),inverse:this.noop,data:r}),s!=null?s:""},115:function(e,t,n,r,i){var s,o=t.helperMissing,u=this.escapeExpression;return'<div class="tooltip above premium-info-tooltip"><div class="premium-info-icon icon-info-information"><div class="tooltip-wrapper"><p class="tooltip-content">'+u((t.injectValueQuoted||e&&e.injectValueQuoted||o).call(e,(s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.tooltipErrors:s)!=null?s.layerSubscriptionContent:s,i[2]!=null?i[2].title:i[2],{name:"injectValueQuoted",hash:{},data:r}))+"</p></div></div>"},117:function(e,t,n,r){var i;return i=t["if"].call(e,e!=null?e.access:e,{name:"if",hash:{},fn:this.program(5,r),inverse:this.program(19,r),data:r}),i!=null?i:""},119:function(e,t,n,r,i){var s;return s=t["if"].call(e,e!=null?e.isOwnedByMe:e,{name:"if",hash:{},fn:this.program(120,r,i),inverse:this.program(122,r,i),data:r}),s!=null?s:""},120:function(e,t,n,r,i){var s=this.lambda,o=this.escapeExpression;return o(s(i[5]!=null?i[5].cantSharePublicMessage:i[5],e))},122:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[5]!=null?i[5].sharingLevel:i[5])!=null?s["public"]:s,e))},124:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[4]!=null?i[4].sharingLevel:i[4])!=null?s["public"]:s,e))},126:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'<h5 class="item-not-public">'+u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.errors:s)!=null?s.notPublic:s,e))+"</h5>"},128:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'<h5 class="item-deleted">'+u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.errors:s)!=null?s.deleted:s,e))+"</h5>"},130:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'<h5 class="item-inaccessible">'+u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.errors:s)!=null?s.inaccessible:s,e))+"</h5>"},132:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(133,r,i),data:r}),s!=null&&(o+=s),o},133:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(134,r,i),data:r}),s!=null&&(o+=s),o},134:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.url:e,{name:"if",hash:{},fn:this.program(135,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},135:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,i[7]!=null?i[7].isBuilder:i[7],{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(136,r,i),data:r}),s!=null&&(o+=s),o},136:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'										<td class="column-4"></td>\r\n										<td class="column-4">\r\n											<a href="'+u(o(i[1]!=null?i[1].url:i[1],e))+'" class="view-item btn transparent icon-window-lines" target="_blank">'+u(o((s=(s=i[8]!=null?i[8].labels:i[8])!=null?s.actions:s)!=null?s.viewLayer:s,e))+"</a>\r\n										</td>\r\n"},138:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='				<tr class="layer-title-row empty expandable-layer';return s=t["if"].call(e,e!=null?e.deleted:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.notYoursNotAccessible:e,{name:"if",hash:{},fn:this.program(19,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+'" data-map-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'">				\r\n					<td class="column-8 pre-2">'+f(l((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.layers:s)!=null?s.noLayers:s,e))+"</td>						\r\n				</tr>\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a=t.helperMissing,f='<table class="map-table content-table">\r\n	<thead>\r\n		<tr>\r\n			<td class="column-2 item-status-column">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.status:s,e))+'</td>\r\n			<td class="';return s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(f+=s),f+='">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.name:s,e))+'</td>\r\n			<td class="column-6 item-shared-with-column">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.shared:s,e))+"</td>\r\n			\r\n",s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.data:e)!=null?s.storyComponent:s,(s=(s=e!=null?e.labels:e)!=null?s.component:s)!=null?s.mapTour:s,{name:"ifEquals",hash:{},fn:this.program(5,r,i),inverse:this.program(7,r,i),data:r}),s!=null&&(f+=s),f+='			<td class="column-4"></td>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n',s=t.each.call(e,(s=e!=null?e.data:e)!=null?s.items:s,{name:"each",hash:{},fn:this.program(12,r,i),inverse:this.noop,data:r}),s!=null&&(f+=s),f+"	</tbody>\r\n</table>"},useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/tabs/Images",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return""},3:function(e,t,n,r){return" scrollable-table"},5:function(e,t,n,r){return"column-10"},7:function(e,t,n,r){return"column-14"},9:function(e,t,n,r){return"column-8"},11:function(e,t,n,r){return"column-4"},13:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='		<tr class="media-row';return s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(14,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='" data-id="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'">				\r\n			<td class="column-2 item-status-column">\r\n				<div class="tooltip',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(16,r,i),inverse:this.program(18,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n					<div class="media-item-status',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(20,r,i),inverse:this.program(22,r,i),data:r}),s!=null&&(l+=s),l+='"></div>\r\n					<div class="tooltip-wrapper',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(24,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n						<div class="tooltip-content">\r\n',s=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(26,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='						</div>\r\n					</div>\r\n				</div>					\r\n			</td>\r\n			<td class="media-title image ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(7,r,i),data:r}),s!=null&&(l+=s),l+='">	\r\n				<a ',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.url:e,"",{name:"ifEquals",hash:{},fn:this.program(1,r,i),inverse:this.program(28,r,i),data:r}),s!=null&&(l+=s),l+=' class="media-link" target="_blank">',s=t["if"].call(e,(s=e!=null?e.info:e)!=null?s.title:s,{name:"if",hash:{},fn:this.program(31,r,i),inverse:this.program(33,r,i),data:r}),s!=null&&(l+=s),l+='</a>	\r\n			</td>\r\n			<td class="source column-4">\r\n				<a',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Facebook",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.program(37,r,i),data:r}),s!=null&&(l+=s),l+=' class="tooltip',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(16,r,i),inverse:this.program(18,r,i),data:r}),s!=null&&(l+=s),l+=" sharing-status media image",s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Facebook",{name:"ifEquals",hash:{},fn:this.program(45,r,i),inverse:this.program(47,r,i),data:r}),s!=null&&(l+=s),l+='" target="_blank">\r\n					<div class="tooltip-wrapper">\r\n						<div class="tooltip-content">\r\n							<span>',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Facebook",{name:"ifEquals",hash:{},fn:this.program(55,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Flickr",{name:"ifEquals",hash:{},fn:this.program(57,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Picasa",{name:"ifEquals",hash:{},fn:this.program(59,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Url",{name:"ifEquals",hash:{},fn:this.program(61,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='</span>\r\n						</div>\r\n					</div>				\r\n				</a>				\r\n			</td>\r\n			<td class="sections ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(9,r,i),inverse:this.program(11,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n',s=t["if"].call(e,e!=null?e.sections:e,{name:"if",hash:{},fn:this.program(63,r,i),inverse:this.program(97,r,i),data:r}),s!=null&&(l+=s),l+"			</td>\r\n		</tr>				\r\n"},14:function(e,t,n,r){return" issue-row"},16:function(e,t,n,r){return" above"},18:function(e,t,n,r){return" after"},20:function(e,t,n,r){return" icon-stories-error issue"},22:function(e,t,n,r){return" icon-stories-check ok"},24:function(e,t,n,r){return" no-show"},26:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u="								<span>"+o(s(e!=null?e.text:e,e));return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(1,r),data:r}),i!=null&&(u+=i),u+"</span><br>\r\n"},28:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o));return s=t["if"].call(e,(s=e!=null?e.info:e)!=null?s.isFeatureService:s,{name:"if",hash:{},fn:this.program(29,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+'"'},29:function(e,t,n,r,i){var s=this.lambda,o=this.escapeExpression;return"?token="+o(s(i[3]!=null?i[3].token:i[3],e))},31:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.info:e)!=null?i.title:i,e))},33:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return u((i=(i=t.displayUrl||(e!=null?e.displayUrl:e))!=null?i:o,typeof i===s?i.call(e,{name:"displayUrl",hash:{},data:r}):i))},35:function(e,t,n,r){return' href="http://www.facebook.com/photos"'},37:function(e,t,n,r){var i,s=t.helperMissing;return i=(t.ifEquals||e&&e.ifEquals||s).call(e,(i=e!=null?e.info:e)!=null?i.source:i,"Flickr",{name:"ifEquals",hash:{},fn:this.program(38,r),inverse:this.program(40,r),data:r}),i!=null?i:""},38:function(e,t,n,r){return' href="http://www.flickr.com"'},40:function(e,t,n,r){var i,s=t.helperMissing;return i=(t.ifEquals||e&&e.ifEquals||s).call(e,(i=e!=null?e.info:e)!=null?i.source:i,"Picasa",{name:"ifEquals",hash:{},fn:this.program(41,r),inverse:this.program(43,r),data:r}),i!=null?i:""},41:function(e,t,n,r){return' href="https://picasaweb.google.com/lh/myphotos"'},43:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return' href="'+u((i=(i=t.url||(e!=null?e.url:e))!=null?i:o,typeof i===s?i.call(e,{name:"url",hash:{},data:r}):i))+'"'},45:function(e,t,n,r){return" icon-facebook"},47:function(e,t,n,r){var i,s=t.helperMissing;return i=(t.ifEquals||e&&e.ifEquals||s).call(e,(i=e!=null?e.info:e)!=null?i.source:i,"Flickr",{name:"ifEquals",hash:{},fn:this.program(48,r),inverse:this.program(50,r),data:r}),i!=null?i:""},48:function(e,t,n,r){return" icon-stories-flickr"},50:function(e,t,n,r){var i,s=t.helperMissing;return i=(t.ifEquals||e&&e.ifEquals||s).call(e,(i=e!=null?e.info:e)!=null?i.source:i,"Picasa",{name:"ifEquals",hash:{},fn:this.program(51,r),inverse:this.program(53,r),data:r}),i!=null?i:""},51:function(e,t,n,r){return" icon-stories-picasa"},53:function(e,t,n,r){return" icon-link tall-icon"},55:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].engStrings:i[2])!=null?s.facebook:s,e))},57:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].engStrings:i[2])!=null?s.flickr:s,e))},59:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].engStrings:i[2])!=null?s.picasa:s,e))},61:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].engStrings:i[2])!=null?s.url:s,e))},63:function(e,t,n,r,i){var s,o="";return s=t.each.call(e,e!=null?e.sections:e,{name:"each",hash:{},fn:this.program(64,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},64:function(e,t,n,r,i){var s,o='						<div class="tooltip section-number before section">\r\n';return s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(65,r,i),inverse:this.program(70,r,i),data:r}),s!=null&&(o+=s),o+='							<div class="tooltip-wrapper">\r\n								<p class="tooltip-content">\r\n',s=t["if"].call(e,e!=null?e.title:e,{name:"if",hash:{},fn:this.program(87,r,i),inverse:this.program(89,r,i),data:r}),s!=null&&(o+=s),s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(91,r,i),data:r}),s!=null&&(o+=s),o+"								</p>\r\n							</div>							\r\n						</div>									\r\n"},65:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='								<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n								 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(66,r),inverse:this.program(68,r),data:r}),i!=null&&(f+=i),f+"\r\n									</span>\r\n"},66:function(e,t,n,r){return"\r\n									"},68:function(e,t,n,r){return",<!--\r\n								 -->"},70:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(71,r),inverse:this.program(76,r),data:r}),i!=null&&(s+=i),s},71:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='									<span class="section-action-container">\r\n										<span class="section-link" data-type="main-stage-action" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n								 	-->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(72,r),inverse:this.program(74,r),data:r}),i!=null&&(f+=i),f},72:function(e,t,n,r){return"\r\n											</span>\r\n										"},74:function(e,t,n,r){return"<!--\r\n										-->,</span>\r\n"},76:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(77,r),inverse:this.program(82,r),data:r}),i!=null&&(s+=i),s},77:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='										<span class="section-action-container">\r\n											<span class="section-link" data-type="description" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n									 	-->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(78,r),inverse:this.program(80,r),data:r}),i!=null&&(f+=i),f},78:function(e,t,n,r){return"\r\n												</span>\r\n											"},80:function(e,t,n,r){return"<!--\r\n											-->,</span>\r\n"},82:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='										<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n									 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(83,r),inverse:this.program(85,r),data:r}),i!=null&&(f+=i),f+"\r\n										</span>	\r\n"},83:function(e,t,n,r){return"\r\n										"},85:function(e,t,n,r){return",<!--\r\n									 -->"},87:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return"										"+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+"\r\n"},89:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return"										"+u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.info:s)!=null?s.untitledSection:s,e))+"\r\n"},91:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(92,r,i),inverse:this.program(95,r,i),data:r}),s!=null&&(o+=s),o},92:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a="											("+u(o((s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.contentType:s)!=null?s.mainStage:s,e))+")\r\n";return s=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(93,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a},93:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return"												("+u(o((s=(s=i[6]!=null?i[6].labels:i[6])!=null?s.contentType:s)!=null?s.sidePanel:s,e))+")\r\n"},95:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(93,r,i),inverse:this.program(1,r,i),data:r}),s!=null&&(o+=s),o},97:function(e,t,n,r){var i,s="";return i=t["if"].call(e,(i=e!=null?e.info:e)!=null?i.pinNumber:i,{name:"if",hash:{},fn:this.program(98,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},98:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return"						"+o(s((i=e!=null?e.info:e)!=null?i.pinNumber:i,e))+"\r\n"},100:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return'			<tr class="layer-title-row thumbnail-row media-row">				\r\n				<td class="column-8 pre-2">'+u(o((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.images:s)!=null?s.thumbnails:s,e))+"</td>						\r\n			</tr>\r\n"},102:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='		<tr class="media-row';return s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(14,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='" data-id="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'">				\r\n			<td class="column-2 item-status-column">\r\n				<div class="tooltip',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(16,r,i),inverse:this.program(18,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n					<div class="media-item-status',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(20,r,i),inverse:this.program(22,r,i),data:r}),s!=null&&(l+=s),l+='"></div>\r\n					<div class="tooltip-wrapper',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(24,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n						<div class="tooltip-content">\r\n',s=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(26,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='						</div>\r\n					</div>\r\n				</div>					\r\n			</td>\r\n			<td class="media-title image ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(7,r,i),data:r}),s!=null&&(l+=s),l+='">	\r\n				<a ',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.url:e,"",{name:"ifEquals",hash:{},fn:this.program(1,r,i),inverse:this.program(28,r,i),data:r}),s!=null&&(l+=s),l+=' class="media-link" target="_blank">',s=t["if"].call(e,(s=e!=null?e.info:e)!=null?s.title:s,{name:"if",hash:{},fn:this.program(31,r,i),inverse:this.program(33,r,i),data:r}),s!=null&&(l+=s),l+='</a>	\r\n			</td>\r\n			<td class="source column-4">\r\n				<a',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Facebook",{name:"ifEquals",hash:{},fn:this.program(35,r,i),inverse:this.program(37,r,i),data:r}),s!=null&&(l+=s),l+=' class="tooltip',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(16,r,i),inverse:this.program(18,r,i),data:r}),s!=null&&(l+=s),l+=" sharing-status media image",s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Facebook",{name:"ifEquals",hash:{},fn:this.program(45,r,i),inverse:this.program(47,r,i),data:r}),s!=null&&(l+=s),l+='" target="_blank">\r\n					<div class="tooltip-wrapper">\r\n						<div class="tooltip-content">\r\n							<span>',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Facebook",{name:"ifEquals",hash:{},fn:this.program(55,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Flickr",{name:"ifEquals",hash:{},fn:this.program(57,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Picasa",{name:"ifEquals",hash:{},fn:this.program(59,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Url",{name:"ifEquals",hash:{},fn:this.program(61,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='</span>\r\n						</div>\r\n					</div>				\r\n				</a>				\r\n			</td>\r\n			<td class="sections ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(9,r,i),inverse:this.program(11,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n',s=t["if"].call(e,(s=e!=null?e.info:e)!=null?s.pinNumber:s,{name:"if",hash:{},fn:this.program(103,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+"			</td>\r\n		</tr>				\r\n"},103:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return"					"+o(s((i=e!=null?e.info:e)!=null?i.pinNumber:i,e))+"\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o,u=this.lambda,a=this.escapeExpression,f="function",l=t.helperMissing,c='<table class="image-table content-table ';return s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(c+=s),c+='">\r\n	<thead>\r\n		<tr>\r\n			<td class="column-2 item-status-column">'+a(u((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.status:s,e))+'</td>\r\n			<td class="',s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(7,r,i),data:r}),s!=null&&(c+=s),c+='">'+a((o=(o=t.titleType||(e!=null?e.titleType:e))!=null?o:l,typeof o===f?o.call(e,{name:"titleType",hash:{},data:r}):o))+'</td>\r\n			<td class="source-title column-4">'+a(u((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.source:s,e))+'</td>\r\n			<td class="',s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(9,r,i),inverse:this.program(11,r,i),data:r}),s!=null&&(c+=s),c+='">'+a((o=(o=t.storyComponent||(e!=null?e.storyComponent:e))!=null?o:l,typeof o===f?o.call(e,{name:"storyComponent",hash:{},data:r}):o))+'</td>\r\n		</tr>\r\n	</thead>\r\n	<tbody class="custom-scrollbar">\r\n',s=t.each.call(e,e!=null?e.images:e,{name:"each",hash:{},fn:this.program(13,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t["if"].call(e,(s=e!=null?e.thumbnails:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(100,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=t.each.call(e,e!=null?e.thumbnails:e,{name:"each",hash:{},fn:this.program(102,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+"	</tbody>\r\n</table>"},useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/tabs/Videos",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return"column-10"},3:function(e,t,n,r){return"column-14"},5:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='		<tr class="media-row';return s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(6,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='" data-id="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'">				\r\n			<td class="column-2 item-status-column">\r\n				<div class="tooltip above">\r\n					<div class="media-item-status',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(8,r,i),inverse:this.program(10,r,i),data:r}),s!=null&&(l+=s),l+='"></div>\r\n					<div class="tooltip-wrapper',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(12,r,i),inverse:this.program(14,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n						<div class="tooltip-content">\r\n',s=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(16,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='						</div>\r\n					</div>\r\n				</div>					\r\n			</td>\r\n			<td class="media-title video ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n				<a href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'" class="media-link" target="_blank">',s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(18,r,i),inverse:this.program(20,r,i),data:r}),s!=null&&(l+=s),l+='</a>\r\n			</td>\r\n			<td class="source column-4">\r\n				<a',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"YouTube",{name:"ifEquals",hash:{},fn:this.program(22,r,i),inverse:this.program(24,r,i),data:r}),s!=null&&(l+=s),l+=' class="tooltip above sharing-status media video',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"YouTube",{name:"ifEquals",hash:{},fn:this.program(27,r,i),inverse:this.program(29,r,i),data:r}),s!=null&&(l+=s),l+='" target="_blank">\r\n					<div class="tooltip-wrapper">\r\n						<div class="tooltip-content">\r\n							<span>',s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"YouTube",{name:"ifEquals",hash:{},fn:this.program(32,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,(s=e!=null?e.info:e)!=null?s.source:s,"Vimeo",{name:"ifEquals",hash:{},fn:this.program(34,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='</span>\r\n						</div>\r\n					</div>									\r\n				</a>		\r\n			</td>\r\n			<td class="sections ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(36,r,i),inverse:this.program(38,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n',s=t["if"].call(e,e!=null?e.sections:e,{name:"if",hash:{},fn:this.program(40,r,i),inverse:this.program(74,r,i),data:r}),s!=null&&(l+=s),l+"			</td>\r\n		</tr>				\r\n"},6:function(e,t,n,r){return" issue-row"},8:function(e,t,n,r){return" icon-stories-error issue"},10:function(e,t,n,r){return" icon-stories-check ok"},12:function(e,t,n,r){return""},14:function(e,t,n,r){return" no-show"},16:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u="								<span>"+o(s(e!=null?e.text:e,e));return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(12,r),inverse:this.program(12,r),data:r}),i!=null&&(u+=i),u+"</span><br>\r\n"},18:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.errors:s)!=null?s.cantAccessVideo:s,e))},20:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.info:e)!=null?i.title:i,e))},22:function(e,t,n,r){return' href="https://www.youtube.com"'},24:function(e,t,n,r){var i,s=t.helperMissing;return i=(t.ifEquals||e&&e.ifEquals||s).call(e,(i=e!=null?e.info:e)!=null?i.source:i,"Vimeo",{name:"ifEquals",hash:{},fn:this.program(25,r),inverse:this.noop,data:r}),i!=null?i:""},25:function(e,t,n,r){return' href="https://vimeo.com"'},27:function(e,t,n,r){return" icon-stories-youtube"},29:function(e,t,n,r){var i,s=t.helperMissing;return i=(t.ifEquals||e&&e.ifEquals||s).call(e,(i=e!=null?e.info:e)!=null?i.source:i,"Vimeo",{name:"ifEquals",hash:{},fn:this.program(30,r),inverse:this.noop,data:r}),i!=null?i:""},30:function(e,t,n,r){return" icon-stories-vimeo"},32:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].engStrings:i[2])!=null?s.youTube:s,e))},34:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].engStrings:i[2])!=null?s.vimeo:s,e))},36:function(e,t,n,r){return"column-8"},38:function(e,t,n,r){return"column-4"},40:function(e,t,n,r,i){var s,o="";return s=t.each.call(e,e!=null?e.sections:e,{name:"each",hash:{},fn:this.program(41,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},41:function(e,t,n,r,i){var s,o='						<div class="tooltip above section">							\r\n';return s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(42,r,i),inverse:this.program(47,r,i),data:r}),s!=null&&(o+=s),o+='							<div class="tooltip-wrapper">\r\n								<p class="tooltip-content">\r\n',s=t["if"].call(e,e!=null?e.title:e,{name:"if",hash:{},fn:this.program(64,r,i),inverse:this.program(66,r,i),data:r}),s!=null&&(o+=s),s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(12,r,i),inverse:this.program(68,r,i),data:r}),s!=null&&(o+=s),o+"								</p>\r\n							</div>				\r\n						</div>						\r\n"},42:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='								<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n								 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(43,r),inverse:this.program(45,r),data:r}),i!=null&&(f+=i),f+"\r\n									</span>\r\n"},43:function(e,t,n,r){return"\r\n									"},45:function(e,t,n,r){return",<!--\r\n								 -->"},47:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(48,r),inverse:this.program(53,r),data:r}),i!=null&&(s+=i),s},48:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='									<span class="section-action-container">\r\n										<span class="section-link" data-type="main-stage-action" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n								 	-->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(49,r),inverse:this.program(51,r),data:r}),i!=null&&(f+=i),f},49:function(e,t,n,r){return"\r\n											</span>\r\n										"},51:function(e,t,n,r){return"<!--\r\n										-->,</span>\r\n"},53:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(54,r),inverse:this.program(59,r),data:r}),i!=null&&(s+=i),s},54:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='										<span class="section-action-container">\r\n											<span class="section-link" data-type="description" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n									 	-->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(55,r),inverse:this.program(57,r),data:r}),i!=null&&(f+=i),f},55:function(e,t,n,r){return"\r\n												</span>\r\n											"},57:function(e,t,n,r){return"<!--\r\n											-->,</span>\r\n"},59:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='										<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n									 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(60,r),inverse:this.program(62,r),data:r}),i!=null&&(f+=i),f+"\r\n										</span>	\r\n"},60:function(e,t,n,r){return"\r\n										"},62:function(e,t,n,r){return",<!--\r\n									 -->"},64:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return"										"+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+"\r\n"},66:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return"										"+u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.info:s)!=null?s.untitledSection:s,e))+"\r\n"},68:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(69,r,i),inverse:this.program(72,r,i),data:r}),s!=null&&(o+=s),o},69:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a="											("+u(o((s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.contentType:s)!=null?s.mainStage:s,e))+")\r\n";return s=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(70,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a},70:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return"												("+u(o((s=(s=i[6]!=null?i[6].labels:i[6])!=null?s.contentType:s)!=null?s.sidePanel:s,e))+")\r\n"},72:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(70,r,i),inverse:this.program(12,r,i),data:r}),s!=null&&(o+=s),o},74:function(e,t,n,r){var i,s="";return i=t["if"].call(e,(i=e!=null?e.info:e)!=null?i.pinNumber:i,{name:"if",hash:{},fn:this.program(75,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},75:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return"						"+o(s((i=e!=null?e.info:e)!=null?i.pinNumber:i,e))+"\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a='<table class="video-table content-table">\r\n	<thead>\r\n		<tr>\r\n			<td class="column-2 item-status-column">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.status:s,e))+'</td>\r\n			<td class="';return s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(a+=s),a+='">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.name:s,e))+'</td>\r\n			<td class="source-title column-4">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.source:s,e))+'</td>\r\n			<td class="column-4">'+u(o((s=e!=null?e.data:e)!=null?s.storyComponent:s,e))+"</td>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n",s=t.each.call(e,(s=e!=null?e.data:e)!=null?s.items:s,{name:"each",hash:{},fn:this.program(5,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a+"	</tbody>\r\n</table>"},useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/tabs/Webpages",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return"column-14"},3:function(e,t,n,r){return"column-18"},5:function(e,t,n,r){return"column-8"},7:function(e,t,n,r){return"column-4"},9:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='		<tr class="media-row';return s=t["if"].call(e,e!=null?e.inaccessible:e,{name:"if",hash:{},fn:this.program(10,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='" data-id="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'">				\r\n			<td class="column-2 item-status-column">\r\n				<div class="tooltip above">\r\n					<div class="media-item-status',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(12,r,i),inverse:this.program(14,r,i),data:r}),s!=null&&(l+=s),l+='"></div>\r\n					<div class="tooltip-wrapper',s=t["if"].call(e,(s=e!=null?e.issues:e)!=null?s.length:s,{name:"if",hash:{},fn:this.program(16,r,i),inverse:this.program(18,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n						<div class="tooltip-content">\r\n',s=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(20,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+='						</div>\r\n					</div>\r\n				</div>					\r\n			</td>\r\n			<td class="media-title image ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n				<a href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'" class="media-link" target="_blank">'+f((o=(o=t.displayUrl||(e!=null?e.displayUrl:e))!=null?o:a,typeof o===u?o.call(e,{name:"displayUrl",hash:{},data:r}):o))+'</a>\r\n			</td>\r\n			<td class="sections ',s=t["if"].call(e,i[1]!=null?i[1].isBuilder:i[1],{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(7,r,i),data:r}),s!=null&&(l+=s),l+='">\r\n',s=t["if"].call(e,e!=null?e.sections:e,{name:"if",hash:{},fn:this.program(22,r,i),inverse:this.program(56,r,i),data:r}),s!=null&&(l+=s),l+"			</td>\r\n		</tr>				\r\n"},10:function(e,t,n,r){return" issue-row"},12:function(e,t,n,r){return" icon-stories-error issue"},14:function(e,t,n,r){return" icon-stories-check ok"},16:function(e,t,n,r){return""},18:function(e,t,n,r){return" no-show"},20:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u="								<span>"+o(s(e!=null?e.text:e,e));return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(16,r),inverse:this.program(16,r),data:r}),i!=null&&(u+=i),u+"</span><br>\r\n"},22:function(e,t,n,r,i){var s,o="";return s=t.each.call(e,e!=null?e.sections:e,{name:"each",hash:{},fn:this.program(23,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},23:function(e,t,n,r,i){var s,o='						<div class="tooltip above section">\r\n';return s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(24,r,i),inverse:this.program(29,r,i),data:r}),s!=null&&(o+=s),o+='							<div class="tooltip-wrapper">\r\n								<p class="tooltip-content">\r\n',s=t["if"].call(e,e!=null?e.title:e,{name:"if",hash:{},fn:this.program(46,r,i),inverse:this.program(48,r,i),data:r}),s!=null&&(o+=s),s=t["if"].call(e,e!=null?e.mainContent:e,{name:"if",hash:{},fn:this.program(16,r,i),inverse:this.program(50,r,i),data:r}),s!=null&&(o+=s),o+"								</p>\r\n							</div>								\r\n						</div>\r\n"},24:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='								<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n								 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(25,r),inverse:this.program(27,r),data:r}),i!=null&&(f+=i),f+"\r\n									</span>\r\n"},25:function(e,t,n,r){return"\r\n									"},27:function(e,t,n,r){return",<!--\r\n								 -->"},29:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(30,r),inverse:this.program(35,r),data:r}),i!=null&&(s+=i),s},30:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='									<span class="section-action-container">\r\n										<span class="section-link" data-type="main-stage-action" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n								 	-->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(31,r),inverse:this.program(33,r),data:r}),i!=null&&(f+=i),f},31:function(e,t,n,r){return"\r\n											</span>\r\n										"},33:function(e,t,n,r){return"<!--\r\n										-->,</span>\r\n"},35:function(e,t,n,r){var i,s="";return i=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(36,r),inverse:this.program(41,r),data:r}),i!=null&&(s+=i),s},36:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='										<span class="section-action-container">\r\n											<span class="section-link" data-type="description" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"*</span><!--\r\n									 	-->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(37,r),inverse:this.program(39,r),data:r}),i!=null&&(f+=i),f},37:function(e,t,n,r){return"\r\n												</span>\r\n											"},39:function(e,t,n,r){return"<!--\r\n											-->,</span>\r\n"},41:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='										<span class="section-link" data-type="main-stage" data-section-number="'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+'">'+a((s=(s=t.sectionNum||(e!=null?e.sectionNum:e))!=null?s:u,typeof s===o?s.call(e,{name:"sectionNum",hash:{},data:r}):s))+"<!--\r\n									 -->";return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(42,r),inverse:this.program(44,r),data:r}),i!=null&&(f+=i),f+"\r\n										</span>	\r\n"},42:function(e,t,n,r){return"\r\n										"},44:function(e,t,n,r){return",<!--\r\n									 -->"},46:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return"										"+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+"\r\n"},48:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return"										"+u(o((s=(s=i[4]!=null?i[4].labels:i[4])!=null?s.info:s)!=null?s.untitledSection:s,e))+"\r\n"},50:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.numActions:e,{name:"if",hash:{},fn:this.program(51,r,i),inverse:this.program(54,r,i),data:r}),s!=null&&(o+=s),o},51:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a="											("+u(o((s=(s=i[5]!=null?i[5].labels:i[5])!=null?s.contentType:s)!=null?s.mainStage:s,e))+")\r\n";return s=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(52,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a},52:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return"												("+u(o((s=(s=i[6]!=null?i[6].labels:i[6])!=null?s.contentType:s)!=null?s.sidePanel:s,e))+")\r\n"},54:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.sideContent:e,{name:"if",hash:{},fn:this.program(52,r,i),inverse:this.program(16,r,i),data:r}),s!=null&&(o+=s),o},56:function(e,t,n,r){var i,s="";return i=t["if"].call(e,(i=e!=null?e.info:e)!=null?i.pinNumber:i,{name:"if",hash:{},fn:this.program(57,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},57:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return"						"+o(s((i=e!=null?e.info:e)!=null?i.pinNumber:i,e))+"\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a='<table class="webpage-table content-table">\r\n	<thead>\r\n		<tr>\r\n			<td class="column-2 item-status-column">'+u(o((s=(s=e!=null?e.labels:e)!=null?s.headers:s)!=null?s.status:s,e))+'</td>\r\n			<td class="';return s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(a+=s),a+='">'+u(o((s=e!=null?e.data:e)!=null?s.titleType:s,e))+'</td>\r\n			<td class="',s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(5,r,i),inverse:this.program(7,r,i),data:r}),s!=null&&(a+=s),a+='">'+u(o((s=e!=null?e.data:e)!=null?s.storyComponent:s,e))+"</td>\r\n		</tr>\r\n	</thead>\r\n	<tbody>\r\n",s=t.each.call(e,(s=e!=null?e.data:e)!=null?s.items:s,{name:"each",hash:{},fn:this.program(9,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a+"	</tbody>\r\n</table>"},useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/tabs/Tags",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i=this.lambda,s=this.escapeExpression;return'								<option value="'+s(i(e,e))+'">'+s(i(e,e))+"</option>\r\n"},3:function(e,t,n,r){var i;return i=t["if"].call(e,r&&r.last,{name:"if",hash:{},fn:this.program(4,r),inverse:this.program(6,r),data:r}),i!=null?i:""},4:function(e,t,n,r){var i=this.lambda,s=this.escapeExpression;return s(i(e,e))},6:function(e,t,n,r){var i=this.lambda,s=this.escapeExpression;return s(i(e,e))+", "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u='<table class="content-table tags-table">\r\n	<thead>		\r\n		<tr>\r\n			<td class="column-24">'+o(s((i=e!=null?e.labels:e)!=null?i.tags:i,e))+'</td>\r\n		</tr>\r\n	</thead>		\r\n	<tbody>\r\n		<tr>\r\n			<td>\r\n				<div class="row to-end padding-trailer-half">\r\n					<div class="column-6 pre-1 post-1">\r\n						<h4 class="item-subtitle">'+o(s((i=e!=null?e.labels:e)!=null?i.collectionTags:i,e))+'</h4>\r\n						<select class="collection-tags">\r\n							<option selected value="">'+o(s((i=e!=null?e.labels:e)!=null?i.selectASubject:i,e))+"</option>\r\n";return i=t.each.call(e,e!=null?e.collectionList:e,{name:"each",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(u+=i),u+='						</select>							\r\n					</div>\r\n					<div class="column-7 post-1">\r\n						<h4 class="item-subtitle">'+o(s((i=e!=null?e.labels:e)!=null?i.tags:i,e))+'</h4>\r\n						<div class="item-tags-list" contenteditable="true">',i=t.each.call(e,(i=e!=null?e.data:e)!=null?i.yourTags:i,{name:"each",hash:{},fn:this.program(3,r),inverse:this.noop,data:r}),i!=null&&(u+=i),u+'</div>							\r\n					</div>\r\n					<div class="column-7 post-1">\r\n						<div class="leader-1">\r\n							<p>'+o(s((i=e!=null?e.labels:e)!=null?i.tagTip:i,e))+'</p>								\r\n						</div>\r\n						<div class="item-update-tags disabled btn leader-half server-button">'+o(s((i=e!=null?e.labels:e)!=null?i.save:i,e))+"</div>\r\n					</div>						\r\n				</div>\r\n			</td>\r\n		</tr>\r\n	</tbody>\r\n</table>"},useData:!0})}),define("lib-build/hbars!my/content/tabs/SubmitToGallery",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return" icon-stories-check ok"},3:function(e,t,n,r){return" icon-stories-error issue"},5:function(e,t,n,r){return""},7:function(e,t,n,r){return" disabled"},9:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.labels:e)!=null?i.submitted:i,e))},11:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.labels:e)!=null?i.nominateToGallery:i,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a="function",f=t.helperMissing,l='<table class="content-table submit-table">\r\n	<thead>\r\n		<tr>\r\n			<td class="column-24">'+u(o((i=e!=null?e.labels:e)!=null?i.gallerySubmission:i,e))+'</td>\r\n		</tr>\r\n	</thead>		\r\n	<tbody>\r\n		<tr>\r\n			<td>				\r\n				<div class="row submit-subtitle-container">\r\n					<span>'+u(o((i=e!=null?e.labels:e)!=null?i.canSubmitIf:i,e))+'</span>\r\n				</div>				\r\n				<div class="row submit-content trailer-half">\r\n					<div class="submit-column">\r\n						<div class="gallery-criterium">\r\n							<div class="media-item-status';return i=t["if"].call(e,(i=e!=null?e.data:e)!=null?i.noBrokenContent:i,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(3,r),data:r}),i!=null&&(l+=i),l+='"></div>\r\n							<span>'+u(o((i=e!=null?e.labels:e)!=null?i.noBrokenContent:i,e))+'</span>\r\n						</div>\r\n						<div class="gallery-criterium">\r\n							<div class="media-item-status',i=t["if"].call(e,(i=e!=null?e.data:e)!=null?i.sharedPublicly:i,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(3,r),data:r}),i!=null&&(l+=i),l+='"></div>\r\n							<span>'+u(o((i=e!=null?e.labels:e)!=null?i.sharedPublicly:i,e))+'</span>\r\n						</div>						\r\n						<div class="gallery-criterium">\r\n							<div class="media-item-status',i=t["if"].call(e,(i=e!=null?e.data:e)!=null?i.hasOwnImage:i,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(3,r),data:r}),i!=null&&(l+=i),l+='"></div>\r\n							<span>'+u(o((i=e!=null?e.labels:e)!=null?i.hasOwnImage:i,e))+'</span>\r\n						</div>\r\n						<div class="gallery-criterium">\r\n							<div class="media-item-status',i=t["if"].call(e,(i=e!=null?e.data:e)!=null?i.hasCollectionTag:i,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(3,r),data:r}),i!=null&&(l+=i),l+='"></div>\r\n							<span>',i=(s=(s=t.subjectTagsString||(e!=null?e.subjectTagsString:e))!=null?s:f,typeof s===a?s.call(e,{name:"subjectTagsString",hash:{},data:r}):s),i!=null&&(l+=i),l+='</span>\r\n						</div>						\r\n					</div><!--\r\n				 --><div class="submit-column submit-button-container">\r\n			 			<button class="btn submit-button gallery server-button',i=t["if"].call(e,(i=e!=null?e.data:e)!=null?i.allClear:i,{name:"if",hash:{},fn:this.program(5,r),inverse:this.program(7,r),data:r}),i!=null&&(l+=i),i=t["if"].call(e,e!=null?e.nominated:e,{name:"if",hash:{},fn:this.program(7,r),inverse:this.noop,data:r}),i!=null&&(l+=i),l+='">',i=t["if"].call(e,e!=null?e.nominated:e,{name:"if",hash:{},fn:this.program(9,r),inverse:this.program(11,r),data:r}),i!=null&&(l+=i),l+='</button>\r\n					</div><!--\r\n				 --><div class="submit-column">\r\n						<p class="submit-tip">',i=(s=(s=t.galleryStr||(e!=null?e.galleryStr:e))!=null?s:f,typeof s===a?s.call(e,{name:"galleryStr",hash:{},data:r}):s),i!=null&&(l+=i),l+"</p>\r\n					</div>\r\n				</div>	\r\n			</td>\r\n		</tr>\r\n	</tbody>\r\n</table>"},useData:!0})}),define("lib-build/hbars!my/content/tabs/Tabs",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.escapeExpression,f='		<div class="content-tab media-tab left';return i=t["if"].call(e,e!=null?e.allClear:e,{name:"if",hash:{},fn:this.program(2,r),inverse:this.program(4,r),data:r}),i!=null&&(f+=i),f+'" data-media-type="'+a((s=(s=t.type||(e!=null?e.type:e))!=null?s:u,typeof s===o?s.call(e,{name:"type",hash:{},data:r}):s))+'" data-tab-type="'+a((s=(s=t.type||(e!=null?e.type:e))!=null?s:u,typeof s===o?s.call(e,{name:"type",hash:{},data:r}):s))+'">			\r\n			<h3 class="item-subtitle content-tab-title">'+a((s=(s=t.title||(e!=null?e.title:e))!=null?s:u,typeof s===o?s.call(e,{name:"title",hash:{},data:r}):s))+"</h3>\r\n		</div>\r\n"},2:function(e,t,n,r){return""},4:function(e,t,n,r){return" icon-stories-error tab-error"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u='<div class="content-tabs toggle media-tabs">\r\n';return i=t.each.call(e,e!=null?e.tabs:e,{name:"each",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(u+=i),u+'		<div class="content-tab media-tab right" data-tab-type="tags">\r\n			<h3 class="item-subtitle content-tab-title">'+o(s((i=e!=null?e.labels:e)!=null?i.tags:i,e))+'</h3>\r\n		</div>		\r\n		<div class="content-tab media-tab right" data-tab-type="gallery">\r\n			<h3 class="item-subtitle content-tab-title">'+o(s((i=e!=null?e.labels:e)!=null?i.gallery:i,e))+'</h3>\r\n		</div>		\r\n</div>\r\n<div class="sharing-alert-container column-12">\r\n	<div class="alert sharing-alert">\r\n		<h4 class="sharing-alert-text"></h4>\r\n	</div>\r\n</div>	'},useData:!0})}),define("lib-build/hbars!my/content/Error",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a="function",f=t.helperMissing;return'	<h1 class="header-light error-header">'+u(o((i=e!=null?e.labels:e)!=null?i.consolationNoStories:i,e))+'</h1>\r\n	<div class="tooltip above">\r\n		<div class="btn modal-show create-story-disabled" id="create-story-no-stories-btn" data-modal="create-story">'+u(o((i=e!=null?e.labels:e)!=null?i.createFirstStory:i,e))+'</div>\r\n		<div class="tooltip-wrapper create-disabled-tooltip">\r\n			<span class="tooltip-content">'+u((s=(s=t.disabledTooltip||(e!=null?e.disabledTooltip:e))!=null?s:f,typeof s===a?s.call(e,{name:"disabledTooltip",hash:{},data:r}):s))+"</span>\r\n		</div>\r\n	</div>	\r\n"},3:function(e,t,n,r){var i,s="";return i=t["if"].call(e,(i=e!=null?e.error:e)!=null?i.noSearchResults:i,{name:"if",hash:{},fn:this.program(4,r),inverse:this.program(6,r),data:r}),i!=null&&(s+=i),s},4:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'		<h2 class="header-light error-header">'+u((i=(i=t.consolationSearch||(e!=null?e.consolationSearch:e))!=null?i:o,typeof i===s?i.call(e,{name:"consolationSearch",hash:{},data:r}):i))+"</h2>\r\n"},6:function(e,t,n,r){var i,s="";return i=t["if"].call(e,(i=e!=null?e.error:e)!=null?i.inaccessible:i,{name:"if",hash:{},fn:this.program(7,r),inverse:this.program(9,r),data:r}),i!=null&&(s+=i),s},7:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return"			<h3>"+o(s((i=e!=null?e.labels:e)!=null?i.cantShowStories:i,e))+"</h3>\r\n"},9:function(e,t,n,r){var i,s="";return i=t["if"].call(e,(i=e!=null?e.error:e)!=null?i.incompatibleBrowser:i,{name:"if",hash:{},fn:this.program(10,r),inverse:this.noop,data:r}),i!=null&&(s+=i),s},10:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'				<h2 class="header-light error-header">'+u((i=(i=t.incompatibleBrowser||(e!=null?e.incompatibleBrowser:e))!=null?i:o,typeof i===s?i.call(e,{name:"incompatibleBrowser",hash:{},data:r}):i))+"</h2>	\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i;return i=t["if"].call(e,(i=e!=null?e.error:e)!=null?i.noStories:i,{name:"if",hash:{},fn:this.program(1,r),inverse:this.program(3,r),data:r}),i!=null?i:""},useData:!0})}),define("lib-build/hbars!my/content/scanning/ErrorStatusPane",["Handlebars"],function(e){return e.template({1:function(e,t,n,r,i){var s,o=t.helperMissing,u="";return s=(t.ifGreaterThan||e&&e.ifGreaterThan||o).call(e,(s=e!=null?e.items:e)!=null?s.length:s,0,{name:"ifGreaterThan",hash:{},fn:this.program(2,r,i),inverse:this.noop,data:r}),s!=null&&(u+=s),u},2:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l='				<div class="notification-issue" data-issue-type="'+f((o=(o=t.title||(e!=null?e.title:e))!=null?o:a,typeof o===u?o.call(e,{name:"title",hash:{},data:r}):o))+'" data-media-type="'+f((o=(o=t.media||(e!=null?e.media:e))!=null?o:a,typeof o===u?o.call(e,{name:"media",hash:{},data:r}):o))+'">					\r\n					<div class="notification-explanation">\r\n						<p class="notification-text">'+f((o=(o=t.text||(e!=null?e.text:e))!=null?o:a,typeof o===u?o.call(e,{name:"text",hash:{},data:r}):o))+'</p>\r\n						<p class="notification-subtext';return s=(t.ifGreaterThan||e&&e.ifGreaterThan||a).call(e,(s=e!=null?e.actions:e)!=null?s.length:s,0,{name:"ifGreaterThan",hash:{},fn:this.program(3,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+=' leader-half trailer-half">',s=(o=(o=t.subtext||(e!=null?e.subtext:e))!=null?o:a,typeof o===u?o.call(e,{name:"subtext",hash:{},data:r}):o),s!=null&&(l+=s),l+="</p>\r\n					</div>\r\n",s=(t.ifGreaterThan||e&&e.ifGreaterThan||a).call(e,(s=e!=null?e.actions:e)!=null?s.length:s,0,{name:"ifGreaterThan",hash:{},fn:this.program(5,r,i),inverse:this.noop,data:r}),s!=null&&(l+=s),l+"				</div>\r\n"},3:function(e,t,n,r){return" actions"},5:function(e,t,n,r,i){var s,o='						<div class="issue-actions">\r\n';return s=t.each.call(e,e!=null?e.actions:e,{name:"each",hash:{},fn:this.program(6,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o+"						</div>\r\n"},6:function(e,t,n,r,i){var s,o="";return s=t["if"].call(e,e!=null?e.isLink:e,{name:"if",hash:{},fn:this.program(7,r,i),inverse:this.program(16,r,i),data:r}),s!=null&&(o+=s),o},7:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='									<a href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'" class=" issue-action btn small';return s=t["if"].call(e,e!=null?e.positive:e,{name:"if",hash:{},fn:this.program(8,r,i),inverse:this.program(10,r,i),data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.modalName:e,{name:"if",hash:{},fn:this.program(12,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-issue-type="'+f(l(i[2]!=null?i[2].title:i[2],e))+'" data-action="'+f((o=(o=t.action||(e!=null?e.action:e))!=null?o:a,typeof o===u?o.call(e,{name:"action",hash:{},data:r}):o))+'"',s=t["if"].call(e,e!=null?e.modalName:e,{name:"if",hash:{},fn:this.program(14,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+' target="_blank">'+f((o=(o=t.text||(e!=null?e.text:e))!=null?o:a,typeof o===u?o.call(e,{name:"text",hash:{},data:r}):o))+"</a>									\r\n"},8:function(e,t,n,r){return" ok positive"},10:function(e,t,n,r){return" issue negative"},12:function(e,t,n,r){return" modal-show"},14:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return' data-modal="'+u((i=(i=t.modalName||(e!=null?e.modalName:e))!=null?i:o,typeof i===s?i.call(e,{name:"modalName",hash:{},data:r}):i))+'"'},16:function(e,t,n,r,i){var s,o,u=this.lambda,a=this.escapeExpression,f="function",l=t.helperMissing,c='									<button class="issue-action btn server-button small';return s=t["if"].call(e,e!=null?e.positive:e,{name:"if",hash:{},fn:this.program(8,r,i),inverse:this.program(10,r,i),data:r}),s!=null&&(c+=s),s=t["if"].call(e,e!=null?e.modalName:e,{name:"if",hash:{},fn:this.program(12,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='" data-issue-type="'+a(u(i[2]!=null?i[2].title:i[2],e))+'" data-action="'+a((o=(o=t.action||(e!=null?e.action:e))!=null?o:l,typeof o===f?o.call(e,{name:"action",hash:{},data:r}):o))+'"',s=t["if"].call(e,e!=null?e.modalName:e,{name:"if",hash:{},fn:this.program(14,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+">"+a((o=(o=t.text||(e!=null?e.text:e))!=null?o:l,typeof o===f?o.call(e,{name:"text",hash:{},data:r}):o))+"</button>\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a='<div class="notification-pane error">\r\n	<div class="notification-title">		\r\n		<h5 class="item-subtitle">'+u(o((s=e!=null?e.labels:e)!=null?s.foundSomeIssues:s,e))+'</h5><!--\r\n	 --><div class="refresh-tooltip-container tooltip above">\r\n			<div class="refresh icon-refresh server-button"></div>\r\n			<div class="tooltip-wrapper">\r\n				<span class="tooltip-content">'+u(o((s=e!=null?e.labels:e)!=null?s.refreshExplanation:s,e))+'</span>\r\n			</div>\r\n		</div>\r\n	</div>\r\n	<div class="notification-list">\r\n';return s=t.each.call(e,e!=null?e.issues:e,{name:"each",hash:{},fn:this.program(1,r,i),inverse:this.noop,data:r}),s!=null&&(a+=s),a+"	</div>\r\n</div>"},useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/scanning/SuccessStatusPane",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return'<div class="notification-pane success">\r\n	<div class="notification-title">		\r\n		<h5 class="item-subtitle">'+o(s((i=e!=null?e.labels:e)!=null?i.noIssuesFound:i,e))+'</h5><!--\r\n	 --><div class="refresh-tooltip-container tooltip above">\r\n			<div class="refresh icon-refresh server-button"></div>\r\n			<div class="tooltip-wrapper">\r\n				<span class="tooltip-content">'+o(s((i=e!=null?e.labels:e)!=null?i.refreshExplanation:i,e))+"</span>\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/scanning/ErrorNotification",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return'<div class="error-notification-pane">\r\n	<div class="error-notification-title">\r\n		<p class="notification-text">'+o(s((i=e!=null?e.data:e)!=null?i.text:i,e))+"</p>\r\n	</div>	\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/scanning/SuccessNotification",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'<div class="success-notification">\r\n	<div class="success-notification-inner-box">\r\n		<p class="notification-text">'+u((i=(i=t.label||(e!=null?e.label:e))!=null?i:o,typeof i===s?i.call(e,{name:"label",hash:{},data:r}):i))+"</p>	\r\n	</div>	\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/dialogs/ImagePicker",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a="function",f=t.helperMissing;return'<div id="modal-image-picker" class="modal image-picker" data-modal="image-picker">	\r\n	<div id="image-cropper">\r\n\r\n		<div id="choose-panel">\r\n			<div class="dialog-header picker">\r\n				<div>\r\n					<span class="dialog-header-icon icon-stories-portrait"></span>\r\n					<h3 class="dialog-title">'+u(o((i=e!=null?e.labels:e)!=null?i.chooseAnImage:i,e))+'</h3>\r\n				</div>\r\n				<div class="close-dialog picker modal-dismiss icon-close"></div>\r\n			</div>\r\n			<div class="dialog-body leader-1">\r\n				<div class="image-carousel">\r\n					<div class="carousel-page-status">\r\n						<span id="current-carousel-image"></span><span>/</span><span id="total-carousel-images"></span>\r\n					</div>\r\n					<div id="image-previous" class="image-arrow carousel-arrow icon-stories-arrow-left"></div>					\r\n					<div id="carousel-image-container">\r\n						<div id="carousel-image-and-text">\r\n							<img id="carousel-image" src="//placehold.it/1200x700"/>\r\n							<div id="carousel-image-loading">\r\n								<h2 class="picker-image-loading-text">'+u((s=(s=t.loading||(e!=null?e.loading:e))!=null?s:f,typeof s===a?s.call(e,{name:"loading",hash:{},data:r}):s))+'</h2>\r\n							</div>\r\n						</div>						\r\n						<div id="loading-prompt" class="picker-prompt">\r\n							<div class="picker-prompt-text-container">\r\n								<h3 class="picker-prompt-text">'+u(o((i=e!=null?e.labels:e)!=null?i.imagesLoading:i,e))+'</h3>\r\n							</div>					\r\n						</div>\r\n						<div id="empty-prompt" class="picker-prompt">\r\n							<div class="picker-prompt-text-container">\r\n								<h3 class="picker-prompt-text">'+u(o((i=e!=null?e.labels:e)!=null?i.noImages:i,e))+'</h3>\r\n								<h5 class="picker-prompt-subtext">'+u(o((i=e!=null?e.labels:e)!=null?i.clickBelowTip:i,e))+'</h5>\r\n							</div>\r\n						</div>\r\n						<div id="error-prompt" class="picker-prompt">\r\n							<div class="picker-prompt-text-container">\r\n								<h3 class="picker-prompt-text">'+u(o((i=e!=null?e.labels:e)!=null?i.errorLoading:i,e))+'</h3>\r\n								<h5 class="picker-prompt-subtext">'+u(o((i=e!=null?e.labels:e)!=null?i.clickBelowTip:i,e))+'</h5>\r\n							</div>\r\n						</div>\r\n						<div id="no-image-prompt" class="picker-prompt">\r\n							<div class="picker-prompt-text-container">\r\n								<h3 class="picker-prompt-text">'+u((s=(s=t.noImage||(e!=null?e.noImage:e))!=null?s:f,typeof s===a?s.call(e,{name:"noImage",hash:{},data:r}):s))+'</h3>\r\n							</div>\r\n						</div>\r\n					</div>			\r\n					<div id="image-next" class="image-arrow carousel-arrow icon-stories-arrow-right"></div>\r\n					<h5 class="invalid-dimensions choose item-subtitle">'+u(o((i=e!=null?e.labels:e)!=null?i.minimumDimensions:i,e))+'</h5>\r\n					<h5 class="accepted-file-types choose item-subtitle">'+u(o((i=e!=null?e.labels:e)!=null?i.supportedFileTypes:i,e))+'</h5>\r\n				</div>\r\n				<div id="or-upload">\r\n					<h4 class="or leader-half trailer-half">'+u(o((i=e!=null?e.labels:e)!=null?i.or:i,e))+'</h4>\r\n					<button id="upload-image" class="btn picker-action">'+u(o((i=e!=null?e.labels:e)!=null?i.uploadAnImage:i,e))+'</button>\r\n				</div>\r\n				<div id="picker-not-supported" class="incompatible-browser-message">\r\n					<h3 id="not-supported-picker-text" class="header-light error-header"></h3>\r\n				</div>				\r\n			</div>\r\n			<div class="modal-footer picker">\r\n				<div class="btn save-image picker disabled">'+u(o((i=e!=null?e.labels:e)!=null?i.save:i,e))+'</div>\r\n			</div>			\r\n		</div>\r\n		<div id="upload-panel">\r\n			<div class="dialog-header picker">\r\n				<div>\r\n					<span class="dialog-header-icon icon-stories-positive"></span>\r\n					<h3 class="dialog-title">'+u(o((i=e!=null?e.labels:e)!=null?i.uploadAnImage:i,e))+'</h3>\r\n				</div>\r\n				<div class="close-dialog picker modal-dismiss icon-close"></div>		\r\n			</div>\r\n			<div class="dialog-body leader-1">\r\n				<div id="drag-drop-zone" class="cropit-drag-zone">\r\n					<div id="drag-drop-inside">\r\n						<h2 id="drag-drop-text" class="drag-drop-main-text">'+u(o((i=e!=null?e.labels:e)!=null?i.dragAndDrop:i,e))+'</h2>\r\n						<h2 class="drag-drop-or drag-drop-main-text">'+u(o((i=e!=null?e.labels:e)!=null?i.or:i,e))+'</h2>\r\n						<form id="image-picker-image-form">\r\n							<input type="file" accept="image/jpeg, image/png, image/gif" class="cropit-image-input" />\r\n						</form>\r\n						<button id="choose-image" class="btn select-image-btn picker-action leader-half trailer-half">'+u(o((i=e!=null?e.labels:e)!=null?i.chooseAnImage:i,e))+'</button>\r\n						<span class="supporting-text drag-drop accepted-file-types upload">'+u(o((i=e!=null?e.labels:e)!=null?i.supportedFileTypes:i,e))+'</span>\r\n						<span class="supporting-text drag-drop minimum-dimensions upload">'+u(o((i=e!=null?e.labels:e)!=null?i.minimumDimensions:i,e))+'</span>\r\n					</div>\r\n					<div id="drag-drop-loading">\r\n						<h2 class="picker-image-loading-text">'+u((s=(s=t.loading||(e!=null?e.loading:e))!=null?s:f,typeof s===a?s.call(e,{name:"loading",hash:{},data:r}):s))+'</h2>\r\n					</div>			\r\n				</div>			\r\n			</div>\r\n			<div class="modal-footer picker">\r\n				<div class="btn transparent back upload picker">'+u(o((i=e!=null?e.dialogLabels:e)!=null?i.back:i,e))+'</div>\r\n				<div class="btn save-image picker disabled">'+u(o((i=e!=null?e.labels:e)!=null?i.save:i,e))+'</div>\r\n			</div>\r\n		</div>\r\n		<div id="crop-panel">\r\n			<div class="dialog-header picker">\r\n				<div>\r\n					<span class="dialog-header-icon icon-stories-portrait"></span>\r\n					<h3 class="dialog-title crop">'+u(o((i=e!=null?e.labels:e)!=null?i.cropImage:i,e))+'</h3>\r\n				</div>\r\n				<div class="close-dialog picker modal-dismiss icon-close"></div>\r\n			</div>\r\n			<div class="dialog-body crop leader-1 cropping">\r\n				<div class="cropit-image-preview-container">\r\n			    	<div class="cropit-image-preview"></div>\r\n				</div>				\r\n				<div id="range-container">\r\n					<div class="icon-stories-portrait range-icon small"></div>\r\n					<input type="range" id="image-zoom-slider" class="cropit-image-zoom-input"/>\r\n					<div class="icon-stories-portrait range-icon large"></div>\r\n				</div>\r\n				<img id="uncropped-image" src=""/>\r\n				<div id="no-crop-warning" class="leader-half">\r\n					<span id="no-crop-text" class="save-mode-text"></span>\r\n				</div>				\r\n			</div>\r\n			<div class="dialog-body crop leader-1 saving">\r\n				<div>\r\n					<h3 class="dialog-title saving">'+u(o((i=e!=null?e.labels:e)!=null?i.savingImage:i,e))+'</h3>\r\n				</div>\r\n			</div>\r\n			<div class="dialog-body crop leader-1 saved">\r\n				<div>\r\n					<div class="icon-stories-check-inverted check saved"></div>\r\n					<h3 class="dialog-title saved">'+u(o((i=e!=null?e.labels:e)!=null?i.saved:i,e))+'</h3>\r\n				</div>\r\n			</div>\r\n			<div class="dialog-body crop leader-1 error">\r\n				<div>\r\n					<h3 class="dialog-title error">'+u(o((i=e!=null?e.labels:e)!=null?i.errorSaving:i,e))+'</h3>\r\n				</div>\r\n			</div>\r\n			<div class="modal-footer picker">\r\n				<div class="btn transparent back crop picker">'+u(o((i=e!=null?e.dialogLabels:e)!=null?i.back:i,e))+'</div>\r\n				<div class="btn save-image picker">'+u(o((i=e!=null?e.labels:e)!=null?i.save:i,e))+"</div>\r\n			</div>\r\n		</div>\r\n	</div>		\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/WhereAreStories",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'<div id="find-more-row" class="">\r\n	<button id="find-more-button" class="btn clear modal-show clear-inverse" data-modal="find-more-modal">'+u((i=(i=t.whereAreStories||(e!=null?e.whereAreStories:e))!=null?i:o,typeof i===s?i.call(e,{name:"whereAreStories",hash:{},data:r}):i))+"</btn>\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/dialogs/FindMoreDialog",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a="function",f=t.helperMissing,l='<div class="modal find-modal" data-modal="find-more-modal">\r\n	<div id="find-header" class="dialog-header padding-leader-1 padding-trailer-1">\r\n		<span class="dialog-header-icon"></span>\r\n		<h3 class="dialog-title">'+u(o((i=e!=null?e.labels:e)!=null?i.whereAreStories:i,e))+'</h3>\r\n	</div>	\r\n	<div id="find-body" class="dialog-body">\r\n		<div id="find-body-wrapper" class="leader-1 trailer-2">\r\n			<div class="trailer-1">\r\n				<p class="main-text">';return i=(s=(s=t.notSeeExplanation||(e!=null?e.notSeeExplanation:e))!=null?s:f,typeof s===a?s.call(e,{name:"notSeeExplanation",hash:{},data:r}):s),i!=null&&(l+=i),l+'</p>\r\n			</div>\r\n		</div>\r\n		<div class="dynamic-container trailer">\r\n			<div id="find-searching-stories" class="dynamic-component active">\r\n				<div id="find-loader-title"></div>\r\n			</div>\r\n			<div id="find-all-good" class="dynamic-component">\r\n				<h3 class="single-text">'+u(o((i=e!=null?e.labels:e)!=null?i.allUpToDate:i,e))+'</h3>\r\n			</div>\r\n			<div id="find-error-searching" class="dynamic-component">\r\n				<h3 class="single-text">'+u(o((i=e!=null?e.labels:e)!=null?i.errorScanningForStories:i,e))+'</h3>\r\n			</div>\r\n			<div id="find-update-summary" class="dynamic-component">\r\n				<p class="main-text">'+u(o((i=e!=null?e.labels:e)!=null?i.followingStoriesToUpdate:i,e))+'</p>\r\n				<div id="find-update-table"></div>\r\n			</div>			\r\n			<div id="find-update-progress" class="dynamic-component">\r\n				<div id="find-update-progress-bar-container"></div>\r\n			</div>\r\n			<div id="find-update-complete" class="dynamic-component">\r\n				<div id="update-complete-icon" class="icon-stories-check-inverted"></div>\r\n				<h3 class="single-text">'+u(o((i=e!=null?e.labels:e)!=null?i.updateSucceeded:i,e))+" "+u(o((i=e!=null?e.labels:e)!=null?i.reloadingStories:i,e))+'</h3>\r\n			</div>\r\n			<div id="find-error-updating" class="dynamic-component">\r\n				<h3 class="single-text">'+u(o((i=e!=null?e.labels:e)!=null?i.errorUpdatingStories:i,e))+'</h3>\r\n			</div>\r\n		</div>			\r\n	</div>\r\n	<div class="modal-footer">\r\n		<button id="close-find" class="btn transparent modal-dismiss close-dialog modal-bottom-button">'+u(o((i=e!=null?e.dialogLabels:e)!=null?i.close:i,e))+'</button>\r\n		<button id="update-all" class="btn modal-bottom-button inactive">'+u(o((i=e!=null?e.labels:e)!=null?i.updateAll:i,e))+"</button>\r\n	</div>	\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/dialogs/UpdateTable",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'		<tr class="media-row">							\r\n			<td class="media-title image column-12">\r\n				<a href="'+u((i=(i=t.url||(e!=null?e.url:e))!=null?i:o,typeof i===s?i.call(e,{name:"url",hash:{},data:r}):i))+'" class="media-link" target="_blank" title="'+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+'">'+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+'</a>\r\n			</td>\r\n			<td class="column-6">\r\n				'+u((i=(i=t.type||(e!=null?e.type:e))!=null?i:o,typeof i===s?i.call(e,{name:"type",hash:{},data:r}):i))+'\r\n			</td>\r\n			<td class="sections column-6">\r\n				'+u((i=(i=t.modifiedLocalizedDate||(e!=null?e.modifiedLocalizedDate:e))!=null?i:o,typeof i===s?i.call(e,{name:"modifiedLocalizedDate",hash:{},data:r}):i))+"\r\n			</td>\r\n		</tr>				\r\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u='<table class="update-table content-table scrollable-table">\r\n	<thead>\r\n		<tr>\r\n			<td class="column-12">'+o(s((i=e!=null?e.labels:e)!=null?i.title:i,e))+'</td>\r\n			<td class="column-6">'+o(s((i=e!=null?e.labels:e)!=null?i.typeOfStoryMap:i,e))+'</td>\r\n			<td class="column-6">'+o(s((i=e!=null?e.labels:e)!=null?i.lastModified:i,e))+'</td>\r\n		</tr>\r\n	</thead>\r\n	<tbody class="custom-scrollbar">\r\n';return i=t.each.call(e,e!=null?e.items:e,{name:"each",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(u+=i),u+"	</tbody>\r\n</table>"},useData:!0})}),define("lib-build/hbars!my/content/ProgressBar",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'<div class="centered progress-box">\r\n	<h2 class="progress-title">'+u((i=(i=t.title||(e!=null?e.title:e))!=null?i:o,typeof i===s?i.call(e,{name:"title",hash:{},data:r}):i))+'</h2>\r\n	<div class="centered progress-inner-box">\r\n		<div data-dojo-type="dijit/ProgressBar" data-dojo-id="'+u((i=(i=t.dojoId||(e!=null?e.dojoId:e))!=null?i:o,typeof i===s?i.call(e,{name:"dojoId",hash:{},data:r}):i))+'" id="'+u((i=(i=t.id||(e!=null?e.id:e))!=null?i:o,typeof i===s?i.call(e,{name:"id",hash:{},data:r}):i))+'"></div><!--\r\n	 --><h3 class="progress-details">'+u((i=(i=t.progressString||(e!=null?e.progressString:e))!=null?i:o,typeof i===s?i.call(e,{name:"progressString",hash:{},data:r}):i))+'</h3>\r\n		<button id="'+u((i=(i=t.stopId||(e!=null?e.stopId:e))!=null?i:o,typeof i===s?i.call(e,{name:"stopId",hash:{},data:r}):i))+'" class="btn clear small clear-inverse">'+u((i=(i=t.stop||(e!=null?e.stop:e))!=null?i:o,typeof i===s?i.call(e,{name:"stop",hash:{},data:r}):i))+"</button>\r\n	</div>			\r\n</div>"},useData:!0})}),define("my/content/Templater",["dojo/parser","my/models/Credentials","Handlebars","my/helpers/HandlebarsHelpers","my/helpers/Formatter","lib-build/hbars!./Infographics","lib-build/hbars!./scanning/ScanProgress","lib-build/hbars!./scanning/ScanDone","lib-build/hbars!./scanning/ScanStop","lib-build/hbars!./scanning/ScanError","lib-build/hbars!./Header","lib-build/hbars!./Loading","lib-build/hbars!./dialogs/DeleteDialog","lib-build/hbars!./dialogs/ShareDialog","lib-build/hbars!./tabs/Maps","lib-build/hbars!./tabs/Images","lib-build/hbars!./tabs/Videos","lib-build/hbars!./tabs/Webpages","lib-build/hbars!./tabs/Tags","lib-build/hbars!./tabs/SubmitToGallery","lib-build/hbars!./tabs/Tabs","lib-build/hbars!./Error","lib-build/hbars!./scanning/ErrorStatusPane","lib-build/hbars!./scanning/SuccessStatusPane","lib-build/hbars!./scanning/ErrorNotification","lib-build/hbars!./scanning/SuccessNotification","lib-build/hbars!./dialogs/ImagePicker","lib-build/hbars!./WhereAreStories","lib-build/hbars!./dialogs/FindMoreDialog","lib-build/hbars!./dialogs/UpdateTable","lib-build/hbars!./ProgressBar"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";var M=function(e){var r=i.formatPageBanner(e||t.getCredentials().userName);$("#my-stories-header").html(l({data:i18n.header,title:r,sharingLevels:i18n.sharingLevel,engStrings:window.engStrings},{helpers:n.helpers}))},_=function(){$("#find-more-container").html(k({data:i18n.loading,whereAreStories:i18n.cantFindStories.whereAreStories},{helpers:n.helpers}))},D=function(){var e='<a href="http://storymaps.arcgis.com/en/faq/#question12" class="linkable-text" target="_blank">'+i18n.cantFindStories.faq+"</a>",t=i18n.cantFindStories.notSeeExplanation.replace(/{{STORY_MAP_TOUR}}/g,window.engStrings.storyMapTour).replace(/{{JOURNAL}}/g,window.engStrings.journal).replace(/{{MAP_SERIES}}/g,window.engStrings.mapSeries).replace(/{{SWIPE_SPYGLASS}}/g,window.engStrings.swipeSpyglass).replace(/{{FAQ}}/g,e);$("#modal-container-find-stories").html(L({data:i18n.loading,labels:i18n.cantFindStories,dialogLabels:i18n.storyMap.dialog,notSeeExplanation:t},{helpers:n.helpers}))},P=function(e){$("#find-update-table").html(A({items:e,labels:i18n.cantFindStories},{helpers:n.helpers}))},H=function(e,t,r){e.html(c({title:t,small:r},{helpers:n.helpers}))},B=function(){$("#modal-container-delete").html(h({data:i18n.deleteModal},{helpers:n.helpers}))},j=function(e,t,r,i){$("#modal-container-share").html(p({shortLink:e,embedUrl:t,appUrl:r,sharingLevel:i,labels:i18n.storyMap.shareDialog,dialogLabels:i18n.storyMap.dialog},{helpers:n.helpers}))},F=function(){$("#modal-container-image-picker").html(C({labels:i18n.storyMap.imagePicker,dialogLabels:i18n.storyMap.dialog,noImage:i18n.content.tooltipErrors.imageInaccessible,loading:i18n.content.general.loading},{helpers:n.helpers}))},I=function(e,t){$('.item[data-id="'+t+'"] .status-pane-container').html(S({issues:e,labels:i18n.content.notification},{helpers:n.helpers}))},q=function(e){$('.item[data-id="'+e+'"] .status-pane-container').html(x({labels:i18n.content.notification},{helpers:n.helpers}))},R=function(e,t){$('.item[data-id="'+t+'"] .notification-container').html(T({data:{text:e},labels:i18n.content},{helpers:n.helpers}))},U=function(e,t){$('.item[data-id="'+e+'"] .notification-container').html(N({label:t},{helpers:n.helpers}))},z=function(e,r){var i=t.getCredentials().portal,s=i.canSharePublic===!1?!0:!1;i&&i.user&&i.user.role&&i.user.role.toLowerCase()==="org_admin"&&(s=!1),$('.item[data-id="'+r+'"] .maps-container').html(d({data:e,labels:i18n.content,sharingLevel:i18n.sharingLevel,unscannableWarning:i18n.content.tooltipWarnings.cantScanThisTypeAlt,publicDisabled:s,cantSharePublicMessage:i18n.content.errors.publicDisabled,isBuilder:window.builderIntegration},{helpers:n.helpers}))},W=function(e,r){var i=t.getCredentials().token,s=[],o=[],u=null;for(var a=0;a<e.items.length;a++)u=e.items[a],u.info.isThumbnail?o.push(u):s.push(u);$('.item[data-id="'+r+'"] .images-container').html(v({images:s,thumbnails:o,titleType:e.titleType,storyComponent:e.storyComponent,labels:i18n.content,token:i,engStrings:window.engStrings,isBuilder:window.builderIntegration},{helpers:n.helpers}))},X=function(e,t){$('.item[data-id="'+t+'"] .videos-container').html(m({data:e,labels:i18n.content,engStrings:window.engStrings,isBuilder:window.builderIntegration},{helpers:n.helpers}))},V=function(e,t){$('.item[data-id="'+t+'"] .webpages-container').html(g({data:e,labels:i18n.content,isBuilder:window.builderIntegration},{helpers:n.helpers}))},J=function(e,t,r){var i=i18n.storyMap.submitToGallery,s='<a href="http://storymaps.arcgis.com/en/gallery" class="linkable-text" target="_blank">'+i.ourGallery+"</a>",o=i.galleryTip.replace(/{{THE_GALLERY}}/g,s),u='<span class="linkable-text subject-tags-link">'+i18n.storyMap.submitToGallery.storyMapTopicSubject+"</span>",a=i18n.storyMap.submitToGallery.chosenSubjectAlt.replace(/{{SUBJECT}}/g,u);$('.item[data-id="'+t+'"] .submit-to-gallery-container').html(b({data:e,labels:i18n.storyMap.submitToGallery,nominated:r,galleryStr:o,subjectTagsString:a},{helpers:n.helpers}))},K=function(e,t){$('.item[data-id="'+t+'"] .tags-container').html(y({data:e,labels:i18n.storyMap.tags,collectionList:i18n.collectionList},{helpers:n.helpers}))},Q=function(e,t){$('.item[data-id="'+t+'"] .content-tabs-container.media').html(w({tabs:e.media,labels:i18n.content.media,accessLevel:e.storyMap.accessLevel},{helpers:n.helpers}))},G=function(e,t){$('.item[data-id="'+t+'"] .infographics-container').html(s({infographics:e}))},Y=function(e){var t=i18n.content.errors.consolationSearch,r="";e.noSearchResults&&e.isEnglish&&(t=window.engStrings.noStoriesInSearch),e.incompatibleBrowser&&(r=i18n.content.errors.notCompatibleWithBrowser.replace(/{{VERSION_NUMBER}}/g,e.version)),$("#error-container").html(E({error:e,labels:i18n.content.errors,disabledTooltip:i18n.header.headerDisabledTooltip,consolationSearch:t,incompatibleBrowser:r},{helpers:n.helpers})),$("#error-container").css("display","block")},Z=function(t){var n=et(t);$("#scan-all-progress").html(o({progressBarWidget:n})),e.parse()},et=function(e){var t=null;return e.progressBar&&e.progressBar.destroy(),t=O({progressString:e.progressString,stop:i18n.progress.stop,title:e.title,id:e.progressBarId,dojoId:e.progressBarDojoId,stopId:e.stopId}),t},tt=function(e){var t="",n=i18n.progress;e===0?t=n.noStoriesWithIssuesLower:app.cfg.isEnglish?e===1?t=window.engStrings.storiesHaveIssuesSingle.replace(/{{NUM_STORIES}}/g,e):t=window.engStrings.storiesHaveIssuesPlural.replace(/{{NUM_STORIES}}/g,e):t=n.storiesWithIssues.replace(/{{NUM_STORIES}}/g,e),$("#scan-all-progress").html(u({issueStr:t,labels:i18n.progress}))},nt=function(e,t,n){var r="";app.cfg.isEnglish?r=window.engStrings.scanStopMessage.replace(/{{NUM_SCANNED}}/g,e).replace(/{{TOTAL}}/g,t).replace(/{{NUM_ISSUES}}/g,n):r=i18n.progress.scanStopped.replace(/{{NUM_SCANNED}}/g,e).replace(/{{ISSUE_STORIES}}/g,n),$("#scan-all-progress").html(a({stoppedStatement:r}))},rt=function(){$("#scan-all-progress").html(f({labels:i18n.progress}))};return{templatizeHeader:M,templatizeWhereAreStories:_,templatizeFindMoreStoriesDialog:D,templatizeUpdateTable:P,templatizeLoading:H,templatizeDeleteDialog:B,templatizeShareDialog:j,templatizeImagePicker:F,templatizeErrorStatusPane:I,templatizeSuccessStatusPane:q,templatizeErrorNotification:R,templatizeSuccessNotification:U,templatizeInfographics:G,templatizeMaps:z,templatizeImages:W,templatizeVideos:X,templatizeWebpages:V,templatizeSubmitToGallery:J,templatizeTags:K,templatizeTabs:Q,templatizeError:Y,templatizeScanProgress:Z,templatizeProgressBar:et,templatizeScanDone:tt,templatizeScanStopped:nt,templatizeScanError:rt}}),function(e,t){function n(e,t,n){var r=l[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function r(t){var n=a(),r=n._rgba=[];return t=t.toLowerCase(),d(u,function(e,i){var s,o=i.re.exec(t),u=o&&i.parse(o),a=i.space||"rgba";if(u)return s=n[a](u),n[f[a].cache]=s[f[a].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&e.extend(r,p.transparent),n):p[t]}function i(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",o=/^([\-+])=\s*(\d+\.?\d*)/,u=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],a=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},f={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=a.support={},h=e("<p>")[0],p,d=e.each;h.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=h.style.backgroundColor.indexOf("rgba")>-1,d(f,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),a.fn=e.extend(a.prototype,{parse:function(i,s,o,u){if(i===t)return this._rgba=[null,null,null,null],this;if(i.jquery||i.nodeType)i=e(i).css(s),s=t;var l=this,c=e.type(i),h=this._rgba=[];s!==t&&(i=[i,s,o,u],c="array");if(c==="string")return this.parse(r(i)||p._default);if(c==="array")return d(f.rgba.props,function(e,t){h[t.idx]=n(i[t.idx],t)}),this;if(c==="object")return i instanceof a?d(f,function(e,t){i[t.cache]&&(l[t.cache]=i[t.cache].slice())}):d(f,function(t,r){var s=r.cache;d(r.props,function(e,t){if(!l[s]&&r.to){if(e==="alpha"||i[e]==null)return;l[s]=r.to(l._rgba)}l[s][t.idx]=n(i[e],t,!0)}),l[s]&&e.inArray(null,l[s].slice(0,3))<0&&(l[s][3]=1,r.from&&(l._rgba=r.from(l[s])))}),this},is:function(e){var t=a(e),n=!0,r=this;return d(f,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],d(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return d(f,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=a(e),i=r._space(),s=f[i],o=this.alpha()===0?a("transparent"):this,u=o[s.cache]||s.to(o._rgba),c=u.slice();return r=r[s.cache],d(s.props,function(e,i){var s=i.idx,o=u[s],a=r[s],f=l[i.type]||{};if(a===null)return;o===null?c[s]=a:(f.mod&&(a-o>f.mod/2?o+=f.mod:o-a>f.mod/2&&(o-=f.mod)),c[s]=n((a-o)*t+o,i))}),this[i](c)},blend:function(t){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=a(t)._rgba;return a(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(r*255)),"#"+e.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),a.fn.parse.prototype=a.fn,f.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,u===0?c=0:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},f.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],s=e[3],o=r<=.5?r*(1+n):r+n-r*n,u=2*r-o;return[Math.round(i(u,o,t+1/3)*255),Math.round(i(u,o,t)*255),Math.round(i(u,o,t-1/3)*255),s]},d(f,function(r,i){var s=i.props,u=i.cache,f=i.to,l=i.from;a.fn[r]=function(r){f&&!this[u]&&(this[u]=f(this._rgba));if(r===t)return this[u].slice();var i,o=e.type(r),c=o==="array"||o==="object"?r:arguments,h=this[u].slice();return d(s,function(e,t){var r=c[o==="object"?e:t.idx];r==null&&(r=h[t.idx]),h[t.idx]=n(r,t)}),l?(i=a(l(h)),i[u]=h,i):a(h)},d(s,function(t,n){if(a.fn[t])return;a.fn[t]=function(i){var s=e.type(i),u=t==="alpha"?this._hsla?"hsla":"rgba":r,a=this[u](),f=a[n.idx],l;return s==="undefined"?f:(s==="function"&&(i=i.call(this,f),s=e.type(i)),i==null&&n.empty?this:(s==="string"&&(l=o.exec(i),l&&(i=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[n.idx]=i,this[u](a)))}})}),a.hook=function(t){var n=t.split(" ");d(n,function(t,n){e.cssHooks[n]={set:function(t,i){var s,o,u="";if(i!=="transparent"&&(e.type(i)!=="string"||(s=r(i)))){i=a(s||i);if(!c.rgba&&i._rgba[3]!==1){o=n==="backgroundColor"?t.parentNode:t;while((u===""||u==="transparent")&&o&&o.style)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(f){}i=i.blend(u&&u!=="transparent"?u:"_default")}i=i.toRgbaString()}try{t.style[n]=i}catch(f){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=a(t.elem,n),t.end=a(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},a.hook(s),e.cssHooks.borderColor={expand:function(e){var t={};return d(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},p=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),define("lib-app/jqueryColor",function(){}),define("my/helpers/AnimationHelper",["lib-app/jqueryColor"],function(){"use strict";var e={},t=function(e){var t='.item[data-id="'+e+'"]',r=$(t+" .notification-pane"),i=$(t+" .notification-issue.notification-expanded");n(r,i)},n=function(e,t){e.addClass("highlighted"),t.addClass("highlighted"),r(e,t,1e3)},r=function(e,t,n){e.removeClass("highlighted",n),t.removeClass("highlighted",n)},i=function(e,t){e.addClass("changed-row"),s(e,t)},s=function(e,t){t?setTimeout(function(){e.removeClass("changed-row",600)},3500):setTimeout(function(){e.removeClass("changed-row",600)},1e3)},o=function(t,n){clearTimeout(e),$(t).css("opacity",0),setTimeout(function(){$(t).css("opacity",1),e=setTimeout(function(){t.animate({opacity:0},600)},n)},100)},u=function(e,t){e.toggleClass("faded",500,function(){e.toggleClass("shrunk",500,function(){e.empty(),e.removeClass("faded"),e.removeClass("shrunk"),t()})})},a=function(e,t,n){e.toggleClass("faded",250,function(){e.addClass("no-show"),e.removeClass("faded")}),t.toggleClass("faded",1e3,function(){t.addClass("no-show"),t.removeClass("faded"),n&&typeof n=="function"&&n()})},f=function(e,t){setTimeout(function(){e.removeClass("saved-successfully",500,function(){t&&typeof t=="function"&&t()})},1e3)},l=function(e,t){setTimeout(function(){e.removeClass("error",500),t.animate({opacity:0},500,function(){t.css("display","none"),t.css("opacity","1")})},1e3)};return{pulsateNotification:t,pulsateRow:i,fadeNotification:o,dissolveScanAllRow:u,animateHideModal:a,animateHideSuccessBorder:f,animateHideErrorBorder:l}}),define("my/content/ExpandedStory",[],function(){"use strict";var e={},t=function(){return e},n=function(t){r(!1),e=t},r=function(t){e.ignoreServiceOkItemNot=t};return{getExpandedStory:t,setExpandedStory:n,setIgnoreServiceItem:r}}),define("my/helpers/UIHelper",["dijit/registry","my/helpers/AnimationHelper","my/helpers/Formatter","my/content/Templater","my/content/ExpandedStory"],function(e,t,n,r,i){"use strict";var s=[],o="",u=function(e,t,n){var r='.item[data-id="'+t+'"]',i=$(r+' .expandable-layer[data-map-id="'+e+'"]'),s=a();i.hasClass("expanded")?n&&(l(e),i.removeClass("expanded")):(n&&s.length<=1&&h(t),f(e),i.addClass("expanded"))},a=function(){return s},f=function(e){var t=s.indexOf(e);t===-1&&e&&s.push(e)},l=function(e){var t=s.indexOf(e);t!==-1&&s.splice(t,1)},c=function(e){var t='.item[data-id="'+e+'"]',n=$(t+" .expandable-layer");n.removeClass("expanded")},h=function(e){s=[],c(e)},p=function(){return o},d=function(e){o=e},v=function(){o=""},m=function(e,t){var n='.item[data-id="'+e+'"]';t==="public"?($(n+" .social-share-button").removeClass("disabled"),$(n+" .tooltip-wrapper.social").addClass("no-show"),$(n+" .item-view-live").html(i18n.storyMap.viewLive),$("#not-public-container").addClass("no-show")):t==="organization"?($(n+" .social-share-button").not(".share-dialog-button").addClass("disabled"),$(n+" .tooltip-wrapper.social").not(".share-dialog").removeClass("no-show"),$(n+" .social-share-button.share-dialog-button").removeClass("disabled"),$(n+" .tooltip-wrapper.social.share-dialog").addClass("no-show"),$(n+" .item-view-live").html(i18n.storyMap.preview),$("#not-public-container").removeClass("no-show")):($(n+" .social-share-button").addClass("disabled"),$(n+" .tooltip-wrapper.social").removeClass("no-show"),$(n+" .item-view-live").html(i18n.storyMap.preview),$("#not-public-container").removeClass("no-show"))},g=function(e){e.orgId||($(".organization").css("display","none"),$(".item-shared-with-column").addClass("no-org"))},y=function(e,t,n){t===!0?e===!0&&$('.item[data-id="'+n+'"]').removeClass("has-issues"):$('.item[data-id="'+n+'"]').addClass("has-issues")},b=function(e,t,n){var r=$('.item[data-id="'+e+'"] .media-tab[data-media-type="'+t+'"]');n?r.removeClass("icon-stories-error").removeClass("tab-error"):r.addClass("icon-stories-error").addClass("tab-error")},w=function(e){var t='.item[data-id="'+e+'"]';$(t+" .media-title.map, "+t+" .media-row .media-item-status").off("click").on("click",function(){var t=$(this).data("id");u(t,e,!0)})},E=function(e,t){$('.item[data-id="'+e+'"] .media-tab').off("click").on("click",function(){var n=$(this).attr("data-tab-type");S(n,e,!0,t)})},S=function(e,t,n,r){var s='.item[data-id="'+t+'"]',o=i.getExpandedStory(),u=!1;$(s+" .item-table-container.active").removeClass("active"),$(s+" .media-tab.active").removeClass("active"),$(s+' .item-table-container[data-tab-type="'+e+'"]').addClass("active"),$(s+' .media-tab[data-tab-type="'+e+'"]').addClass("active"),n&&r&&(u=t===o.id,u&&_(r,e))},x=function(e){var t='.item[data-id="'+e+'"]';$(t+" .num-views").removeClass("block-element"),$(t+" .num-views-separator").css("display","inline-block"),$(t+" .item-metadata-container").removeClass("whole-line"),$(t).addClass("expanded")},T=function(e){var t='.item[data-id="'+e+'"]';$(t).removeClass("expanded"),$(t+" .num-views").addClass("block-element"),$(t+" .num-views-separator").css("display","none"),$(t+" .item-metadata-container").addClass("whole-line")},N=function(e){var t='.item[data-id="'+e+'"]',n=$(t).data("story-type");k(e),L(e),$(t+" .item-table-container.active").removeClass("active"),$(t+" .media-tab.active").removeClass("active"),$(t+" .media-tab.tab-error").removeClass("tab-error").removeClass("icon-stories-error"),n==="Map Tour"&&$(t+" .infographics-container .infographic:last-child .infographic-value").html(i18n.content.general.loading),C(e),h(e),v(),$(t+" .item-side-buttons .refresh").css("display","none"),$(t+" .item-side-buttons .refresh").removeClass("disabled"),ht(e),et(e),it(e),nt(e),Tt(e,!0),St(e),$(t+" .photo-bottom-overlay").css("display","none")},C=function(e){var t='.item[data-id="'+e+'"]';$(t+" .status-pane-container").empty()},k=function(e){$('.item[data-id="'+e+'"] .item-title').attr("contentEditable",!1),$('.item[data-id="'+e+'"] .item-title').off("focusout")},L=function(e){$('.item[data-id="'+e+'"] .item-photo').off("click")},A=function(e){var t='.item[data-id="'+e+'"]',n=$(t+" .media-tabs > :first-child"),r=$(t+" .item-table-container.active").attr("data-tab-type")||"",i=$(t+" .item-table-container.active")||null,s=$(t+' .media-tab[data-tab-type="'+r+'"]')||null;i.length>0&&s.length>0?$(t+' .media-tab[data-tab-type="'+r+'"]').addClass("active"):(n.addClass("active"),r=n.attr("data-tab-type"),$(t+" .item-table-container.active").removeClass("active"),$(t+' .item-table-container[data-tab-type="'+r+'"]').addClass("active"))},O=function(e){var t=[],n="",r=null;for(r in e.media)e.media.hasOwnProperty(r)&&(e.media[r].allClear||t.push(e.media[r].type));n=M(t),H(e.id),B(e.id,n),_(e,n)},M=function(e){var t="";return e.indexOf("maps")!==-1?t="maps":e.indexOf("images")!==-1?t="images":e.indexOf("videos")!==-1&&(t="videos"),t},_=function(e,t){var n='.item[data-id="'+e.id+'"]',r=n+" .notification-issue",i=null;i=$(r+'[data-media-type="'+t+'"]'),i.length===1?dt(i,e.id,e.issues,[]):D(e.id)},D=function(e){var t='.item[data-id="'+e+'"]',n="issue-row";$('.item[data-id="'+e+'"] .notification-issue.notification-expanded').removeClass("notification-expanded"),h(e),mt(t,n),v()},P=function(e){var t="images";e.media.images&&(H(e.id),B(e.id,t))},H=function(e){var t='.item[data-id="'+e+'"]';$(t+" .media-tab.active").removeClass("active"),$(t+" .item-table-container.active").removeClass("active")},B=function(e,t){var n='.item[data-id="'+e+'"]';$(n+' .media-tab[data-tab-type="'+t+'"]').addClass("active"),$(n+' .item-table-container[data-tab-type="'+t+'"]').addClass("active")},j=function(e){var t='.item[data-id="'+e+'"]';$(t+" .item-media-container").empty()},F=function(e,t){for(var n=0;n<e.length;n++)I(e[n],t)},I=function(e,n){var r=e.type==="layer"?"layer-row":"media-row",i=$('.item[data-id="'+e.storyObj.id+'"] '+"."+r+'[data-id="'+e.itemId+'"]');t.pulsateRow(i,n)},q=function(t){var n=e.byId("scanning-progress-bar"),i=i18n.progress.scanProgress.replace(/{{NUM_SCANNED}}/g,1).replace(/{{NUM_TOTAL}}/g,t),s=i18n.progress.checkingStories,o="scanning-progress-bar",u="scanProgressBar",a="scanning-stop";K(),r.templatizeScanProgress({progressBar:n,progressString:i,title:s,progressBarId:o,progressBarDojoId:u,stopId:a}),$("#item-list").empty(),$("#error-container").hide(),$("#find-more-container").hide(),$("#header-controls").hide()},R=function(t,n){var r=e.byId("scanning-progress-bar"),i=i18n.progress.scanProgress.replace(/{{NUM_SCANNED}}/g,t).replace(/{{NUM_TOTAL}}/g,n);r.set({value:t/n*100}),$(".progress-details").html(i)},U=function(e,t){t||J(e),r.templatizeScanDone(e)},z=function(e,t,n){$(".num-with-issues").html(n),r.templatizeScanStopped(e,t,n)},W=function(){r.templatizeScanError()},X=function(e){var n=$("#scan-all-progress");t.dissolveScanAllRow(n,function(){Ot(e),$("#header-controls").show()}),$("#find-more-container").show()},V=function(e){var t="",n=i18n.progress;e===0?t=i18n.header.noIssues:app.cfg.isEnglish?e===1?t=window.engStrings.storiesHaveIssuesSingle.replace(/{{NUM_STORIES}}/g,e):t=window.engStrings.storiesHaveIssuesPlural.replace(/{{NUM_STORIES}}/g,e):t=n.storiesWithIssues.replace(/{{NUM_STORIES}}/g,e),$("#num-issues").html(t)},J=function(e){V(e),$("#num-issues").css("display","block")},K=function(){$("#num-issues").css("display","none")},Q=function(e){var t="",n="",r="modified";$("#sort-dropdown .dropdown-option.selected").removeClass("selected");if(!e){$('#sort-dropdown .dropdown-option[data-criteria="'+r+'"]').addClass("selected"),$("#sort-text").html(i18n.header.sort);return}$('#sort-dropdown .dropdown-option[data-criteria="'+e+'"]').addClass("selected"),t=$('#sort-dropdown .dropdown-option[data-criteria="'+e+'"] .dropdown-option-text').html(),n=i18n.header.sortColon+" "+t,$("#sort-text").html(n),Lt()},G=function(e){var t=null;if(!e){$("#filter-dropdown .dropdown-option").removeClass("selected");return}t=$('#filter-dropdown .dropdown-option[data-category="'+e.category+'"][data-value="'+e.value+'"]'),t.hasClass("selected")?t.removeClass("selected"):(t.addClass("selected"),Lt())},Y=function(e,t){$('.item[data-id="'+e+'"] .infographics-container .infographic:last-child .infographic-value').html(t)},Z=function(e){$('.item[data-id="'+e+'"] .content-tab-error').show()},et=function(e){$('.item[data-id="'+e+'"] .content-tab-error').hide()},tt=function(e){$('.item[data-id="'+e+'"] .maps-tab-error').removeClass("no-show")},nt=function(e){$('.item[data-id="'+e+'"] .maps-tab-error').addClass("no-show")},rt=function(e){$('.item[data-id="'+e+'"] .image-tab-error').removeClass("no-show")},it=function(e){$('.item[data-id="'+e+'"] .image-tab-error').addClass("no-show")},st=function(e){var n=$('.item[data-id="'+e+'"] .notification-container'),r=2e3;n.css("opacity",1),t.fadeNotification(n,r)},ot=function(e,n){var r=$('.item[data-id="'+e+'"] .notification-container'),i=1e3;n&&(i=3500),t.fadeNotification(r,i)},ut=function(e){var t='.item[data-id="'+e+'"]',n=$(t+" .notification-pane");n.css("display","block")},at=function(e){var t='.item[data-id="'+e+'"]',n=$(t+" .notification-pane");n.css("display","none")},ft=function(e){var t=$('.item[data-id="'+e+'"] .item-side-buttons .refresh');A(e),t.css("display","inline-block"),t.removeClass("disabled")},lt=function(e){$('.item[data-id="'+e+'"] .item-side-buttons .refresh').addClass("disabled")},ct=function(e){$('.item[data-id="'+e+'"] .item-side-buttons .refresh').addClass("spin")},ht=function(e){$('.item[data-id="'+e+'"] .item-side-buttons .refresh').removeClass("spin")},pt=function(e,t,n){var r=p(),i=e.id,s=$('.item[data-id="'+i+'"] .notification-issue[data-issue-type="'+r+'"]');ft(e.id," .item-side-buttons .refresh");if(r!=="")if(e.issues[r].items.length>0&&s.length>0)dt(s,i,e.issues,t,n);else{v(),h(i);for(var o=0;o<t.length;o++)u(t[o],i,!1)}},dt=function(e,t,n,r,i){var s=e.attr("data-media-type"),o=e.attr("data-issue-type"),u=n[o].items;$('.item[data-id="'+t+'"] .notification-issue.notification-expanded').removeClass("notification-expanded"),e.addClass("notification-expanded"),S(s,t,!1,null),vt(t,u,r),d(o)},vt=function(e,t,n){var r='.item[data-id="'+e+'"]',i="issue-row",s={};mt(r,i),h(e);for(var o=0;o<t.length;o++)s=t[o],s.itemType==="layer"?(u(s.mapId,e,!1),$(r+' .layer-row[data-id="'+s.id+'"]').addClass(i)):$(r+' .media-row[data-id="'+s.id+'"]').addClass(i);for(var a=0;a<n.length;a++)u(n[a],e,!1)},mt=function(e,t){$(e+" .layer-row."+t).removeClass(t),$(e+" .media-row."+t).removeClass(t)},gt=function(e){var t="";t=n.formatNumStories(e),$("#num-stories").html(t),$("#num-stories").css("display","block")},yt=function(){$("#num-stories").css("display","none")},bt=function(e){var t=$('.item[data-id="'+e+'"] .submit-button');t.addClass("success-button"),t.addClass("pressed"),t.html(i18n.storyMap.submitToGallery.submitted)},wt=function(e){var t=$('.item[data-id="'+e+'"] .submit-button');t.addClass("error-button"),t.addClass("pressed"),t.html(i18n.storyMap.submitToGallery.errorSubmitting)},Et=function(e){var t='.item[data-id="'+e+'"]';$(t+" .fadeable-button, "+t+" .server-button").addClass("temp-disabled")},St=function(e){var t='.item[data-id="'+e+'"]';$(t+" .fadeable-button, "+t+" .server-button:not(.disabled-public)").removeClass("temp-disabled")},xt=function(e){var t='.item[data-id="'+e+'"]';$(t+" .story-sharing:not(.disabled-public)").removeClass("locked"),$(t+" .sharing-button-container.story.public:not(.disabled-public) .tooltip-content, "+t+" .sharing-button-container.story.organization").removeClass("locked"),$(t+" .sharing-button-container.story.public:not(.disabled-public) .tooltip-content").html(i18n.sharingLevel.public),$(t+" .sharing-button-container.story.organization .tooltip-content").html(i18n.sharingLevel.organization)},Tt=function(e,t){var n='.item[data-id="'+e+'"]';$(n+" .story-sharing:not(.disabled-public)").removeClass("locked"),t?$(n+" .story-sharing").addClass("locked"):($(n+" .story-sharing.public:not(.disabled-public), "+n+" .story-sharing.organization").addClass("locked"),$(n+" .sharing-button-container.story.public:not(.disabled-public) .tooltip-content, "+n+" .sharing-button-container.story.organization .tooltip-content").html(i18n.storyMap.notAvailableWhenBroken))},Nt=function(e){var t=$('.item[data-id="'+e+'"] .media-tab.left');return t.length===0?!1:!0},Ct=function(e,t){var n='.item[data-id="'+e+'"]';$(n+" .map-sharing:not(.disabled-public)").removeClass("temp-disabled"),t==="public"?($(n+" .map-sharing.private, "+n+" .map-sharing.organization").addClass("temp-disabled"),$(n+" .sharing-icons:not(.locked) .sharing-button-container.map.private:not(.incompatible-access-level.active) .tooltip-content").html(i18n.sharingLevel.mapPrivate),$(n+" .sharing-icons:not(.locked) .sharing-button-container.map.organization:not(.incompatible-access-level.active) .tooltip-content").html(i18n.sharingLevel.mapOrg),$(n+" .sharing-icons:not(.locked) .sharing-button-container.layer.private:not(.incompatible-access-level.active) .tooltip-content").html(i18n.sharingLevel.layerPrivate),$(n+" .sharing-icons:not(.locked) .sharing-button-container.layer.organization:not(.incompatible-access-level.active) .tooltip-content").html(i18n.sharingLevel.layerOrg)):t==="organization"&&($(n+" .map-sharing.private").addClass("temp-disabled"),$(n+" .sharing-icons:not(.locked) .sharing-button-container.map.private:not(.incompatible-access-level.active) .tooltip-content").html(i18n.sharingLevel.mapPrivate),$(n+" .sharing-icons:not(.locked) .sharing-button-container.layer.private:not(.incompatible-access-level.active) .tooltip-content").html(i18n.sharingLevel.layerPrivate))},kt=function(e,t){$('.item[data-id="'+e+'"] .item-photo').attr("src",t)},Lt=function(){$("#clear").animate({opacity:1},500)},At=function(){$("#clear").css("opacity",0),$("#search-results").html("")},Ot=function(e){var t="";app.cfg.isEnglish?t=e===1?window.engStrings.numResultsSingle.replace(/{{NUM_RESULTS}}/g,e):window.engStrings.numResultsPlural.replace(/{{NUM_RESULTS}}/g,e):t=i18n.header.numResults.replace(/{{NUM_RESULTS}}/g,e),$("#search-results").html(t)};return{toggleLayers:u,getExpandedMaps:a,emptyExpandedMaps:h,showBySharingLevel:m,handleNoOrg:g,updateStoryStatusIcon:y,updateTabStatusIcon:b,addToggleLayerEvents:w,addMediaTabsEvents:E,expandStory:x,collapseStory:T,resetContentDefaults:N,emptyStatusPane:C,highlightFirstOrActiveMedia:A,highlightFirstErrorTab:O,highlightImageTab:P,highlightMediaTab:B,unHighlightMediaTab:H,emptyMediaContainers:j,updateSharedRows:F,updateSharedRow:I,updateNumScanned:R,onScanStart:q,onScanComplete:U,onScanStopped:z,onScanError:W,exitScanMode:X,updateSortedBy:Q,updateFilteredBy:G,updateBasemapInfographic:Y,showContentErrorMessage:Z,hideContentErrorMessage:et,showImageError:rt,hideImageError:it,showMapsError:tt,hideMapsError:nt,showErrorNotification:st,showSuccessNotification:ot,showErrorStatusPane:ut,hideErrorStatusPane:at,disableRefreshIcon:lt,spinRefreshIcon:ct,haltRefreshIcon:ht,updateNotificationPane:pt,selectNotification:dt,updateNumStories:gt,hideNumStories:yt,showSuccessSubmitButton:bt,showErrorSubmitButton:wt,disableFadeableButtons:Et,reEnableButtons:St,enableStoryShareButtons:xt,disableStoryShareButtons:Tt,checkAlreadyHasContent:Nt,restrictMapLayerSharing:Ct,updateThumbnail:kt,showClearButton:Lt,hideClearButton:At,updateSearchResultCount:Ot,hideNumStoriesWithIssues:K,updateNumStoriesWithIssues:V}}),define("my/content/dialogs/SeeExample",[],function(){"use strict";var e=null,t=function(t){e=t;var r=e.getElementById("story-frame"),i=e.getElementById("story-frame-container"),s=i.getAttribute("data-width"),o=i.getAttribute("data-height"),u=e.getElementById("main-line");i.style.width=s,r.style.height=o,u.style.height=o,n(s)},n=function(e){var t=new RegExp("[^\\D][0-9]+?%$"),n=t.test(e);n?r(e):i(e)},r=function(e){var t=e.substring(0,e.length-1),n=parseInt(t,10);isNaN(n)===!1&&n>80&&s()},i=function(t){var n=new RegExp("[^\\D][0-9]+px$"),r=n.test(t),i="",o=0,u=0,a=0;r&&(i=t.substring(0,t.length-2),o=parseInt(i,10),isNaN(o)===!1&&(u=e.getElementById("main").clientWidth,a=o/u*100,a>75&&s()))},s=function(){var t=e.getElementById("story-frame-container"),n=e.getElementById("main-line");n.style.textAlign="center",t.style.float="none",e.getElementById("variable-column").style.display="none",t.style.margin="0",t.style.padding="0 15px"};return{init:t}}),function(e,t){"use strict";var n=e,r=n.document,i=n.navigator,s=n.setTimeout,o=n.encodeURIComponent,u=n.ActiveXObject,a=n.Error,f=n.Number.parseInt||n.parseInt,l=n.Number.parseFloat||n.parseFloat,c=n.Number.isNaN||n.isNaN,h=n.Math.round,p=n.Date.now,d=n.Object.keys,v=n.Object.defineProperty,m=n.Object.prototype.hasOwnProperty,g=n.Array.prototype.slice,y=function(e){return g.call(e,0)},b=function(){var e,n,r,i,s,o,u=y(arguments),a=u[0]||{};for(e=1,n=u.length;e<n;e++)if((r=u[e])!=null)for(i in r)m.call(r,i)&&(s=a[i],o=r[i],a!==o&&o!==t&&(a[i]=o));return a},w=function(e){var t,n,r,i;if(typeof e!="object"||e==null)t=e;else if(typeof e.length=="number"){t=[];for(n=0,r=e.length;n<r;n++)m.call(e,n)&&(t[n]=w(e[n]))}else{t={};for(i in e)m.call(e,i)&&(t[i]=w(e[i]))}return t},E=function(e,t){var n={};for(var r=0,i=t.length;r<i;r++)t[r]in e&&(n[t[r]]=e[t[r]]);return n},S=function(e,t){var n={};for(var r in e)t.indexOf(r)===-1&&(n[r]=e[r]);return n},x=function(e){if(e)for(var t in e)m.call(e,t)&&delete e[t];return e},T=function(e,t){if(e&&e.nodeType===1&&e.ownerDocument&&t&&(t.nodeType===1&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||t.nodeType===9&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},N=function(e){var t;return typeof e=="string"&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},C=function(e){var t,n;return typeof e=="string"&&e&&(n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]&&(t=n[1]))),t},k=function(){var e,t;try{throw new a}catch(n){t=n}return t&&(e=t.sourceURL||t.fileName||C(t.stack)),e},L=function(){var e,n,i;if(r.currentScript&&(e=r.currentScript.src))return e;n=r.getElementsByTagName("script");if(n.length===1)return n[0].src||t;if("readyState"in n[0])for(i=n.length;i--;)if(n[i].readyState==="interactive"&&(e=n[i].src))return e;return r.readyState==="loading"&&(e=n[n.length-1].src)?e:(e=k())?e:t},A=function(){var e,n,i,s=r.getElementsByTagName("script");for(e=s.length;e--;){if(!(i=s[e].src)){n=null;break}i=N(i);if(n==null)n=i;else if(n!==i){n=null;break}}return n||t},O=function(){var e=N(L())||A()||"";return e+"ZeroClipboard.swf"},M={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,unavailable:null,deactivated:null,overdue:null,ready:null},_="11.0.0",D={},P,H={},B=null,j={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate","flash-overdue":"Flash communication was established but NOT within the acceptable time limit"}},F={swfPath:O(),trustedDomains:e.location.host?[e.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},I=function(e){if(typeof e=="object"&&e!==null)for(var t in e)if(m.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))F[t]=e[t];else if(M.bridge==null)if(t==="containerId"||t==="swfObjectId"){if(!et(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");F[t]=e[t]}else F[t]=e[t];if(typeof e=="string"&&e){if(m.call(F,e))return F[e];return}return w(F)},q=function(){return{browser:E(i,["userAgent","platform","appName"]),flash:S(M,["bridge"]),zeroclipboard:{version:At.version,config:At.config()}}},R=function(){return!!(M.disabled||M.outdated||M.unavailable||M.deactivated)},U=function(e,t){var n,r,i,s={};if(typeof e=="string"&&e)i=e.toLowerCase().split(/\s+/);else if(typeof e=="object"&&e&&typeof t=="undefined")for(n in e)m.call(e,n)&&typeof n=="string"&&n&&typeof e[n]=="function"&&At.on(n,e[n]);if(i&&i.length){for(n=0,r=i.length;n<r;n++)e=i[n].replace(/^on/,""),s[e]=!0,D[e]||(D[e]=[]),D[e].push(t);s.ready&&M.ready&&At.emit({type:"ready"});if(s.error){var o=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,r=o.length;n<r;n++)if(M[o[n]]===!0){At.emit({type:"error",name:"flash-"+o[n]});break}}}return At},z=function(e,t){var n,r,i,s,o;if(arguments.length===0)s=d(D);else if(typeof e=="string"&&e)s=e.split(/\s+/);else if(typeof e=="object"&&e&&typeof t=="undefined")for(n in e)m.call(e,n)&&typeof n=="string"&&n&&typeof e[n]=="function"&&At.off(n,e[n]);if(s&&s.length)for(n=0,r=s.length;n<r;n++){e=s[n].toLowerCase().replace(/^on/,""),o=D[e];if(o&&o.length)if(t){i=o.indexOf(t);while(i!==-1)o.splice(i,1),i=o.indexOf(t,i)}else o.length=0}return At},W=function(e){var t;return typeof e=="string"&&e?t=w(D[e])||null:t=w(D),t},X=function(e){var t,n,r;e=tt(e);if(!e)return;if(ut(e))return;return e.type==="ready"&&M.overdue===!0?At.emit({type:"error",name:"flash-overdue"}):(t=b({},e),ot.call(this,t),e.type==="copy"&&(r=pt(H),n=r.data,B=r.formatMap),n)},V=function(){typeof M.ready!="boolean"&&(M.ready=!1);if(!At.isFlashUnusable()&&M.bridge===null){var e=F.flashLoadTimeout;typeof e=="number"&&e>=0&&s(function(){typeof M.deactivated!="boolean"&&(M.deactivated=!0),M.deactivated===!0&&At.emit({type:"error",name:"flash-deactivated"})},e),M.overdue=!1,ct()}},$=function(){At.clearData(),At.blur(),At.emit("destroy"),ht(),At.off()},J=function(e,t){var n;if(typeof e=="object"&&e&&typeof t=="undefined")n=e,At.clearData();else{if(typeof e!="string"||!e)return;n={},n[e]=t}for(var r in n)typeof r=="string"&&r&&m.call(n,r)&&typeof n[r]=="string"&&n[r]&&(H[r]=n[r])},K=function(e){typeof e=="undefined"?(x(H),B=null):typeof e=="string"&&m.call(H,e)&&delete H[e]},Q=function(e){if(typeof e=="undefined")return w(H);if(typeof e=="string"&&m.call(H,e))return H[e]},G=function(e){if(!e||e.nodeType!==1)return;P&&(Et(P,F.activeClass),P!==e&&Et(P,F.hoverClass)),P=e,wt(e,F.hoverClass);var t=e.getAttribute("title")||F.title;if(typeof t=="string"&&t){var n=lt(M.bridge);n&&n.setAttribute("title",t)}var r=F.forceHandCursor===!0||St(e,"cursor")==="pointer";Ct(r),Nt()},Y=function(){var e=lt(M.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.top="1px"),P&&(Et(P,F.hoverClass),Et(P,F.activeClass),P=null)},Z=function(){return P||null},et=function(e){return typeof e=="string"&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},tt=function(e){var t;typeof e=="string"&&e?(t=e,e={}):typeof e=="object"&&e&&typeof e.type=="string"&&e.type&&(t=e.type);if(!t)return;b(e,{type:t.toLowerCase(),target:e.target||P||null,relatedTarget:e.relatedTarget||null,currentTarget:M&&M.bridge||null,timeStamp:e.timeStamp||p()||null});var n=j[e.type];return e.type==="error"&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),e.type==="ready"&&b(e,{target:null,version:M.version}),e.type==="error"&&(/^flash-(disabled|outdated|unavailable|deactivated|overdue)$/.test(e.name)&&b(e,{target:null,minimumVersion:_}),/^flash-(outdated|unavailable|deactivated|overdue)$/.test(e.name)&&b(e,{version:M.version})),e.type==="copy"&&(e.clipboardData={setData:At.setData,clearData:At.clearData}),e.type==="aftercopy"&&(e=dt(e,B)),e.target&&!e.relatedTarget&&(e.relatedTarget=nt(e.target)),e=rt(e),e},nt=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?r.getElementById(t):null},rt=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var i=e.target,s=e.type==="_mouseover"&&e.relatedTarget?e.relatedTarget:t,o=e.type==="_mouseout"&&e.relatedTarget?e.relatedTarget:t,u=Tt(i),a=n.screenLeft||n.screenX||0,f=n.screenTop||n.screenY||0,l=r.body.scrollLeft+r.documentElement.scrollLeft,c=r.body.scrollTop+r.documentElement.scrollTop,h=u.left+(typeof e._stageX=="number"?e._stageX:0),p=u.top+(typeof e._stageY=="number"?e._stageY:0),d=h-l,v=p-c,m=a+d,g=f+v,y=typeof e.movementX=="number"?e.movementX:0,w=typeof e.movementY=="number"?e.movementY:0;delete e._stageX,delete e._stageY,b(e,{srcElement:i,fromElement:s,toElement:o,screenX:m,screenY:g,pageX:h,pageY:p,clientX:d,clientY:v,x:d,y:v,movementX:y,movementY:w,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},it=function(e){var t=e&&typeof e.type=="string"&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},st=function(e,t,n,r){r?s(function(){e.apply(t,n)},0):e.apply(t,n)},ot=function(e){if(typeof e!="object"||!e||!e.type)return;var t=it(e),r=D["*"]||[],i=D[e.type]||[],s=r.concat(i);if(s&&s.length){var o,u,a,f,l,c=this;for(o=0,u=s.length;o<u;o++)a=s[o],f=c,typeof a=="string"&&typeof n[a]=="function"&&(a=n[a]),typeof a=="object"&&a&&typeof a.handleEvent=="function"&&(f=a,a=a.handleEvent),typeof a=="function"&&(l=b({},e),st(a,f,[l],t))}return this},ut=function(e){var t=e.target||P||null,n=e._source==="swf";delete e._source;var r=["flash-disabled","flash-outdated","flash-unavailable","flash-deactivated","flash-overdue"];switch(e.type){case"error":r.indexOf(e.name)!==-1&&b(M,{disabled:e.name==="flash-disabled",outdated:e.name==="flash-outdated",unavailable:e.name==="flash-unavailable",deactivated:e.name==="flash-deactivated",overdue:e.name==="flash-overdue",ready:!1});break;case"ready":var i=M.deactivated===!0;b(M,{disabled:!1,outdated:!1,unavailable:!1,deactivated:!1,overdue:i,ready:!i});break;case"copy":var s,o,u=e.relatedTarget;!H["text/html"]&&!H["text/plain"]&&u&&(o=u.value||u.outerHTML||u.innerHTML)&&(s=u.value||u.textContent||u.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s),o!==s&&e.clipboardData.setData("text/html",o)):!H["text/plain"]&&e.target&&(s=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",s));break;case"aftercopy":At.clearData(),t&&t!==bt()&&t.focus&&t.focus();break;case"_mouseover":At.focus(t),F.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!T(e.relatedTarget,t)&&at(b({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),at(b({},e,{type:"mouseover"})));break;case"_mouseout":At.blur(),F.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!T(e.relatedTarget,t)&&at(b({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),at(b({},e,{type:"mouseout"})));break;case"_mousedown":wt(t,F.activeClass),F.bubbleEvents===!0&&n&&at(b({},e,{type:e.type.slice(1)}));break;case"_mouseup":Et(t,F.activeClass),F.bubbleEvents===!0&&n&&at(b({},e,{type:e.type.slice(1)}));break;case"_click":case"_mousemove":F.bubbleEvents===!0&&n&&at(b({},e,{type:e.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type))return!0},at=function(e){if(!e||typeof e.type!="string"||!e)return;var t,i=e.target||null,s=i&&i.ownerDocument||r,o={view:s.defaultView||n,canBubble:!0,cancelable:!0,detail:e.type==="click"?1:0,button:typeof e.which=="number"?e.which-1:typeof e.button=="number"?e.button:s.createEvent?0:1},u=b(o,e);if(!i)return;s.createEvent&&i.dispatchEvent&&(u=[u.type,u.canBubble,u.cancelable,u.view,u.detail,u.screenX,u.screenY,u.clientX,u.clientY,u.ctrlKey,u.altKey,u.shiftKey,u.metaKey,u.button,u.relatedTarget],t=s.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,u),t._source="js",i.dispatchEvent(t)))},ft=function(){var e=r.createElement("div");return e.id=F.containerId,e.className=F.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+kt(F.zIndex),e},lt=function(e){var t=e&&e.parentNode;while(t&&t.nodeName==="OBJECT"&&t.parentNode)t=t.parentNode;return t||null},ct=function(){var e,t=M.bridge,i=lt(t);if(!t){var s=yt(n.location.host,F),o=s==="never"?"none":"all",u=mt(F),a=F.swfPath+vt(F.swfPath,F);i=ft();var f=r.createElement("div");i.appendChild(f),r.body.appendChild(i);var l=r.createElement("div"),c=M.pluginType==="activex";l.innerHTML='<object id="'+F.swfObjectId+'" name="'+F.swfObjectId+'" '+'width="100%" height="100%" '+(c?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+a+'"')+">"+(c?'<param name="movie" value="'+a+'"/>':"")+'<param name="allowScriptAccess" value="'+s+'"/>'+'<param name="allowNetworking" value="'+o+'"/>'+'<param name="menu" value="false"/>'+'<param name="wmode" value="transparent"/>'+'<param name="flashvars" value="'+u+'"/>'+"</object>",t=l.firstChild,l=null,t.ZeroClipboard=At,i.replaceChild(t,f)}return t||(t=r[F.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&i&&(t=i.firstChild)),M.bridge=t||null,t},ht=function(){var e=M.bridge;if(e){var t=lt(e);t&&(M.pluginType==="activex"&&"readyState"in e?(e.style.display="none",function n(){if(e.readyState===4){for(var r in e)typeof e[r]=="function"&&(e[r]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else s(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),M.ready=null,M.bridge=null,M.deactivated=null}},pt=function(e){var t={},n={};if(typeof e!="object"||!e)return;for(var r in e)if(r&&m.call(e,r)&&typeof e[r]=="string"&&e[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[r],n.rtf=r;break;default:}return{data:t,formatMap:n}},dt=function(e,t){if(typeof e!="object"||!e||typeof t!="object"||!t)return e;var n={};for(var r in e)if(m.call(e,r)){if(r!=="success"&&r!=="data"){n[r]=e[r];continue}n[r]={};var i=e[r];for(var s in i)s&&m.call(i,s)&&m.call(t,s)&&(n[r][t[s]]=i[s])}return n},vt=function(e,t){var n=t==null||t&&t.cacheBust===!0;return n?(e.indexOf("?")===-1?"?":"&")+"noCache="+p():""},mt=function(e){var t,r,i,s,u="",a=[];e.trustedDomains&&(typeof e.trustedDomains=="string"?s=[e.trustedDomains]:typeof e.trustedDomains=="object"&&"length"in e.trustedDomains&&(s=e.trustedDomains));if(s&&s.length)for(t=0,r=s.length;t<r;t++)if(m.call(s,t)&&s[t]&&typeof s[t]=="string"){i=gt(s[t]);if(!i)continue;if(i==="*"){a.length=0,a.push(i);break}a.push.apply(a,[i,"//"+i,n.location.protocol+"//"+i])}return a.length&&(u+="trustedOrigins="+o(a.join(","))),e.forceEnhancedClipboard===!0&&(u+=(u?"&":"")+"forceEnhancedClipboard=true"),typeof e.swfObjectId=="string"&&e.swfObjectId&&(u+=(u?"&":"")+"swfObjectId="+o(e.swfObjectId)),u},gt=function(e){if(e==null||e==="")return null;e=e.replace(/^\s+|\s+$/g,"");if(e==="")return null;var t=e.indexOf("//");e=t===-1?e:e.slice(t+2);var n=e.indexOf("/");return e=n===-1?e:t===-1||n===0?null:e.slice(0,n),e&&e.slice(-4).toLowerCase()===".swf"?null:e||null},yt=function(){var e=function(e){var t,n,r,i=[];typeof e=="string"&&(e=[e]);if(typeof e!="object"||!e||typeof e.length!="number")return i;for(t=0,n=e.length;t<n;t++)if(m.call(e,t)&&(r=gt(e[t]))){if(r==="*"){i.length=0,i.push("*");break}i.indexOf(r)===-1&&i.push(r)}return i};return function(t,n){var r=gt(n.swfPath);r===null&&(r=t);var i=e(n.trustedDomains),s=i.length;if(s>0){if(s===1&&i[0]==="*")return"always";if(i.indexOf(t)!==-1)return s===1&&t===r?"sameDomain":"always"}return"never"}}(),bt=function(){try{return r.activeElement}catch(e){return null}},wt=function(e,t){if(!e||e.nodeType!==1)return e;if(e.classList)return e.classList.contains(t)||e.classList.add(t),e;if(t&&typeof t=="string"){var n=(t||"").split(/\s+/);if(e.nodeType===1)if(!e.className)e.className=t;else{var r=" "+e.className+" ",i=e.className;for(var s=0,o=n.length;s<o;s++)r.indexOf(" "+n[s]+" ")<0&&(i+=" "+n[s]);e.className=i.replace(/^\s+|\s+$/g,"")}}return e},Et=function(e,t){if(!e||e.nodeType!==1)return e;if(e.classList)return e.classList.contains(t)&&e.classList.remove(t),e;if(typeof t=="string"&&t){var n=t.split(/\s+/);if(e.nodeType===1&&e.className){var r=(" "+e.className+" ").replace(/[\n\t]/g," ");for(var i=0,s=n.length;i<s;i++)r=r.replace(" "+n[i]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}}return e},St=function(e,t){var r=n.getComputedStyle(e,null).getPropertyValue(t);return t!=="cursor"||!!r&&r!=="auto"||e.nodeName!=="A"?r:"pointer"},xt=function(){var e,t,n,i=1;return typeof r.body.getBoundingClientRect=="function"&&(e=r.body.getBoundingClientRect(),t=e.right-e.left,n=r.body.offsetWidth,i=h(t/n*100)/100),i},Tt=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var i=e.getBoundingClientRect(),s,o,u;"pageXOffset"in n&&"pageYOffset"in n?(s=n.pageXOffset,o=n.pageYOffset):(u=xt(),s=h(r.documentElement.scrollLeft/u),o=h(r.documentElement.scrollTop/u));var a=r.documentElement.clientLeft||0,f=r.documentElement.clientTop||0;t.left=i.left+s-a,t.top=i.top+o-f,t.width="width"in i?i.width:i.right-i.left,t.height="height"in i?i.height:i.bottom-i.top}return t},Nt=function(){var e;if(P&&(e=lt(M.bridge))){var t=Tt(P);b(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+kt(F.zIndex)})}},Ct=function(e){M.ready===!0&&(M.bridge&&typeof M.bridge.setHandCursor=="function"?M.bridge.setHandCursor(e):M.ready=!1)},kt=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return typeof e=="number"&&!c(e)?t=e:typeof e=="string"&&(t=kt(f(e,10))),typeof t=="number"?t:"auto"},Lt=function(e){function f(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function c(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||e.slice(-13)==="chrome.plugin")}function h(e){e&&(s=!0,e.version&&(a=f(e.version)),!a&&e.description&&(a=f(e.description)),e.filename&&(u=c(e.filename)))}var t,n,r,s=!1,o=!1,u=!1,a="";if(i.plugins&&i.plugins.length)t=i.plugins["Shockwave Flash"],h(t),i.plugins["Shockwave Flash 2.0"]&&(s=!0,a="2.0.0.11");else if(i.mimeTypes&&i.mimeTypes.length)r=i.mimeTypes["application/x-shockwave-flash"],t=r&&r.enabledPlugin,h(t);else if(typeof e!="undefined"){o=!0;try{n=new e("ShockwaveFlash.ShockwaveFlash.7"),s=!0,a=f(n.GetVariable("$version"))}catch(p){try{n=new e("ShockwaveFlash.ShockwaveFlash.6"),s=!0,a="6.0.21"}catch(d){try{n=new e("ShockwaveFlash.ShockwaveFlash"),s=!0,a=f(n.GetVariable("$version"))}catch(v){o=!1}}}}M.disabled=s!==!0,M.outdated=a&&l(a)<l(_),M.version=a||"0.0.0",M.pluginType=u?"pepper":o?"activex":s?"netscape":"unknown"};Lt(u);var At=function(){if(!(this instanceof At))return new At;typeof At._createClient=="function"&&At._createClient.apply(this,y(arguments))};try{v(At,"version",{value:"2.1.3",writable:!1,configurable:!0,enumerable:!0})}catch(Ot){}At.config=function(){return I.apply(this,y(arguments))},At.state=function(){return q.apply(this,y(arguments))},At.isFlashUnusable=function(){return R.apply(this,y(arguments))},At.on=function(){return U.apply(this,y(arguments))},At.off=function(){return z.apply(this,y(arguments))},At.handlers=function(){return W.apply(this,y(arguments))},At.emit=function(){return X.apply(this,y(arguments))},At.create=function(){return V.apply(this,y(arguments))},At.destroy=function(){return $.apply(this,y(arguments))},At.setData=function(){return J.apply(this,y(arguments))},At.clearData=function(){return K.apply(this,y(arguments))},At.getData=function(){return Q.apply(this,y(arguments))},At.focus=At.activate=function(){return G.apply(this,y(arguments))},At.blur=At.deactivate=function(){return Y.apply(this,y(arguments))},At.activeElement=function(){return Z.apply(this,y(arguments))};var Mt=0,_t={},Dt=0,Pt={},Ht={};b(F,{autoActivate:!0});var Bt=function(e){var t=this;t.id=""+Mt++,_t[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),At.on("*",function(e){return t.emit(e)}),At.on("destroy",function(){t.destroy()}),At.create()},jt=function(e,t){var n,r,i,s={},o=_t[this.id]&&_t[this.id].handlers;if(typeof e=="string"&&e)i=e.toLowerCase().split(/\s+/);else if(typeof e=="object"&&e&&typeof t=="undefined")for(n in e)m.call(e,n)&&typeof n=="string"&&n&&typeof e[n]=="function"&&this.on(n,e[n]);if(i&&i.length){for(n=0,r=i.length;n<r;n++)e=i[n].replace(/^on/,""),s[e]=!0,o[e]||(o[e]=[]),o[e].push(t);s.ready&&M.ready&&this.emit({type:"ready",client:this});if(s.error){var u=["disabled","outdated","unavailable","deactivated","overdue"];for(n=0,r=u.length;n<r;n++)if(M[u[n]]){this.emit({type:"error",name:"flash-"+u[n],client:this});break}}}return this},Ft=function(e,t){var n,r,i,s,o,u=_t[this.id]&&_t[this.id].handlers;if(arguments.length===0)s=d(u);else if(typeof e=="string"&&e)s=e.split(/\s+/);else if(typeof e=="object"&&e&&typeof t=="undefined")for(n in e)m.call(e,n)&&typeof n=="string"&&n&&typeof e[n]=="function"&&this.off(n,e[n]);if(s&&s.length)for(n=0,r=s.length;n<r;n++){e=s[n].toLowerCase().replace(/^on/,""),o=u[e];if(o&&o.length)if(t){i=o.indexOf(t);while(i!==-1)o.splice(i,1),i=o.indexOf(t,i)}else o.length=0}return this},It=function(e){var t=null,n=_t[this.id]&&_t[this.id].handlers;return n&&(typeof e=="string"&&e?t=n[e]?n[e].slice(0):[]:t=w(n)),t},qt=function(e){if(Xt.call(this,e)){typeof e=="object"&&e&&typeof e.type=="string"&&e.type&&(e=b({},e));var t=b({},tt(e),{client:this});Vt.call(this,t)}return this},Rt=function(e){e=$t(e);for(var t=0;t<e.length;t++)if(m.call(e,t)&&e[t]&&e[t].nodeType===1){e[t].zcClippingId?Pt[e[t].zcClippingId].indexOf(this.id)===-1&&Pt[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+Dt++,Pt[e[t].zcClippingId]=[this.id],F.autoActivate===!0&&Jt(e[t]));var n=_t[this.id]&&_t[this.id].elements;n.indexOf(e[t])===-1&&n.push(e[t])}return this},Ut=function(e){var t=_t[this.id];if(!t)return this;var n=t.elements,r;typeof e=="undefined"?e=n.slice(0):e=$t(e);for(var i=e.length;i--;)if(m.call(e,i)&&e[i]&&e[i].nodeType===1){r=0;while((r=n.indexOf(e[i],r))!==-1)n.splice(r,1);var s=Pt[e[i].zcClippingId];if(s){r=0;while((r=s.indexOf(this.id,r))!==-1)s.splice(r,1);s.length===0&&(F.autoActivate===!0&&Kt(e[i]),delete e[i].zcClippingId)}}return this},zt=function(){var e=_t[this.id];return e&&e.elements?e.elements.slice(0):[]},Wt=function(){this.unclip(),this.off(),delete _t[this.id]},Xt=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=_t[this.id]&&_t[this.id].elements,n=!!t&&t.length>0,r=!e.target||n&&t.indexOf(e.target)!==-1,i=e.relatedTarget&&n&&t.indexOf(e.relatedTarget)!==-1,s=e.client&&e.client===this;return r||i||s?!0:!1},Vt=function(e){if(typeof e!="object"||!e||!e.type)return;var t=it(e),r=_t[this.id]&&_t[this.id].handlers["*"]||[],i=_t[this.id]&&_t[this.id].handlers[e.type]||[],s=r.concat(i);if(s&&s.length){var o,u,a,f,l,c=this;for(o=0,u=s.length;o<u;o++)a=s[o],f=c,typeof a=="string"&&typeof n[a]=="function"&&(a=n[a]),typeof a=="object"&&a&&typeof a.handleEvent=="function"&&(f=a,a=a.handleEvent),typeof a=="function"&&(l=b({},e),st(a,f,[l],t))}return this},$t=function(e){return typeof e=="string"&&(e=[]),typeof e.length!="number"?[e]:e},Jt=function(e){if(!e||e.nodeType!==1)return;var t=function(e){if(!e&&!(e=n.event))return;e._source!=="js"&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source},r=function(r){if(!r&&!(r=n.event))return;t(r),At.focus(e)};e.addEventListener("mouseover",r,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),Ht[e.zcClippingId]={mouseover:r,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}},Kt=function(e){if(!e||e.nodeType!==1)return;var t=Ht[e.zcClippingId];if(typeof t!="object"||!t)return;var n,r,i=["move","leave","enter","out","over"];for(var s=0,o=i.length;s<o;s++)n="mouse"+i[s],r=t[n],typeof r=="function"&&e.removeEventListener(n,r,!1);delete Ht[e.zcClippingId]};At._createClient=function(){Bt.apply(this,y(arguments))},At.prototype.on=function(){return jt.apply(this,y(arguments))},At.prototype.off=function(){return Ft.apply(this,y(arguments))},At.prototype.handlers=function(){return It.apply(this,y(arguments))},At.prototype.emit=function(){return qt.apply(this,y(arguments))},At.prototype.clip=function(){return Rt.apply(this,y(arguments))},At.prototype.unclip=function(){return Ut.apply(this,y(arguments))},At.prototype.elements=function(){return zt.apply(this,y(arguments))},At.prototype.destroy=function(){return Wt.apply(this,y(arguments))},At.prototype.setText=function(e){return At.setData("text/plain",e),this},At.prototype.setHtml=function(e){return At.setData("text/html",e),this},At.prototype.setRichText=function(e){return At.setData("application/rtf",e),this},At.prototype.setData=function(){return At.setData.apply(this,y(arguments)),this},At.prototype.clearData=function(){return At.clearData.apply(this,y(arguments)),this},At.prototype.getData=function(){return At.getData.apply(this,y(arguments))},typeof define=="function"&&define.amd?define("lib-app/ZeroClipboard",[],function(){return At}):typeof module=="object"&&module&&typeof module.exports=="object"&&module.exports?module.exports=At:e.ZeroClipboard=At}(function(){return this||window}()),define("my/helpers/ZeroClipboardHelper",["lib-app/ZeroClipboard"],function(e){"use strict";var t=function(){return e.config({swfPath:"lib-app/ZeroClipboard.swf"}),e};return{initZeroClipboard:t}}),define("lib-build/hbars!my/content/dialogs/SeeExample",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return'<div id="main">\r\n	<section id="header">\r\n		<div class="blue-box outer-box">\r\n			<div class="inner-box"></div>\r\n		</div><!--\r\n	 --><div class="light-gray-box outer-box">\r\n	 		<div class="inner-box"></div>\r\n		</div>\r\n	</section>\r\n	<section id="main-line">\r\n		<div id="story-frame-container" data-width="'+u((i=(i=t.width||(e!=null?e.width:e))!=null?i:o,typeof i===s?i.call(e,{name:"width",hash:{},data:r}):i))+'" data-height="'+u((i=(i=t.height||(e!=null?e.height:e))!=null?i:o,typeof i===s?i.call(e,{name:"height",hash:{},data:r}):i))+'" class="outer-box">\r\n			<iframe id="story-frame" src="'+u((i=(i=t.url||(e!=null?e.url:e))!=null?i:o,typeof i===s?i.call(e,{name:"url",hash:{},data:r}):i))+'"></iframe>\r\n		</div><!--\r\n	 --><div id="variable-column" class="dark-gray-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 			<div class="text-box">\r\n	 				<div class="text big-text">\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>		 					\r\n	 				</div>\r\n	 			</div>\r\n	 		</div>\r\n		</div>\r\n	</section>\r\n	<section id="text-line-1">\r\n		<div class="dark-gray-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 			<div class="text-box">\r\n	 				<div class="text">\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 				</div>\r\n	 			</div>\r\n	 		</div>\r\n		</div><!--\r\n	 --><div class="dark-gray-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 			<div class="text-box">\r\n	 				<div class="text">\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 				</div>\r\n	 			</div>\r\n	 		</div>\r\n		</div><!--\r\n	 --><div class="dark-gray-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 			<div class="text-box">\r\n	 				<div class="text">\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 				</div>\r\n	 			</div>\r\n	 		</div>\r\n		</div><!--\r\n	 --><div class="blue-box outer-box">\r\n			<div class="inner-box"></div>\r\n		</div>\r\n	</section>\r\n	<section id="text-line-2">\r\n		<div class="dark-gray-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 			<div class="text-box">\r\n	 				<div class="text">\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 				</div>\r\n	 			</div>\r\n	 		</div>\r\n		</div><!--\r\n	 --><div class="blue-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 		</div>\r\n		</div><!--\r\n	 --><div class="dark-gray-box outer-box">\r\n	 		<div class="inner-box with-text">\r\n	 			<div class="fill-box"></div>\r\n	 			<div class="text-box">\r\n	 				<div class="text">\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 					<div class="text-filler"></div>\r\n	 					<div class="text-line partway"></div>\r\n	 				</div>\r\n	 			</div>\r\n	 		</div>\r\n		</div><!--\r\n	 --><div class="light-gray-box outer-box">\r\n			<div class="inner-box double-box">\r\n				<div class="fill-box"></div>\r\n				<div class="fill-box"></div>\r\n			</div>\r\n		</div>\r\n	</section>\r\n</div>'},useData:!0})}),define("lib-build/hbars!my/content/dialogs/SeeExampleHeader",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){return"<style>\r\n\r\n* {\r\n	box-sizing: border-box;\r\n}\r\n\r\nhtml, body {\r\n	margin: 0;\r\n	padding: 0;\r\n}\r\n\r\nbody {\r\n	background: rgb(170,170,170);\r\n}\r\n\r\n#main {\r\n	background: rgb(198,198,198);\r\n	box-shadow: 0 0 11px 6px rgb(150,150,150);\r\n	margin: auto;\r\n	padding: 0 15px 20px;\r\n	width: 1300px;\r\n}\r\n\r\n.blue-box .inner-box, .blue-box .with-text .fill-box {\r\n	background: rgb(126,168,194);\r\n}\r\n\r\n.light-gray-box .inner-box, .light-gray-box .double-box .fill-box {\r\n	background: rgb(223,224,226);\r\n}\r\n\r\n.dark-gray-box .inner-box, .dark-gray-box .with-text .fill-box, .text-line {\r\n	background: rgb(137,137,137);\r\n}\r\n\r\n.outer-box {\r\n	display: inline-block;\r\n	height: 100%;\r\n	padding: 0 15px;\r\n}\r\n\r\n.inner-box {\r\n	border-radius: 3px;\r\n	height: 100%;\r\n	width: 100%;\r\n}\r\n\r\nsection {\r\n	padding: 20px 0 0;\r\n}\r\n\r\n#header {\r\n	height: 100px;\r\n	width: 100%;\r\n}\r\n\r\n#header .blue-box {\r\n	width: 34%;\r\n}\r\n\r\n#header .light-gray-box {\r\n	width: 66%;\r\n}\r\n\r\n#main-line {\r\n	margin-top: 20px;\r\n	padding: 0;\r\n}\r\n\r\n#story-frame-container {\r\n	float: left;\r\n	margin: 0 15px;\r\n	padding: 0;\r\n}\r\n\r\n#story-frame {\r\n	border: none;\r\n	box-shadow: 0 0 11px 6px rgb(178, 178, 178);\r\n	height: 100%;\r\n	width: 100%;\r\n}\r\n\r\n#variable-column {\r\n	display: block;\r\n	overflow: hidden;\r\n	width: auto;	\r\n}\r\n\r\n.inner-box.with-text, .inner-box.double-box {\r\n	background: none;	\r\n}\r\n\r\n.fill-box {\r\n	border-radius: 3px;\r\n}\r\n\r\n.with-text > div {\r\n	width: 100%;\r\n}\r\n\r\n.with-text .fill-box {	\r\n	height: 66%;\r\n}\r\n\r\n.with-text .text-box {		\r\n	height: 34%;	\r\n	padding-top: 15px;\r\n}\r\n\r\n.with-text .text-box .text {\r\n	height: 100%;\r\n}\r\n\r\n.text-line {\r\n	border-radius: 7px;\r\n	height: 14.2%;\r\n	width: 100%;\r\n}\r\n\r\n.text-line.partway {\r\n	width: 66%;\r\n}\r\n\r\n\r\n/* Originally did without this class (and the element that uses it to make it a filler), \r\n	but margin-top or padding-top when percentages (as we'd want here) are calculated\r\n	as percentage of the WIDTH of the container (don't ask me why). */\r\n.text-filler {\r\n	height: 14.2%;\r\n	width: 100%;\r\n}\r\n\r\n\r\n.big-text .text-line {\r\n	border-radius: 15px;\r\n	height: 6.66%;\r\n}\r\n\r\n.big-text .text-filler {\r\n	height: 6.66%;\r\n}\r\n\r\n\r\n#text-line-1, #text-line-2 {\r\n	height: 300px;\r\n}\r\n\r\n#text-line-1 .outer-box, #text-line-2 .outer-box {\r\n	width: 25%;\r\n}\r\n\r\n.double-box .fill-box {\r\n	height: 40%;\r\n	margin-bottom: 20px;\r\n}\r\n</style>"},useData:!0})}),define("my/content/dialogs/ShareDialog",["dojo/Deferred","dojo/io-query","my/content/Templater","my/helpers/Formatter","my/helpers/UIHelper","my/content/dialogs/SeeExample","my/helpers/ZeroClipboardHelper","lib-build/hbars!./SeeExample","lib-build/hbars!./SeeExampleHeader"],function(e,t,n,r,i,s,o,u,a){"use strict";var f="800px",l="100%",c=function(e){var t=S(e);f="800px",l="100%",n.templatizeShareDialog(e.shortlink,e.embedUrl,e.url,e.accessLevel),h(e.url),t.then(function(e){$("#item-sharing-link-text").val(e),$("#shortlink-icon").attr("data-clipboard-text",e)})},h=function(e){$(".embed-dimensions.static").off("click").on("click",function(){m(),$(".embed-dimensions.active").removeClass("active"),$(this).addClass("active"),x($(this))}),$(".embed-dimensions.custom").off("click").on("click",function(){$(".embed-dimensions.active").removeClass("active"),$(this).addClass("active")}),$(".embed-custom-size").focus(function(){$(".embed-dimensions.active").removeClass("active"),$(this).parent().addClass("active"),g($(this)),v(),$(this).addClass("focused-dimension")}).blur(function(){var e=$(this),t=$(".embed-dimensions.custom.active .width").val()||"",n=$(".embed-dimensions.custom.active .height").val()||"",r=e.val(),i=$(".embed-custom-size").not(e),s=r.substring(r.length-1),o=r.substring(r.length-2);e.removeClass("focused-dimension"),r===""?p(e):(g(e),s!=="%"&&o!=="px"&&(r+="px",e.hasClass("width")?(t=r,$(".embed-dimensions.custom.active .width").val(t)):e.hasClass("height")&&(n=r,$(".embed-dimensions.custom.active .height").val(n)))),setTimeout(function(){i.hasClass("focused-dimension")===!1&&i.val()===""&&p(i),v()},1),T(t,n)}),$(".share-text").off("click").on("click",b),$(".share-modal .link-text-icon").on("mousedown",w),$(".shrae-modal .link-text-icon").on("mouseup",E),$("#example-button").on("click",function(){N(e)}),y()},p=function(e){e.addClass("embed-error"),$("#embed-error-text").css("display","block")},d=function(){$("#embed-error-text").css("display","none")},v=function(){$(".embed-custom-size.embed-error").length===0&&d()},m=function(){$(".embed-custom-size").removeClass("embed-error"),d()},g=function(e){e.removeClass("embed-error")},y=function(){var e=null,t=null,n=o.initZeroClipboard();e=new n($(".share-modal .link-text-icon.share")),n.on("error",function(){$("#shortlink-icon").css("display","none"),$("#item-sharing-link-text").css("padding-left","13px"),$("#embed-icon").css("display","none"),$("#embed-link").css("padding-left","13px"),$("#embed-link").css("text-align","center")}),t=new n($(".share-modal .link-text-icon.embed"))},b=function(){$(this).select()},w=function(){var e=$(this),t=null;e[0]===$("#embed-icon")[0]?t=$("#embed-copied-message"):t=$("#shortlink-copied-message"),e.addClass("copied"),e.removeClass("icon-copy"),e.addClass("icon-check"),e.addClass("success"),t.show(),setTimeout(function(){e.removeClass("icon-check"),e.removeClass("success"),e.addClass("icon-copy"),e.hasClass("copied")&&e.removeClass("copied"),t.hide()},1e3)},E=function(){$(this).removeClass("copied")},S=function(t){var n=new e;return r.formatBitlyLink(t.url,function(e){t.shortUrl=e,n.resolve(e)}),n.promise},x=function(e){var t=$(e).find(".dimensions").html(),n=t.split("/"),r=$.trim(n[0]),i=$.trim(n[1]);T(r,i)},T=function(e,t){l=e,f=t;var n=$("#embed-link").val().replace(/width=".*?"/gi,'width="'+e+'"').replace(/height=".*?"/gi,'height="'+t+'"');$("#embed-link").val(n),$("#embed-icon").attr("data-clipboard-text",n)},N=function(e){var t=window.open("","_blank");t.document.head.innerHTML+=a(),t.document.body.innerHTML=u({url:e,width:l,height:f}),s.init(t.document)};return{init:c}}),define("my/models/StoryMember",["my/helpers/Formatter"],function(e){"use strict";var t=function(e,t){var n="//www.arcgis.com/home/webmap/viewer.html?webmap="+e,r=o(e,n,"map");return r.info=a(t),r},n=function(){var e=o("","","layer");return e.info=f(),e},r=function(e,t,n,r,i,s,o){var a=u(e,t,"image");return a.info=l(n,r,i,s),a.info.isThumbnail=o,a},i=function(e,t,n,r){var i=u(e,t,"video");return i.info=l("",n,r),i},s=function(e,t,n){var r=u(e,t,"webpage");return r.info=c(n),r},o=function(e,t,n){var r={title:"",id:e,access:"",url:t,issues:[],hostedOnAGOL:!0,isOwnedByMe:!1,isSecureService:!1,isPremiumContent:!1,isSubscriptionContent:!1,hasProxy:!1,owner:"",notYoursNotAccessible:!1,inaccessible:!1,deleted:!1,serviceOkItemNot:!1,sharedBelowLevel:!1,type:n,info:{}};return r},u=function(t,n,r){var i=t||"",s={url:i,displayUrl:e.removeURLProtocol(i),issues:[],inaccessible:!1,sections:n,type:r};return s},a=function(e){var t={layers:[],sections:e,itemDetails:{},templateStrings:{ownedBy:""},modified:-1};return t},f=function(){var e={mapId:"",originalUrl:"",partOfMap:!1,templateStrings:{ownedBy:""},isScannable:!0,isBasemap:!1,persistentBasemap:!1};return e},l=function(e,t,n,r){var i={source:e,pinNumber:t,title:n,isFeatureService:r};return i},c=function(e){var t={pinNumber:e};return t};return{createMapInfo:t,createLayerInfo:n,createImageInfo:r,createVideoInfo:i,createWebpageInfo:s}}),define("my/helpers/TabHelper",[],function(){"use strict";var e=function(e,t,n){return{title:e,type:t,items:[],allClear:!0,hasSections:n}},t=function(e){e.allClear=!0;for(var t=0;t<e.items.length;t++)if(e.items[t].issues.length>0){e.allClear=!1;break}};return{getTabObject:e,scanTab:t}}),define("my/models/Issue",[],function(){"use strict";var e={deleted:"deleted",inaccessible:"inaccessible",notYoursNotAccessible:"notYoursNotAccessible",serviceOkItemNot:"serviceOkItemNot",secureService:"secureService",premiumContent:"premiumContent",subscriptionContent:"subscriptionContent",yoursSharedBelowLevel:"yoursSharedBelowLevel",othersSharedBelowLevel:"othersSharedBelowLevel",inaccessibleImage:"inaccessibleImage",inaccessibleVideo:"inaccessibleVideo",inaccessibleWebpage:"inaccessibleWebpage"},t={},n=function(){t.map={},t.map[e.deleted]=i18n.content.tooltipErrors.mapHasBeenDeleted,t.map[e.inaccessible]=i18n.content.tooltipErrors.mapIsInaccessible,t.map[e.notYoursNotAccessible]=i18n.content.tooltipErrors.mapNotYoursNotAccessible,t.map[e.secureService]=i18n.content.tooltipErrors.mapSecureService,t.map[e.premiumContent]=i18n.content.tooltipErrors.mapConsumesCredits,t.map[e.subscriptionContent]=i18n.content.tooltipErrors.mapSubscriptionContent,t.map[e.yoursSharedBelowLevel]="",t.map[e.othersSharedBelowLevel]=i18n.content.tooltipErrors.mapOthersSharedBelowLevel,t.layer={},t.layer[e.deleted]=i18n.content.tooltipErrors.layerHasBeenDeleted,t.layer[e.inaccessible]=i18n.content.tooltipErrors.layerIsInaccessible,t.layer[e.notYoursNotAccessible]=i18n.content.tooltipErrors.layerNotYoursNotAccessible,t.layer[e.serviceOkItemNot]=i18n.content.tooltipErrors.layerServiceOkItemNot,t.layer[e.secureService]=i18n.content.tooltipErrors.layerSecureService,t.layer[e.premiumContent]=i18n.content.tooltipErrors.layerConsumesCredits,t.layer[e.subscriptionContent]=i18n.content.tooltipErrors.layerSubscriptionContent,t.layer[e.yoursSharedBelowLevel]="",t.layer[e.othersSharedBelowLevel]=i18n.content.tooltipErrors.layerOthersSharedBelowLevel,t[e.inaccessibleImage]=i18n.content.tooltipErrors.imageInaccessible,t[e.inaccessibleVideo]=i18n.content.tooltipErrors.videoInaccessible,t[e.inaccessibleWebpage]=i18n.content.tooltipErrors.webpageInaccessible},r=function(){return e},i=function(e){var t="",n=r();switch(e){case n.deleted:case n.inaccessible:case n.notYoursNotAccessible:case n.serviceOkItemNot:case n.inaccessibleImage:case n.inaccessibleVideo:case n.inaccessibleWebpage:t="primary";break;case n.secureService:case n.premiumContent:case n.subscriptionContent:case n.yoursSharedBelowLevel:case n.othersSharedBelowLevel:t="secondary";break;default:}return t},s=function(e,t,n,r,s){var u={id:e,itemType:t,issueType:n,issueLevel:i(n),mapId:t==="layer"?r:"",text:o(t,n,s)};return u},o=function(e,n,r){var i="";return e==="map"?i=t[e][n]:e==="layer"?i=t[e][n].replace(/{{LAYER_NAME}}/g,'"'+r+'"'):i=t[n],i},u=function(e,t,n,r){var i=i18n.content.tooltipErrors;if(e==="organization")r==="map"?n.text=i.mapIsOrg:r==="layer"&&(n.text=i.layerIsOrg.replace(/{{LAYER_NAME}}/g,'"'+t+'"'));else if(e==="private"||e==="shared")r==="map"?n.text=i.mapIsPrivate:r==="layer"&&(n.text=i.layerIsPrivate.replace(/{{LAYER_NAME}}/g,'"'+t+'"'))};return{init:n,createIssue:s,getPossibleIssues:r,modifySharingIssueText:u}}),define("my/content/scanning/ItemScanner",["dojo/Deferred","dojo/promise/all","my/models/Issue","my/models/Credentials","my/content/ExpandedStory"],function(e,t,n,r,i){"use strict";var s=function(e){c(e),u(e),f(e)},o=function(n,r,i,s){var o=new e,u=new e,l=new e;return h(n,r,i,s,u),a(n,r,i,s,l),t([u.promise,l.promise]).then(function(){f(n),o.resolve()}),o.promise},u=function(e){var t={};for(var n=0;n<e.info.layers.length;n++)t=e.info.layers[n],t.info.mapId=e.id,c(t)},a=function(n,r,i,s,o){var u=null,a=[];for(var f=0;f<n.info.layers.length;f++)u=new e,h(n.info.layers[f],r,i,s,u),a.push(u.promise);t(a).then(function(){o.resolve()})},f=function(e){var t={};l(e);for(var n=0;n<e.info.layers.length;n++){t=e.info.layers[n];for(var r=0;r<t.issues.length;r++)e.issues.push(t.issues[r])}},l=function(e){var t=0;while(t<e.issues.length)e.issues[t].itemType==="layer"?e.issues.splice(t,1):t++},c=function(e){var t={},r={},s={},o={},u=n.getPossibleIssues(),a=i.getExpandedStory();e.serviceOkItemNot?a.ignoreServiceOkItemNot||(t=g(e,u.serviceOkItemNot),e.issues.push(t)):e.deleted?(r=g(e,u.deleted),e.issues.push(r)):e.inaccessible?(s=g(e,u.inaccessible),e.issues.push(s)):e.notYoursNotAccessible&&(o=g(e,u.notYoursNotAccessible),e.issues.push(o))},h=function(e,t,n,i,s){var o=r.getCredentials(),u=null;if(e.deleted||e.inaccessible||e.notYoursNotAccessible){s.resolve();return}p(e.issues),d(e,n,o.userName),v(e,n,o.userName),u=m(e,t,n,i),u.then(function(){s.resolve()})},p=function(e){var t=0;while(t<e.length)e[t].issueLevel==="secondary"?e.splice(t,1):t++},d=function(e,t,r){var i={},s=n.getPossibleIssues();if(e.owner!==r||!e.hostedOnAGOL||e.type==="layer"&&e.info.partOfMap===!0)return;e.sharedBelowLevel=!1;if(t==="private"||t==="shared")return;if(t==="organization"){if(e.access==="private"||e.access==="shared")e.sharedBelowLevel=!0,i=g(e,s.yoursSharedBelowLevel),n.modifySharingIssueText(e.access,e.title,i,e.type),e.issues.push(i)}else t==="public"&&(e.access==="organization"||e.access==="private"||e.access==="shared")&&(e.sharedBelowLevel=!0,i=g(e,s.yoursSharedBelowLevel),n.modifySharingIssueText(e.access,e.title,i,e.type),e.issues.push(i))},v=function(e,t,r){var i={},s=n.getPossibleIssues();if(e.owner===r)return;e.sharedBelowLevel=!1,t==="public"&&(e.access==="organization"||e.access==="private"||e.access==="shared")&&(e.sharedBelowLevel=!0,i=g(e,s.othersSharedBelowLevel),e.issues.push(i))},m=function(t,r,i,s){var o=new e,u=null,a=null,f=null,l=n.getPossibleIssues(),c=null;return t.isSecureService?(c=s.checkSecureService(t),c.then(function(e){e.hasProxy||(e.isPremiumContent?i==="public"&&(a=g(e,l.premiumContent),t.issues.push(a)):e.isSubscriptionContent?r==="public"&&i==="public"&&(f=g(e,l.subscriptionContent),t.issues.push(f)):i==="public"&&(u=g(e,l.secureService),t.issues.push(u))),o.resolve()}),o.promise):(o.resolve(),o.promise)},g=function(e,t){var r=n.createIssue(e.id,e.type,t,e.info.mapId||"",e.title);return r},y=function(e){var t={},r=n.getPossibleIssues(),i="";switch(e.type){case"image":i=r.inaccessibleImage;break;case"video":i=r.inaccessibleVideo;break;case"webpage":i=r.inaccessibleWebpage;break;default:i=r.inaccessible}e.inaccessible&&(t=n.createIssue(e.url,e.type,i,"",e.title),e.issues.push(t))};return{scanMapInitially:s,scanMapFinally:o,scanMedia:y}}),define("my/helpers/CookieHelper",[],function(){"use strict";var e=function(e){var t=document.cookie,n=t.indexOf(" "+e+"=");n==-1&&(n=t.indexOf(e+"="));if(n==-1)t=null;else{n=t.indexOf("=",n)+1;var r=t.indexOf(";",n);r==-1&&(r=t.length),t=decodeURIComponent(t.substring(n,r))}return t},t=function(){var t=e("esri_auth");return t?(t=JSON.parse(t.replace('"ssl":undefined','"ssl":""')),t||null):null},n=function(){var e=t(),n="www.arcgis.com";return e&&(e.portalApp?n=window.location.hostname:e.urlKey?n=(e.urlKey+"."+e.customBaseUrl).toLowerCase():n=e.customBaseUrl.toLowerCase()),n},r=function(){var e=t();return e?e.accountId:""};return{fetchCookie:e,getAccountBaseUrl:n,getAccountId:r}}),define("my/content/tabs/Maps",["dojo/on","dojo/promise/all","dojo/Deferred","esri/config","esri/arcgis/utils","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/OpenStreetMapLayer","esri/layers/KMLLayer","esri/layers/CSVLayer","esri/layers/WMSLayer","esri/layers/WMSLayerInfo","esri/layers/FeatureLayer","esri/layers/ArcGISImageServiceLayer","esri/layers/GeoRSSLayer","esri/request","my/models/Credentials","my/models/StoryMember","my/helpers/TabHelper","my/content/scanning/ItemScanner","my/helpers/Formatter","my/helpers/CookieHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";var S=null,x=function(e,r){S=S||m.getCredentials();var i=new n,s={},o=[];for(var u=0;u<e.length;u++)s=T(e[u]),o.push(s),s.then(function(e){e.cachedMap||b.scanMapInitially(e.map),window.builderIntegration&&app.cfg.cacheManager.updateCache("maps",e.map.id,e.map)});return t(o).then(function(e){var t=[];for(var n=0;n<e.length;n++)t.push(e[n].map);r.items=t,y.scanTab(r),i.resolve(r)}),i.promise},T=function(e){var t=new n,r=new n;return r.promise.then(function(e){e.cachedMap?t.resolve({cachedMap:!0,map:e.cachedMap}):e.wasSuccessful?k(e.results,e.mapResults,t):C(e.err,e.mapResults,t)}),app.cfg.scanNetworkManager.addRequest({item:e,deferred:r,request:N,numRequests:2}),t.promise},N=function(e){var t=e.sections?e.sections.slice():[],r=g.createMapInfo(e.id,t),s=new n,o=i.arcgisUrl+"/"+e.id,u=null;return u=v({url:o,content:{f:"json"},timeout:app.cfg.TIMEOUT_MILLISECONDS}),u.then(function(e){var t=o+"/data",n=null,i=null;if(window.builderIntegration){i=app.cfg.cacheManager.getFromCache("maps",e.id);if(i&&i.info.modified===e.modified){s.resolve({cachedMap:i});return}}n=v({url:t,content:{f:"json"},timeout:app.cfg.TIMEOUT_MILLISECONDS}),n.then(function(t){var n={item:e,itemData:t};s.resolve({results:n,mapResults:r,wasSuccessful:!0,err:null})},function(e){s.resolve({results:null,mapResults:r,wasSuccessful:!1,err:e})})},function(e){s.resolve({results:null,mapResults:r,wasSuccessful:!1,err:e})}),s.promise},C=function(e,t,n){e.httpCode===403?(t.isOwnedByMe=!1,t.notYoursNotAccessible=!0,t.info.templateStrings.ownedBy=w.formatMapLayerOwner(t.owner)):e.httpCode===400?t.deleted=!0:t.inaccessible=!0,n.resolve({map:t})},k=function(e,t,n){var r=S||m.getCredentials(),i=E.getAccountBaseUrl();t.owner=e.item.owner,t.info.modified=e.item.modified,t.info.templateStrings.ownedBy=w.formatMapLayerOwner(t.owner),e.item.owner===r.userName&&(t.isOwnedByMe=!0,t.url="//"+i+"/home/webmap/viewer.html?webmap="+t.id),t.title=e.item.title,t.access=e.item.access==="org"?"organization":e.item.access==="account"?"organization":e.item.access,t.info.itemDetails=e.itemData;var s=e.itemData.baseMap.baseMapLayers;for(var o=0;o<s.length;o++)s[o].title=e.itemData.baseMap.title,s[o].isBasemap=!0,o===0&&(s[o].persistentBasemap=!0);var u=s.concat(e.itemData.operationalLayers),a=L(u,e.item);a.then(function(e){t.info.layers=e,n.resolve({map:t})})},L=function(e,r){var i=new n,s={},o=[];for(var u=0;u<e.length;u++)s=new n,o.push(s.promise),app.cfg.scanNetworkManager.addRequest({item:{layerObj:e[u],map:r},deferred:s,request:A});return t(o).then(function(e){i.resolve(e)}),i.promise},A=function(e){var t=e.layerObj,r=e.map,i=g.createLayerInfo(),s=new n,o=null,u=null,a=null,f=null;i.title=t.title,i.info.isBasemap=t.isBasemap,i.info.persistentBasemap=t.persistentBasemap;if(!t.itemId&&!t.url)t.type==="WebTiledLayer"?(i.id=t.id,i.info.isScannable=!1,s.resolve(i)):t.layerType==="OpenStreetMap"||t.type==="OpenStreetMap"?(f=X(i),f.then(function(e){s.resolve(e)})):(i.id=t.id,o=$(i,r),s.resolve(o));else if(t.itemId&&!t.url)a=O(i,t,!1),a.then(function(e){s.resolve(e)});else{i.info.originalUrl=t.url,i.url=w.unProtocolUrl(t.url),i.id=t.id;if(t.type==="KML"||t.type==="CSV"||t.type==="WMS")u=V(i,t),u.then(function(e){s.resolve(e)});else if(t.itemId){var l=H(s,i,t);l.then(function(e){s.resolve(e)})}else{i.hostedOnAGOL=!1;var c=I(i,t);c.then(function(e){s.resolve(e)},function(e){s.resolve(e)})}}return s.promise},O=function(e,t,r){var s=new n,o=null;return e.id=t.itemId,o=v({url:i.arcgisUrl+"/"+e.id,content:{f:"json"},timeout:app.cfg.TIMEOUT_MILLISECONDS}),o.then(function(n){r?M(s,e,t,n):(D(e,t,n),s.resolve(e))},function(i){var o=new n;r?(P(o,i,e),o.promise.then(function(e){_(s,e,t)})):P(s,i,e)}),s.promise},M=function(e,t,n,r){var i=null,s=r.typeKeywords.indexOf("Hosted Service")!==-1,o=r.typeKeywords.indexOf("Service Proxy")!==-1;t.info.originalUrl=n.url,s||o?(D(t,n,r),e.resolve(t)):(i=I(t,n),i.then(function(t){D(t,n,r),e.resolve(t)},function(t){e.resolve(t)}))},_=function(e,t,n){var r=I(t,n);r.then(function(t){t.deleted=!1,t.inaccessible=!1,t.hostedOnAGOL=!1,t.notYoursNotAccessible=!1,t.serviceOkItemNot=!0,e.resolve(t)},function(t){t.hostedOnAGOL=!1,t.deleted=!1,t.inaccessible=!0,e.resolve(t)})},D=function(e,t,n){var r=E.getAccountBaseUrl(),i=S||m.getCredentials();e.owner=n.owner,e.info.templateStrings.ownedBy=w.formatMapLayerOwner(e.owner),n.owner===i.userName?(e.isOwnedByMe=!0,e.url="//"+r+"/home/item.html?id="+t.itemId):e.url="//www.arcgis.com/home/item.html?id="+t.itemId,e.access=n.access==="org"?"organization":n.access==="account"?"organization":n.access},P=function(e,t,n){n.deleted=!1,n.inaccessible=!1,t.httpCode===403?(n.isOwnedByMe=!1,n.notYoursNotAccessible=!0,n.info.templateStrings.ownedBy=w.formatMapLayerOwner(n.owner)):t.httpCode===400?n.deleted=!0:n.inaccessible=!0,e.resolve(n)},H=function(e,t,n){var r=O(t,n,!0);return r.then(function(t){e.resolve(t)}),e.promise},B=function(e){var t=!1,n=m.getCredentials();return n.orgId&&e.credential&&(t=!0),t},j=function(e,t,n){var r=window.setTimeout(function(){F(null,r,e,t,n)},app.cfg.TIMEOUT_MILLISECONDS);return r},F=function(e,t,n,r,i){window.clearTimeout(t),e&&e.httpCode===404?n.deleted=!0:n.inaccessible=!0,i.reject(n)},I=function(e,t){var r=new n;switch(t.layerType){case"ArcGISTiledMapServiceLayer":W(r,e,t);break;case"ArcGISImageServiceLayer":z(r,e);break;case"ArcGISFeatureLayer":U(r,e);break;case"ArcGISMapServiceLayer":R(r,e,t);break;case"GeoRSS":q(r,e,t);break;default:R(r,e,t)}return r.promise},q=function(e,t,n){t.url=n.url;var r=new d(t.url);r.on("load",function(n){t.isSecureService=B(n.layer),e.resolve(t)}),r.on("error",function(n){n.error&&n.error.httpCode===404?t.deleted=!0:t.isSecureService||(t.inaccessible=!0),e.reject(t)})},R=function(e,t,n){var r=new s(t.url),i=j(t,n,e);r.on("load",function(n){window.clearTimeout(i),t.title||(t.title=n.layer.layerInfos[0].name),t.isSecureService=B(n.layer),e.resolve(t)}),r.on("error",function(r){F(r.error,i,t,n,e)})},U=function(e,t){var n=new h(t.url),r=j(t,null,e);n.on("load",function(n){window.clearTimeout(r),t.isSecureService=B(n.layer),e.resolve(t)}),n.on("error",function(n){F(n.error,r,t,null,e)})},z=function(e,t){var n=new p(t.url),r=j(t,null,e);n.on("load",function(n){window.clearTimeout(r),t.isSecureService=B(n.layer),e.resolve(t)}),n.on("error",function(n){F(n.error,r,t,null,e)})},W=function(e,t,n){var r=new o(t.url),i=j(t,n,e);r.on("load",function(n){window.clearTimeout(i),t.title||(t.title=n.layer.layerInfos[0].name),t.isSecureService=B(n.layer),e.resolve(t)}),r.on("error",function(r){F(r.error,i,t,n,e)})},X=function(e){var t=new n;return e.info.partOfMap=!0,e.info.isScannable=!1,t.resolve(e),t.promise},V=function(e,t){var i=new n,s=m.getCredentials().token;e.hostedOnAGOL=!1,e.url=t.url;if(t.type==="KML"){t.itemId&&(e.url=e.url+"?token="+s);var o=new a(e.url);o.on("load",function(){i.resolve(e)}),o.on("error",function(){e.inaccessible=!0,i.resolve(e)})}else if(t.type==="CSV"){e.info.originalUrl=e.url,r.defaults.io.proxyUrl="/apps/proxy/sm-proxy.php";var u=new f(e.url);r.defaults.io.proxyUrl="//www.arcgis.com/sharing/proxy",u.on("load",function(){i.resolve(e)}),u.on("error",function(){e.inaccessible=!0,i.resolve(e)})}else t.type==="WMS"?(e.info.isScannable=!1,i.resolve(e)):(e.info.isScannable=!1,i.resolve(e));return i.promise},$=function(e,t){var n=S||m.getCredentials();return e.info.partOfMap=!0,e.owner=t.owner,e.info.templateStrings.ownedBy=w.formatMapLayerOwner(e.owner),e.owner===n.userName&&(e.isOwnedByMe=!0),e};return{buildMapsObj:x}}),define("my/content/tabs/Images",["dojo/promise/all","dojo/Deferred","my/models/Credentials","my/models/StoryMember","my/content/scanning/ItemScanner","my/helpers/TabHelper"],function(e,t,n,r,i,s){"use strict";var o=function(n,r){var o=new t,a=[],f={},l=null,c=null;for(var h=0;h<n.length;h++)l=n[h],window.builderIntegration&&(c=app.cfg.cacheManager.getFromCache("images",l.id)),f=new t,a.push(f.promise),f.promise.then(function(e){c||i.scanMedia(e),window.builderIntegration&&app.cfg.cacheManager.updateCache("images",e.url,e)}),window.builderIntegration&&c?f.resolve(c):app.cfg.scanNetworkManager.addRequest({item:l,deferred:f,request:u});return e(a).then(function(e){r.items=e,s.scanTab(r),o.resolve(r)}),o.promise},u=function(e){var i=e.sections?e.sections.slice():[],s=c(e.id),o=e.pinNumber||0,u=e.title||"",h=e.isThumbnail,p=e.isFeatureService?e.isFeatureService:!1,d=r.createImageInfo(e.id,i,s,o,u,p,h),v=new Image,m=new t,g={},y=15e3,b=!1,w=n.getCredentials();return g=setTimeout(function(){b=l(m,d,b)},y),v.onload=function(){a(m,d,g,b)},v.addEventListener("error",function(){f(m,d,g,b)}),e.isFeatureService?v.src=d.url+"?token="+w.token:v.src=d.url,m.promise},a=function(e,t,n,r){clearTimeout(n),r||e.resolve(t)},f=function(e,t,n,r){clearTimeout(n),r||(t.inaccessible=!0,e.resolve(t))},l=function(e,t,n){return n=!0,t.inaccessible=!0,e.resolve(t),n},c=function(e){var t="",n={};return n=new RegExp("\\/\\/fbcdn|fbcdn\\.net"),n.test(e)?(t="Facebook",t):(n=new RegExp("flickr\\.com"),n.test(e)?(t="Flickr",t):(n=new RegExp("\\.ggpht\\.com"),n.test(e)?(t="Picasa",t):(t="Url",t)))};return{buildImagesObj:o}}),define("my/content/tabs/Videos",["dojo/promise/all","dojo/Deferred","esri/request","my/models/StoryMember","my/content/scanning/ItemScanner","my/helpers/TabHelper"],function(e,t,n,r,i,s){"use strict";var o=/(youtube\.com\/(watch\?v\=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,u=/^.*(vimeo\.com\/)((video\/))?([0-9]+)/,a=function(n,r){var o=new t,u=[],a={},l=null,c=null;for(var h=0;h<n.length;h++)l=n[h],window.builderIntegration&&(c=app.cfg.cacheManager.getFromCache("videos",l.id)),a=new t,u.push(a.promise),a.promise.then(function(e){c||i.scanMedia(e),window.builderIntegration&&app.cfg.cacheManager.updateCache("videos",e.displayUrl,e)}),window.builderIntegration&&c?a.resolve(c):app.cfg.scanNetworkManager.addRequest({item:l,deferred:a,request:f});return e(u).then(function(e){r.items=e,s.scanTab(r),o.resolve(r)}),o.promise},f=function(e){var n=e.title||"",i=e.sections?e.sections.slice():[],s=e.pinNumber||0,a=r.createVideoInfo(e.id,i,s,n),f=new t,h=o.exec(a.url),p=u.exec(a.url),d={},v={};return h?(d=l(a,h),d.then(function(e){f.resolve(e)})):p?(v=c(a,p),v.then(function(e){f.resolve(e)})):(a.inaccessible=!0,f.resolve(a)),f.promise},l=function(e,n){var r=new t,i="";return e.info.source="YouTube",n.length===4?(i=n[3],e.url="https://www.youtube.com/watch?v="+i,$.ajax({url:"https://www.googleapis.com/youtube/v3/videos",data:{part:"snippet",id:i,key:"AIzaSyCHc4DP7IJU2neC0lbuKh5Fg5g3RVeRoiE"},timeout:4e3,success:function(t){t.items&&t.items.length>0?(e.info.title||(e.info.title=t.items[0].snippet.title),r.resolve(e)):(e.inaccessible=!0,r.resolve(e))},error:function(){e.inaccessible=!0,r.resolve(e)}})):(e.inaccessible=!0,r.resolve(e)),r.promise},c=function(e,n){var r=new t,i="";return e.info.source="Vimeo",n.length===5?(i=n[4],e.url="https://vimeo.com/"+i,$.ajax({url:"https://api.vimeo.com/videos/"+i,headers:{Authorization:"bearer f22bff482301959a0e18a3257ee8966b",Accept:"application/vnd.vimeo.*+json;version=3.2"},success:function(t){e.info.title||(e.info.title=t.name),r.resolve(e)},error:function(){e.inaccessible=!0,r.resolve(e)}})):(e.inaccessible=!0,r.resolve(e)),r.promise};return{buildVideosObj:a,youTubeRegex:o,vimeoRegex:u}}),define("my/content/tabs/Webpages",["dojo/promise/all","dojo/Deferred","my/models/StoryMember","my/content/scanning/ItemScanner"],function(e,t,n,r){"use strict";var i=function(n,i){var o=new t,u=[],a={};for(var f=0;f<n.length;f++)a=s(n[f]),u.push(a),a.then(function(e){r.scanMedia(e)});return e(u).then(function(e){i.items=e,o.resolve(i)}),o.promise},s=function(e){var r=e.id,i=e.sections?e.sections.slice():[],s=e.pinNumber||0,o=n.createWebpageInfo(r,i,s),u=new t;return u.resolve(o),u.promise};return{buildWebpagesObj:i}}),define("my/content/builders/SectionedStory",["my/helpers/Formatter"],function(e){"use strict";var t=function(e,t){var n=null;e&&e.story&&(n=i(e,t),r(n))},n=function(e,t,n){var r={maps:[],images:[],videos:[],webpages:[]},u=-1,a=0,f="",l={},c={},h="";if(n)return r;h=i(e,t);for(var p=0;p<h.length;p++)u=h[p],a=p+1,s(r,u,a,t),u.media.webmap?o(u.media.webmap.id,r,"maps",u,a,!0,t):u.media.image?o(u.media.image.url,r,"images",u,a,!0,t):u.media.video?o(u.media.video.url,r,"videos",u,a,!0,t):u.media.webpage&&(u.media.webpage.url?f=u.media.webpage.url:(l=document.createElement("div"),l.innerHTML=u.media.webpage.frameTag,c=$(l).find(">:first-child").attr("src"),f=c),o(f,r,"webpages",u,a,!0,t));return r},r=function(e){if(!e)return;var t=null;for(var n=0;n<e.length;n++)t=e[n],t.status==="HIDDEN"&&(e.splice(n,1),n--)},i=function(e,t){var n=null;return t==="Map Journal"?n=e.story.sections:t==="Map Series"&&(n=e.story.entries),n},s=function(e,t,n,r){var i=document.createElement("div"),s=[],u=[],a="",f="";r==="Map Journal"?i.innerHTML=t.content:r==="Map Series"&&(i.innerHTML=t.description),s=$(i).find("iframe"),u=$(i).find("img");for(var l=0;l<s.length;l++)a=$(s[l]).attr("src"),a.indexOf(".vimeo.com")!==-1||a.indexOf(".youtube.com")!==-1?o(a,e,"videos",t,n,!1,r):o(a,e,"webpages",t,n,!1,r);for(var c=0;c<u.length;c++)f=$(u[c]).attr("src"),o(f,e,"images",t,n,!1,r)},o=function(t,n,r,i,s,o,a){var p=n[r],d=l(t,p),v={},m=e.cleanHtmlText(i.title),g=-1,y={};d===-1?f(t,p,s,m,!1,o):(v=p[d],g=c(v.sections,s),g===-1?h(v.sections,s,m,!1,o):(y=v.sections[g],o?y.mainContent=!0:y.sideContent=!0)),o&&a==="Map Journal"&&u(n,i,s,m)},u=function(e,t,n,r){for(var i=0;i<t.contentActions.length;i++){var s=t.contentActions[i],o="";t.content.indexOf(s.id)!==-1&&s.media&&(s.media.webmap?(o=s.media.webmap.id,a(o,e.maps,n,r)):s.media.image?(o=s.media.image.url,a(o,e.images,n,r)):s.media.video?(o=s.media.video.url,a(o,e.videos,n,r)):s.media.webpage&&(o=s.media.webpage.url,a(o,e.webpages,n,r)))}},a=function(e,t,n,r){var i=l(e,t),s={},o=-1,u={};i===-1?f(e,t,n,r,!0,!1):(s=t[i],o=c(s.sections,n),o===-1?h(s.sections,n,r,!0,!1):(u=s.sections[o],u.numActions++))},f=function(e,t,n,r,i,s){var o={id:e,sections:[]};h(o.sections,n,r,i,s),t.push(o)},l=function(e,t){var n=-1;for(var r=0;r<t.length;r++)if(t[r].id===e)return n=r,n;return n},c=function(e,t){var n=-1;for(var r=0;r<e.length;r++)if(e[r].sectionNum===t)return n=r,n;return n},h=function(e,t,n,r,i){var s=r?1:0,o={sectionNum:t,title:n,numActions:s,mainContent:i,sideContent:!r&&!i};e.push(o)},p=function(e,t){var n=0,r={},s=i(e,t);for(var o=0;o<s.length;o++){var u=s[o];u.status==="HIDDEN"&&s.splice(o,1),u.media.webmap&&(r[u.media.webmap.id]||(r[u.media.webmap.id]=!0,n+=1))}return n};return{init:t,getMedia:n,getNumMapsInStory:p}}),define("my/content/builders/MapJournalBuilder",["my/content/builders/SectionedStory"],function(e){"use strict";var t=function(t){e.init(t,"Map Journal")},n=function(t){var n=i18n.infographics.mapJournal,r=[];return!t||!t.story||!t.settings?r=[{title:n.firstTitle,value:window.engStrings.notApplicable,img:"icon-stories-sections"},{title:n.secondTitle,value:n.secondValueA,img:"icon-stories-side_panel"},{title:n.thirdTitle,value:0,img:"icon-stories-marker"}]:r=[{title:n.firstTitle,value:t.story.sections.length,img:"icon-stories-sections"},{title:n.secondTitle,value:t.settings.layout.id==="side"?n.secondValueA:n.secondValueB,img:t.settings.layout.id==="side"?"icon-stories-side_panel":"icon-stories-floating"},{title:n.thirdTitle,value:e.getNumMapsInStory(t,"Map Journal"),img:"icon-stories-marker"}],r},r=function(t,n){var r=e.getMedia(t,"Map Journal",n);return r},i=function(){return i18n.content.component.mapJournal},s=function(){return i18n.content.titleType.mapJournal};return function(e){return t(e),{buildInfographics:n,getMedia:r,getStoryComponent:i,getTitleType:s}}}),define("my/content/builders/MapSeriesBuilder",["my/content/builders/SectionedStory"],function(e){"use strict";var t="",n=function(t){e.init(t,"Map Series")},r=function(t){var n="",r="",i="",s=[],o=null,u=i18n.infographics.mapSeries;return!t||!t.story||!t.settings?(s=[{title:i18n.infographics.mapSeries.firstTitleB,value:window.engStrings.notApplicable,img:"icon-stories-sections"},{title:u.secondTitle,value:window.engStrings.notApplicable,img:"icon-stories-bulleted"},{title:u.thirdTitle,value:0,img:"icon-stories-marker"}],s):(o=t.settings.layout.id,o==="bullet"?(n=u.firstTitleA,r="icon-stories-bulleted",i=u.secondValueA):o==="accordion"?(n=u.firstTitleB,r="icon-stories-accordion",i=u.secondValueB):o==="tab"&&(n=u.firstTitleC,r="icon-stories-tabbed",i=u.secondValueC),s=[{title:n,value:t.story.entries.length,img:"icon-stories-sections"},{title:u.secondTitle,value:i,img:r},{title:u.thirdTitle,value:e.getNumMapsInStory(t,"Map Series"),img:"icon-stories-marker"}],s)},i=function(t,n){var r=e.getMedia(t,"Map Series",n);return r},s=function(){return t},o=function(){return i18n.content.titleType.mapSeries};return function(e){var u="";return!e||!e.settings?t="":(u=e.settings.layout.id,t=i18n.content.component[u]),n(e),{buildInfographics:r,getMedia:i,getStoryComponent:s,getTitleType:o}}}),define("my/content/builders/SwipeSpyglassBuilder",[],function(){"use strict";var e="",t="",n=function(e){var t=i18n.infographics.swipeSpyglass,n=[];return!e||!e.webmaps?n=[{title:t.firstTitle,value:1,img:"icon-stories-sections"},{title:t.secondTitle,value:t.secondValueA,img:"icon-stories-swipe"},{title:t.thirdTitle,value:1,img:"icon-stories-marker"}]:n=[{title:t.firstTitle,value:e.bookmarks?e.bookmarks.length:1,img:"icon-stories-sections"},{title:t.secondTitle,value:e.layout==="swipe"?t.secondValueA:t.secondValueB,img:e.layout==="swipe"?"icon-stories-swipe":"icon-stories-spyglass"},{title:t.thirdTitle,value:e.webmaps.length,img:"icon-stories-marker"}],n},r=function(e,t){var n={maps:[]},r={};if(t&&!e)return n;if(t&&e.webmap)return r={id:e.webmap},n.maps.push(r),n;if(e.dataModel==="TWO_WEBMAPS")for(var i=0;i<e.webmaps.length;i++)r={id:e.webmaps[i]},n.maps.push(r);else e.dataModel==="TWO_LAYERS"&&(r={id:e.webmap},n.maps.push(r));return n},i=function(){return e},s=function(){return t};return function(){return{buildInfographics:n,getMedia:r,getStoryComponent:i,getTitleType:s}}}),!function(e){var t=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(e){return!e||/^\s*$/.test(e)},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(e){return"undefined"==typeof e},toStr:function(e){return t.isUndefined(e)||null===e?"":e+""},bind:e.proxy,each:function(t,n){function r(e,t){return n(t,e)}e.each(t,r)},map:e.map,filter:e.grep,every:function(t,n){var r=!0;return t?(e.each(t,function(e,i){return(r=n.call(null,i,e,t))?void 0:!1}),!!r):r},some:function(t,n){var r=!1;return t?(e.each(t,function(e,i){return(r=n.call(null,i,e,t))?!1:void 0}),!!r):r},mixin:e.extend,getUniqueId:function(){var e=0;return function(){return e++}}(),templatify:function(t){function n(){return String(t)}return e.isFunction(t)?t:n},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var r,i;return function(){var s,o,u=this,a=arguments;return s=function(){r=null,n||(i=e.apply(u,a))},o=n&&!r,clearTimeout(r),r=setTimeout(s,t),o&&(i=e.apply(u,a)),i}},throttle:function(e,t){var n,r,i,s,o,u;return o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)},function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},noop:function(){}}}(),n="0.10.5",r=function(){"use strict";function e(e){return e=t.toStr(e),e?e.split(/\s+/):[]}function n(e){return e=t.toStr(e),e?e.split(/\W+/):[]}function r(e){return function(){var n=[].slice.call(arguments,0);return function(r){var i=[];return t.each(n,function(n){i=i.concat(e(t.toStr(r[n])))}),i}}}return{nonword:n,whitespace:e,obj:{nonword:r(n),whitespace:r(e)}}}(),i=function(){"use strict";function n(n){this.maxSize=t.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=e.noop)}function r(){this.head=this.tail=null}function i(e,t){this.key=e,this.val=t,this.prev=this.next=null}return t.mixin(n.prototype,{set:function(e,t){var n,r=this.list.tail;this.size>=this.maxSize&&(this.list.remove(r),delete this.hash[r.key]),(n=this.hash[e])?(n.val=t,this.list.moveToFront(n)):(n=new i(e,t),this.list.add(n),this.hash[e]=n,this.size++)},get:function(e){var t=this.hash[e];return t?(this.list.moveToFront(t),t.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new r}}),t.mixin(r.prototype,{add:function(e){this.head&&(e.next=this.head,this.head.prev=e),this.head=e,this.tail=this.tail||e},remove:function(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev},moveToFront:function(e){this.remove(e),this.add(e)}}),n}(),s=function(){"use strict";function e(e){this.prefix=["__",e,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+t.escapeRegExChars(this.prefix))}function n(){return(new Date).getTime()}function r(e){return JSON.stringify(t.isUndefined(e)?null:e)}function i(e){return JSON.parse(e)}var s,o;try{s=window.localStorage,s.setItem("~~~","!"),s.removeItem("~~~")}catch(u){s=null}return o=s&&window.JSON?{_prefix:function(e){return this.prefix+e},_ttlKey:function(e){return this._prefix(e)+this.ttlKey},get:function(e){return this.isExpired(e)&&this.remove(e),i(s.getItem(this._prefix(e)))},set:function(e,i,o){return t.isNumber(o)?s.setItem(this._ttlKey(e),r(n()+o)):s.removeItem(this._ttlKey(e)),s.setItem(this._prefix(e),r(i))},remove:function(e){return s.removeItem(this._ttlKey(e)),s.removeItem(this._prefix(e)),this},clear:function(){var e,t,n=[],r=s.length;for(e=0;r>e;e++)(t=s.key(e)).match(this.keyMatcher)&&n.push(t.replace(this.keyMatcher,""));for(e=n.length;e--;)this.remove(n[e]);return this},isExpired:function(e){var r=i(s.getItem(this._ttlKey(e)));return t.isNumber(r)&&n()>r?!0:!1}}:{get:t.noop,set:t.noop,remove:t.noop,clear:t.noop,isExpired:t.noop},t.mixin(e.prototype,o),e}(),o=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastUrl=null,this._send=t.transport?r(t.transport):e.ajax,this._get=t.rateLimiter?t.rateLimiter(this._get):this._get,this._cache=t.cache===!1?new i(0):a}function r(n){return function(r,i){function s(e){t.defer(function(){u.resolve(e)})}function o(e){t.defer(function(){u.reject(e)})}var u=e.Deferred();return n(r,i,s,o),u}}var s=0,o={},u=6,a=new i(10);return n.setMaxPendingRequests=function(e){u=e},n.resetCache=function(){a.reset()},t.mixin(n.prototype,{_get:function(e,t,n){function r(t){n&&n(null,t),l._cache.set(e,t)}function i(){n&&n(!0)}function a(){s--,delete o[e],l.onDeckRequestArgs&&(l._get.apply(l,l.onDeckRequestArgs),l.onDeckRequestArgs=null)}var f,l=this;this.cancelled||e!==this.lastUrl||((f=o[e])?f.done(r).fail(i):u>s?(s++,o[e]=this._send(e,t).done(r).fail(i).always(a)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(e,n,r){var i;return t.isFunction(n)&&(r=n,n={}),this.cancelled=!1,this.lastUrl=e,(i=this._cache.get(e))?t.defer(function(){r&&r(null,i)}):this._get(e,n,r),!!i},cancel:function(){this.cancelled=!0}}),n}(),u=function(){"use strict";function n(t){t=t||{},t.datumTokenizer&&t.queryTokenizer||e.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=t.datumTokenizer,this.queryTokenizer=t.queryTokenizer,this.reset()}function r(e){return e=t.filter(e,function(e){return!!e}),e=t.map(e,function(e){return e.toLowerCase()})}function i(){return{ids:[],children:{}}}function s(e){for(var t={},n=[],r=0,i=e.length;i>r;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n}function o(e,t){function n(e,t){return e-t}var r=0,i=0,s=[];e=e.sort(n),t=t.sort(n);for(var o=e.length,u=t.length;o>r&&u>i;)e[r]<t[i]?r++:e[r]>t[i]?i++:(s.push(e[r]),r++,i++);return s}return t.mixin(n.prototype,{bootstrap:function(e){this.datums=e.datums,this.trie=e.trie},add:function(e){var n=this;e=t.isArray(e)?e:[e],t.each(e,function(e){var s,o;s=n.datums.push(e)-1,o=r(n.datumTokenizer(e)),t.each(o,function(e){var t,r,o;for(t=n.trie,r=e.split("");o=r.shift();)t=t.children[o]||(t.children[o]=i()),t.ids.push(s)})})},get:function(e){var n,i,u=this;return n=r(this.queryTokenizer(e)),t.each(n,function(e){var t,n,r,s;if(i&&0===i.length)return!1;for(t=u.trie,n=e.split("");t&&(r=n.shift());)t=t.children[r];return t&&0===n.length?(s=t.ids.slice(0),void (i=i?o(i,s):s)):(i=[],!1)}),i?t.map(s(i),function(e){return u.datums[e]}):[]},reset:function(){this.datums=[],this.trie=i()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),a=function(){"use strict";function r(e){return e.local||null}function i(r){var i,s;return s={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(i=r.prefetch||null)&&(i=t.isString(i)?{url:i}:i,i=t.mixin(s,i),i.thumbprint=n+i.thumbprint,i.ajax.type=i.ajax.type||"GET",i.ajax.dataType=i.ajax.dataType||"json",!i.url&&e.error("prefetch requires url to be set")),i}function s(n){function r(e){return function(n){return t.debounce(n,e)}}function i(e){return function(n){return t.throttle(n,e)}}var s,o;return o={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(s=n.remote||null)&&(s=t.isString(s)?{url:s}:s,s=t.mixin(o,s),s.rateLimiter=/^throttle$/i.test(s.rateLimitBy)?i(s.rateLimitWait):r(s.rateLimitWait),s.ajax.type=s.ajax.type||"GET",s.ajax.dataType=s.ajax.dataType||"json",delete s.rateLimitBy,delete s.rateLimitWait,!s.url&&e.error("remote requires url to be set")),s}return{local:r,prefetch:i,remote:s}}();!function(n){"use strict";function i(t){t&&(t.local||t.prefetch||t.remote)||e.error("one of local, prefetch, or remote is required"),this.limit=t.limit||5,this.sorter=f(t.sorter),this.dupDetector=t.dupDetector||l,this.local=a.local(t),this.prefetch=a.prefetch(t),this.remote=a.remote(t),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new u({datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),this.storage=this.cacheKey?new s(this.cacheKey):null}function f(e){function n(t){return t.sort(e)}function r(e){return e}return t.isFunction(e)?n:r}function l(){return!1}var c,h;return c=n.Bloodhound,h={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=i,i.noConflict=function(){return n.Bloodhound=c,i},i.tokenizers=r,t.mixin(i.prototype,{_loadPrefetch:function(t){function n(e){s.clear(),s.add(t.filter?t.filter(e):e),s._saveToStorage(s.index.serialize(),t.thumbprint,t.ttl)}var r,i,s=this;return(r=this._readFromStorage(t.thumbprint))?(this.index.bootstrap(r),i=e.Deferred().resolve()):i=e.ajax(t.url,t.ajax).done(n),i},_getFromRemote:function(e,t){function n(e,n){t(e?[]:s.remote.filter?s.remote.filter(n):n)}var r,i,s=this;if(this.transport)return e=e||"",i=encodeURIComponent(e),r=this.remote.replace?this.remote.replace(this.remote.url,e):this.remote.url.replace(this.remote.wildcard,i),this.transport.get(r,this.remote.ajax,n)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(e,t,n){this.storage&&(this.storage.set(h.data,e,n),this.storage.set(h.protocol,location.protocol,n),this.storage.set(h.thumbprint,t,n))},_readFromStorage:function(e){var t,n={};return this.storage&&(n.data=this.storage.get(h.data),n.protocol=this.storage.get(h.protocol),n.thumbprint=this.storage.get(h.thumbprint)),t=n.thumbprint!==e||n.protocol!==location.protocol,n.data&&!t?n.data:null},_initialize:function(){function n(){i.add(t.isFunction(s)?s():s)}var r,i=this,s=this.local;return r=this.prefetch?this._loadPrefetch(this.prefetch):e.Deferred().resolve(),s&&r.done(n),this.transport=this.remote?new o(this.remote):null,this.initPromise=r.promise()},initialize:function(e){return!this.initPromise||e?this._initialize():this.initPromise},add:function(e){this.index.add(e)},get:function(e,n){function r(e){var r=s.slice(0);t.each(e,function(e){var n;return n=t.some(r,function(t){return i.dupDetector(e,t)}),!n&&r.push(e),r.length<i.limit}),n&&n(i.sorter(r))}var i=this,s=[],o=!1;s=this.index.get(e),s=this.sorter(s).slice(0,this.limit),s.length<this.limit?o=this._getFromRemote(e,r):this._cancelLastRemoteRequest(),o||(s.length>0||!this.transport)&&n&&n(s)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&o.resetCache()},ttAdapter:function(){return t.bind(this.get,this)}}),i}(this)}(window.jQuery),define("lib-app/typeahead",function(){}),define("my/helpers/FilterSort",["lib-app/typeahead"],function(){"use strict";var e={},t={sortType:"",reversed:!1},n=[],r=!1,i=[],s="",o=function(t){e=new Bloodhound({name:"results",local:t,datumTokenizer:Bloodhound.tokenizers.obj.whitespace("title","type","summary","tagsString"),queryTokenizer:Bloodhound.tokenizers.whitespace})},u=function(t){e.add(t)},a=function(t){e.clear(),e.add(t)},f=function(){r=!1,i=[],s=""},l=function(){return s},c=function(n,o,u){var a=[],l=[];if(e)if(n===""){if(typeof u=="function"){var c={sortType:t.sortType,reversed:t.reversed};s=n,p(),f(),a=b(o,c,!1),l=k(a),u(l,!0,!0)}}else n&&n.length>1&&e.get(n,function(e){if(typeof u=="function"){var o={sortType:t.sortType,reversed:t.reversed};s=n,p(),a=b(e,o,!1),i=a,r=!0,l=k(a),u(l,!0,!1)}})},h=function(){return t},p=function(){t.sortType="",t.reversed=!1},d=function(e){var t=[];return t=e.sort(function(e,t){var n="",r="";return e.title&&(n=e.title.toLowerCase()),t.title&&(r=t.title.toLowerCase()),n<r?-1:n>r?1:0}),t},v=function(e){var t=[];return t=e.sort(function(e,t){var n=e.numViews,r=t.numViews;return n>r?-1:n<r?1:0}),t},m=function(e){var t=[];return t=e.sort(function(e,t){var n=e.modified,r=t.modified;return n>r?-1:n<r?1:0}),t},g=function(e){var t=[];return t=e.sort(function(e,t){var n=e.allClear,r=t.allClear;return n<r?-1:n>r?1:0}),t},y=function(e,t){var n=[],r=0,i=0;return n=e.sort(function(e,n){return r=e.pinNumber,i=n.pinNumber,r===t&&(r=0),i===t&&(i=0),r-i}),n},b=function(e,n,r){var i=[];if(t.sortType===n.sortType)return r?(i=e.reverse(),t.reversed=!t.reversed,i):(i=e,i);t.sortType=n.sortType,t.reversed=n.reversed;switch(t.sortType){case"title":i=d(e);break;case"num-views":i=v(e);break;case"modified":i=m(e);break;case"all-clear":i=g(e);break;default:i=e}return t.reversed===!0&&i.reverse(),i},w=function(e,t){var r=S(e),i=null;return r===-1&&(n.push(e),i=k(t)),i},E=function(e,s){var o=S(e),u=null,a=[],f=[],l={sortType:t.sortType,reversed:t.reversed};return o!==-1&&(n.splice(o,1),p(),r?f=i:f=s,a=b(f,l,!1),u=k(a)),u},S=function(e){var t=null;for(var r=0;r<n.length;r++){t=n[r];if(t.category===e.category&&t.value===e.value)return r}return-1},x=function(e){var t=null,r=null;for(var i=0;i<n.length;i++)r=n[i],r.category===e&&(t=r);return t},T=function(e){var t=S(e);return t===-1?!1:!0},N=function(){n=[]},C=function(){return n},k=function(e){var i=[],s=null,o=null,u=!1,a={items:[],clearList:!1};if(n.length===0)return!r&&(!t.sortType||t.sortType==="modified"&&!t.reversed)&&(a.clearList=!0),a.items=e,a;for(var f=0;f<n.length;f++){i=[],o=n[f];for(var l=0;l<e.length;l++)s=e[l],u=s[o.category]===o.value,u&&i.push(s);e=i}return a.items=i,a};return{initBloodhound:o,add:u,clearSearch:f,reseedSuggestions:a,getSearchTerm:l,filterResults:c,getSortedBy:h,clearSortedBy:p,sortByPinNumber:y,sort:b,addFilter:w,removeFilter:E,getCriteriaByCategory:x,checkIsInFilterCriteria:T,getFilterCriteria:C,clearFilterCriteria:N}}),define("my/content/builders/MapTourBuilder",["dojo/Deferred","my/helpers/Formatter","my/helpers/FilterSort","esri/layers/FeatureLayer","esri/layers/CSVLayer","esri/tasks/query","my/models/Credentials","my/content/tabs/Videos","esri/config"],function(e,t,n,r,i,s,o,u,a){"use strict";var f={},l=function(e){e&&e.order&&p(e.order,e.firstRecordAsIntro)},c=function(e){var t=i18n.infographics.mapTour,n=[],r=-1;return!e||!e.order?n=[{title:t.firstTitle,value:window.engStrings.notApplicable,img:"icon-stories-sections"},{title:t.secondTitle,value:t.secondValueB,img:"icon-stories-tour-three-layout"},{title:t.thirdTitle,value:e?t.thirdValueLoading:i18n.infographics.mapTour.thirdValueUnknown,img:"icon-stories-marker"}]:(r=e.firstRecordAsIntro?e.order.length-1:e.order.length,n=[{title:t.firstTitle,value:r,img:"icon-stories-sections"},{title:t.secondTitle,value:e.layout==="integrated"?t.secondValueA:t.secondValueB,img:e.layout==="integrated"?"icon-stories-tour-integrated":"icon-stories-tour-three-layout"},{title:t.thirdTitle,value:t.thirdValueLoading,img:"icon-stories-marker"}]),n},h=function(e,r,i,s){var u={images:[],videos:[],webpages:[]},a={},f={},l={},c="",h={};for(var p=0;p<e.length;p++)a=e[p],c=a.attributes[r.fieldName]?t.cleanHtmlText(a.attributes[r.fieldName]):i18n.content.general.noTitle,f={id:a.attributes[r.fieldURL],title:c,pinNumber:k(i.order,a.attributes[r.fieldID],i.firstRecordAsIntro,a),isFeatureService:s,isThumbnail:!1},l={id:a.attributes[r.fieldThumb],title:c,pinNumber:k(i.order,a.attributes[r.fieldID],i.firstRecordAsIntro,a),isFeatureService:s,isThumbnail:!0},s&&(h=o.getCredentials()),f.pinNumber!==-1&&(d(u,f,a,i,r,s),d(u,l,a,i,r,s));return u.images=n.sortByPinNumber(u.images,i18n.content.info.introRecord),u.videos=n.sortByPinNumber(u.videos,i18n.content.info.introRecord),u.webpages=n.sortByPinNumber(u.webpages,i18n.content.info.introRecord),u},p=function(e,t){for(var n=0;n<e.length;n++)e[n].visible===!1&&(t?n!==0&&(e.splice(n,1),n--):(e.splice(n,1),n--));return e},d=function(e,t,n,r,i,s){var o=n.attributes[i.fieldIsVideo],u=n.attributes[i.fieldURL],a=o&&o.toString().toLowerCase()==="true",f=!1;t.isThumbnail?e.images.push(t):a?m(e,t,u):(f=v(u,r,s),f?e.images.push(t):m(e,t,u))},v=function(e,t,n){return e?e.indexOf("isVideo")!==-1?!1:/((\.jp(e)?g)|(.png)|(.gif)|(.bmp))$/i.test(e)||e.indexOf("isImage")>-1?!0:t.templateCreation==="2.1"?t.disableVideo||n:!0:!0},m=function(e,t,n){var r=g(n);r?e.videos.push(t):e.webpages.push(t)},g=function(e){var t=(new RegExp(u.youTubeRegex)).test(e),n=(new RegExp(u.vimeoRegex)).test(e);return t||n?!0:!1},y=function(n,r){var i=new e,s=null,o=null,u=null,a=null,f=!1,l="",c=r.fieldsOverride?r.fieldsOverride:null;T(c);for(var p=0;p<n.length;p++){a=n[p];if(a.featureCollection){l=r.sourceLayer.substring(0,r.sourceLayer.length-2);if(a.id===l){s=a.featureCollection.layers[0],f=!0;break}}else if(a.id===r.sourceLayer){s=a;break}}return s?f?(o=N(s.layerDefinition.fields),u=h(s.featureSet.features,o,r,!1),i.resolve(u)):s.id.substring(0,4).toLowerCase()==="csv_"?S(i,s,r):(s.url=t.unProtocolUrl(s.url),E(i,s,r)):(u=h([],{},r,!1),i.resolve(u)),i.promise},b=function(e,t){var n=window.setTimeout(function(){w(e,n,t)},app.cfg.TIMEOUT_MILLISECONDS);return n},w=function(e,t,n){window.clearTimeout(t);var r=h([],{},n,!0);e.resolve(r)},E=function(e,t,n){var i=new r(t.url),o=b(e,n),u=null,a=null,f=null;i.on("load",function(t){window.clearTimeout(o),f=N(t.layer.fields),x(t.layer.fields)?(u=new s,u.outFields=["*"],u.where="1=1",i.queryFeatures(u,function(t){a=h(t.features,f,n,!0),e.resolve(a)},function(){a=h([],f,n,!0),e.resolve(a)})):(a=h([],f,n,!0),e.resolve(a))}),i.on("error",function(){w(e,o,n)})},S=function(e,t,n){a.defaults.io.proxyUrl="/apps/proxy/sm-proxy.php";var r=new i(t.url),s=null,o=null,u=null;a.defaults.io.proxyUrl="//www.arcgis.com/sharing/proxy",r.on("load",function(t){x(t.layer.fields)&&(u=t.layer._csvFC.featureSet.features,s=N(t.layer.fields),o=h(u,s,n,!1),e.resolve(o))}),r.on("error",function(){o=h([],{},n,!1),e.resolve(o)})},x=function(e){return C(e,f.pic_url)!==""&&C(e,f.thumb_url)!==""},T=function(e){f={objectid:["__objectid","objectid","id","fid"],name:["name","title","name-short","name-long"],description:["description","caption","snippet","comment"],color:["icon_color","color","style"],pic_url:["pic_url","url","pic","picture"],thumb_url:["thumb_url","thumb","thumbnail"],is_video:["is_video","video","isVideo"]},e&&(f.objectid.join(e.fieldID),f.name.join(e.fieldName),f.description.join(e.fieldDescription),f.color.join(e.fieldIconColor),f.pic_url.join(e.fieldURL),f.thumb_url.join(e.fieldThumb),f.is_video.join(e.fieldIsVideo))},N=function(e){return{fieldID:C(e,f.objectid),fieldName:C(e,f.name),fieldDescription:C(e,f.description),fieldURL:C(e,f.pic_url),fieldThumb:C(e,f.thumb_url),fieldIconColor:C(e,f.color),fieldIsVideo:C(e,f.is_video)}},C=function(e,t){for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)if(e[r].name.toLowerCase().trim()===t[n].toLowerCase().trim())return e[r].name;return""},k=function(e,t,n,r){if(e){for(var i=0;i<e.length;i++)if(e[i].id===t)return n?i===0?i18n.content.info.introRecord:i:i+1;return-1}return r.attributes.objectid},L=function(){return i18n.content.component.mapTour},A=function(){return i18n.content.titleType.mapTour};return function(e){return l(e),{buildInfographics:c,getMedia:y,getStoryComponent:L,getTitleType:A}}}),define("my/content/scanning/StoryUI",["my/models/Credentials","my/helpers/UIHelper","my/content/Templater"],function(e,t,n){"use strict";var r=function(e,n,r){var o=t.getExpandedMaps();s(e.items,n,"maps",r);if(o.length>0)for(var u=0;u<o.length;u++)$('.item[data-id="'+n.storyMap.id+'"] .expandable-layer[data-map-id="'+o[u]+'"]').addClass("expanded");n.media.maps&&n.media.maps.items&&i(n)},i=function(e){var t='.item[data-id="'+e.id+'"]',n=null,r=null,i=null,s=null,o=null,u=null;for(var a=0;a<e.media.maps.items.length;a++){u=e.media.maps.items[a];for(var f=0;f<u.info.layers.length;f++)n=u.info.layers[f],n.info.isBasemap&&(n.info.persistentBasemap?r=n:i=n);r&&i&&(s=$(t+' .layer-row[data-id="'+r.id+'"]'),o=$(t+' .layer-row[data-id="'+i.id+'"]'),i.issues.length?(o.removeClass("no-show"),s.addClass("no-show")):(s.removeClass("no-show"),o.addClass("no-show")))}},s=function(n,r,i,s){var a={items:n,titleType:r.titleType,storyComponent:r.storyComponent};o(a,r.storyMap.id,i),t.updateTabStatusIcon(r.storyMap.id,r.media[i].type,r.media[i].allClear),t.updateStoryStatusIcon(s,r.allClear,r.storyMap.id),i==="maps"&&t.handleNoOrg(e.getCredentials()),u(i,r.id)},o=function(e,r,i){switch(i){case"maps":e.items.length===0?t.showMapsError(r):n.templatizeMaps(e,r);break;case"images":n.templatizeImages(e,r);break;case"videos":n.templatizeVideos(e,r);break;case"webpages":n.templatizeWebpages(e,r);break;default:}},u=function(e,t){var n='.item[data-id="'+t+'"]',r={};switch(e){case"maps":r=$(n+" .map-content-loader");break;case"images":r=$(n+" .image-content-loader");break;case"videos":r=$(n+" .video-content-loader");break;case"webpages":r=$(n+" .webpage-content-loader");break;default:return}r.css("display","none")},a=function(e,t){var n='.item[data-id="'+t+'"]';$(n+" .story-sharing").removeClass("active"),$(n+' .story-sharing[data-sharing="'+e+'"]').addClass("active"),$(n+" .access").html(e)};return{updateMapUI:r,updateMediaUI:s,hideContentLoader:u,updateStoryMapUI:a}}),define("my/helpers/AGOLSort",[],function(){"use strict";var e=function(e){var t=[],n=[],r=[];for(var i=0;i<e.items.length;i++)e.items[i].issues.length===0?r.push(e.items[i]):n.push(e.items[i]);for(var s=0;s<n.length;s++)t.push(n[s]);for(var o=0;o<r.length;o++)t.push(r[o]);return e.items=t,e},t=function(e){var t=n(e.items);return e.items=t,e},n=function(e){var t=[],r=[],i=[],s=[],o={};for(var u=0;u<e.length;u++)o=e[u],o.issues.length>0?o.inaccessible||o.deleted||o.notAuthorized?r.push(o):i.push(o):s.push(o),o.info.layers&&(o.info.layers=n(o.info.layers));for(var a=0;a<r.length;a++)t.push(r[a]);for(var f=0;f<i.length;f++)t.push(i[f]);for(var l=0;l<s.length;l++)t.push(s[l]);return t};return{sortByIssues:e,sortMapsByIssues:t}}),define("my/content/tabs/MapsSharing",["dojo/Deferred","esri/request","esri/arcgis/utils","my/models/Credentials"],function(e,t,n,r){"use strict";var i=function(r){var i=n.arcgisUrl.split("/items")[0],s=new e,o={organization:r.shareWith==="organization",everyone:r.shareWith==="public"},u={},a=i+"/users/"+r.username+"/shareItems";return u=t({url:a,content:{f:"json",items:[r.item],everyone:o.everyone,org:o.organization}},{usePost:!0}),u.then(function(e){var t=e.results[0],n={id:t.itemId,type:r.type};t.success?s.resolve(n):s.reject(t.error)},function(e){s.reject(e)}),s.promise},s=function(t,n,s,u){var a=r.getCredentials(),f=new e,l={},c={username:a.userName,item:n,type:s,shareWith:t},h={};return l=i(c),l.then(function(e){var n={id:e.id,storyData:u,shareWith:t,type:e.type},r=o(n);h={itemId:e.id,type:e.type,storyObj:r,newLevel:t},f.resolve(h)},function(e){f.reject(e)}),f.promise},o=function(e){var t=e.id,n=e.shareWith,r=null,i=[];if(e.type==="storyMap")e.storyData.storyMap.accessLevel=n;else if(e.type==="map"){i=e.storyData.media.maps.items;for(var s=0;s<i.length;s++)if(i[s].id===t){r=i[s],r.access=n;break}}else if(e.type==="layer"){i=e.storyData.media.maps.items;for(var o=0;o<i.length;o++){var u=i[o];for(var a=0;a<u.info.layers.length;a++)u.info.layers[a].id===t&&(u.info.layers[a].access=n)}}return e.storyData};return{updateItemSharing:s}}),define("my/content/scanning/StoryUpdate",["dojo/Deferred","my/content/tabs/MapsSharing"],function(e,t){"use strict";var n=function(){var e={storyMap:{},media:{},storyComponent:"",titleType:"",allClear:!0};return e},r=function(n,r,i,s){var o=new e,u=t.updateItemSharing(n,r,i,s);return u.then(function(e){o.resolve(e)},function(){o.reject()}),o.promise},i=function(e){e.allClear=!0;for(var t in e.media)e.media.hasOwnProperty(t)&&(e.media[t].allClear||(e.allClear=!1));e.storyMap.allClear=e.allClear},s=function(){};return{createStoryObj:n,updateMapObj:r,updateAllClear:i,buildNotificationUI:s}}),define("my/content/Builder",["dojo/promise/all","dojo/Deferred","esri/request","esri/arcgis/utils","my/models/Credentials","my/content/Templater","my/content/tabs/Maps","my/content/tabs/Images","my/content/tabs/Videos","my/content/tabs/Webpages","my/helpers/TabHelper","my/helpers/UIHelper","my/content/builders/MapJournalBuilder","my/content/builders/MapSeriesBuilder","my/content/builders/SwipeSpyglassBuilder","my/content/builders/MapTourBuilder","my/content/scanning/StoryUI","my/helpers/AGOLSort","my/content/scanning/StoryUpdate"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";var b=function(e,i){var s=new t,o=null;return i?w(s,e,i):(o=n({url:r.arcgisUrl+"/"+e.id+"/data",content:{f:"json"}}),o.then(function(t){w(s,e,t)},function(e){console.log("reason it failed: "+e),s.reject()})),s.promise},w=function(e,t,n){var r=n?n.values:null,i=E(t,r);i.then(function(t){e.resolve(t)})},E=function(e,n){var r=new t,i={},u=[],a={},f={},g={},b=!1,w=!1,E=!1;switch(e.storyMap.type){case"Map Journal":g=h(n);break;case"Map Series":g=p(n);break;case"Swipe/Spyglass":g=d();break;case"Map Tour":return g=v(n),e.storyComponent=g.getStoryComponent(),e.titleType=g.getTitleType(),i=g.buildInfographics(n),s.templatizeInfographics(i,e.id),!n||!n.webmap?u=[]:u=[{id:n.webmap}],e.media.maps=l.getTabObject(i18n.content.media.maps,"maps",!0),e.media.images=l.getTabObject(i18n.content.media.images,"images",!0),b=c.checkAlreadyHasContent(e.id),b===!1&&s.templatizeTabs(e,e.id),c.highlightImageTab(e),c.addMediaTabsEvents(e.id,null),a=o.buildMapsObj(u,e.media.maps),a.then(function(t){var i=i18n.infographics.mapTour.thirdValueUnknown,s=!1;t.items.length>0&&t.items[0].info.itemDetails.baseMap&&(i=t.items[0].info.itemDetails.baseMap.title),c.updateBasemapInfographic(e.id,i),e.media.maps=t,y.updateAllClear(e),m.updateMapUI(t,e,!1),n?n.sourceLayer||(s=!0):s=!0;if(s)r.resolve(e);else if(t.items){var o=t.items[0].info.itemDetails.operationalLayers,u=null;!o||o.length===0?r.resolve(e):(u=g.getMedia(o,n),u.then(function(t){x(r,t,e)}))}}),r.promise;default:return r.resolve(e),r.promise}return e.storyComponent=g.getStoryComponent(),e.titleType=g.getTitleType(),i=g.buildInfographics(n),s.templatizeInfographics(i,e.id),n?(w=S(n,"webmap"),E=w):E=!0,f=g.getMedia(n,E),x(r,f,e),r.promise},S=function(e,t){var n=0,r=!1;if(!e[t])return r=!1,r;for(var i in e)e.hasOwnProperty(i)&&n++;return n===1&&(r=!0),r},x=function(t,n,r){var i=[],h={},p={},d={},v={};n.maps&&n.maps.length>0&&(r.media.maps=l.getTabObject(i18n.content.media.maps,"maps",!0),h=o.buildMapsObj(n.maps,r.media.maps),i.push(h),h.then(function(e){var t=g.sortMapsByIssues(e);r.media.maps=t,y.updateAllClear(r),m.updateMapUI(t,r,!1),c.addToggleLayerEvents(r.id)})),n.images&&n.images.length>0&&(r.media.images=l.getTabObject(i18n.content.media.images,"images",!0),p=u.buildImagesObj(n.images.slice(0),r.media.images),i.push(p),p.then(function(e){var t=g.sortByIssues(e);r.media.images=t,y.updateAllClear(r),m.updateMediaUI(t.items,r,"images",!1)})),n.videos&&n.videos.length>0&&(r.media.videos=l.getTabObject(i18n.content.media.videos,"videos",!0),d=a.buildVideosObj(n.videos,r.media.videos),i.push(d),d.then(function(e){var t=g.sortByIssues(e);r.media.videos=t,y.updateAllClear(r),m.updateMediaUI(t.items,r,"videos",!1)})),n.webpages&&n.webpages.length>0&&(r.media.webpages=l.getTabObject(i18n.content.media.webpages,"webpages",!0),v=f.buildWebpagesObj(n.webpages,r.media.webpages),i.push(v),v.then(function(e){var t=g.sortByIssues(e);r.media.webpages=t,y.updateAllClear(r),m.updateMediaUI(t.items,r,"webpages",!1)})),(!r.media.maps||r.media.maps.length===0)&&(!n.images||n.images.length===0)&&(!n.videos||n.videos.length===0)&&(!n.webpages||n.webpages.length===0)&&(r.media.maps=l.getTabObject(i18n.content.media.maps,"maps",!0),y.updateAllClear(r),m.updateMapUI(r.media.maps,r,!1),c.addToggleLayerEvents(r.id)),s.templatizeTabs(r,r.id),c.highlightFirstOrActiveMedia(r.id),c.addMediaTabsEvents(r.id,null),e(i).then(function(){t.resolve(r)})};return{buildMedia:b}}),define("my/content/tabs/SubmitToGallery",["esri/request","my/models/Credentials","my/content/Templater","my/helpers/UIHelper"],function(e,t,n,r){"use strict";var i=function(e){var t=s(e);n.templatizeSubmitToGallery(t,e.id,e.nominatedToGallery),$('.item[data-id="'+e.id+'"] .gallery-loader').css("display","none"),o(e)},s=function(e){var t={hasOwnImage:e.hasOwnImage,hasCollectionTag:e.collectionTag?!0:!1,sharedPublicly:e.accessLevel==="public",noBrokenContent:e.allClear,allClear:!1};return t.allClear=t.hasOwnImage&&t.hasCollectionTag&&t.sharedPublicly&&t.noBrokenContent,t},o=function(n){var i='.item[data-id="'+n.id+'"]',s=$(i+" .submit-button"),o=$(i+" .subject-tags-link"),u=t.getCredentials(),a={name:u.portal.user.fullName,email:u.portal.user.email,appType:n.type,itemUrl:n.agolUrl};s.on("click",function(){var t={};if(s.hasClass("disabled")||s.hasClass("pressed")||s.hasClass("temp-disabled"))return;t=e({url:"/apps/feedback/api/",content:{fname:"/assets/js/formConfig.json",datablock:"DynamicSubmission",submitFieldName:"submit-submission",name:a.name,userEmail:a.email,appType:a.appType,url:a.itemUrl}},{usePost:!0}),r.disableFadeableButtons(n.id),t.then(function(){n.nominatedToGallery=!0,r.showSuccessSubmitButton(n.id),r.reEnableButtons(n.id)},function(){r.reEnableButtons(n.id),r.showErrorSubmitButton(n.id)})}),o.on("click",function(){r.unHighlightMediaTab(n.id),r.highlightMediaTab(n.id,"tags")})};return{updateCriteria:i}}),define("my/content/scanning/StoryIssues",["my/models/Issue"],function(e){"use strict";var t=[],n=function(){var t=e.getPossibleIssues(),n=[{title:t.deleted,media:"maps",severity:"error",text:i18n.content.scanningErrors.deletedMap,subtext:i18n.content.scanningErrorTips.deletedMapTip,actions:[]},{title:t.inaccessible,media:"maps",severity:"error",text:i18n.content.scanningErrors.inaccessibleMap,subtext:i18n.content.scanningErrorTips.inaccessibleMapTip,actions:[]},{title:t.notYoursNotAccessible,media:"maps",severity:"error",text:i18n.content.scanningErrors.notYoursNotAccessible,subtext:i18n.content.scanningErrorTips.notYoursNotAccessibleTip,actions:[]},{title:t.serviceOkItemNot,media:"maps",severity:"error",text:i18n.content.scanningErrors.serviceOkItemNot,subtext:i18n.content.scanningErrorTips.serviceOkItemNotTip,actions:[{text:i18n.content.scanningErrorTips.ignore,positive:!1,isLink:!1,url:"",action:"ignore",modalName:""},{text:i18n.content.scanningErrorTips.fix,positive:!0,isLink:!1,url:"",action:"fix",modalName:"remove-layer"}]},{title:t.secureService,media:"maps",severity:"error",text:i18n.content.scanningErrors.secureService,subtext:i18n.content.scanningErrorTips.secureServiceTip,actions:[]},{title:t.premiumContent,media:"maps",severity:"error",text:i18n.content.scanningErrors.premiumContent,subtext:i18n.content.scanningErrorTips.premiumContentTip,actions:[{text:i18n.content.scanningErrorTips.makePublic,positive:!0,isLink:!1,url:"",action:"",modalName:""}]},{title:t.subscriptionContent,media:"maps",severity:"error",text:i18n.content.scanningErrors.subscriptionContent,subtext:i18n.content.scanningErrorTips.subscriptionContentTip,actions:[{text:i18n.content.scanningErrorTips.confirm,positive:!0,isLink:!1,url:"",action:"",modalName:""}]},{title:t.othersSharedBelowLevel,media:"maps",severity:"warning",text:i18n.content.scanningErrors.othersSharedBelowLevel,subtext:"",actions:[]},{title:t.inaccessibleImage,media:"images",severity:"error",text:i18n.content.scanningErrors.inaccessibleImage,subtext:i18n.content.scanningErrorTips.inaccessibleImageTip,actions:[]},{title:t.inaccessibleVideo,media:"videos",severity:"error",text:i18n.content.scanningErrors.inaccessibleVideo,subtext:i18n.content.scanningErrorTips.inaccessibleVideoTip,actions:[]},{title:t.inaccessibleWebpage,media:"webpages",severity:"error",text:i18n.content.scanningErrors.inaccessibleWebpage,subtext:i18n.content.scanningErrorTips.inaccessibleWebpageTip,actions:[]},{title:t.yoursSharedBelowLevel,media:"maps",severity:"warning",text:"",subtext:"",actions:[{text:"",positive:!0,isLink:!1,url:"",action:"",modalName:""}]}];r(n)},r=function(e){t=e},i=function(){return t},s=function(e){var t=h(),n={},r={},i={};for(n in e)if(e.hasOwnProperty(n))for(var s=0;s<e[n].items.length;s++){r=e[n].items[s];for(var o=0;o<r.issues.length;o++)i=r.issues[o],t[i.issueType].items.push(i)}return t},o=function(t,n){var r=e.getPossibleIssues(),i=t.issues[r.yoursSharedBelowLevel],s=t.issues[r.othersSharedBelowLevel],o=t.issues[r.secureService],l=t.issues[r.premiumContent],c=[],h={},p=[];i.items.length>0&&u(i,n);if(s.items.length>0){p=t.media.maps.items;for(var d=0;d<s.items.length;d++)h=s.items[d],f(p,c,h.id);a(s,c)}if(o.items.length>0){var v='<a href="http://blogs.esri.com/esri/arcgis/2014/10/07/public-access-to-arcgis-online-premium-services/" class="linkable-text" target="_blank">'+i18n.content.scanningErrorTips.blogArticle+"</a>";o.subtext=i18n.content.scanningErrorTips.secureServiceTip.replace(/{{HERE}}/g,v)}if(l.items.length>0){var m='<a href="http://www.esri.com/software/arcgis/arcgisonline/credits" class="linkable-text" target="_blank">'+i18n.content.scanningErrorTips.credits+"</a>";t.storyMap.accessLevel==="public"?(l.subtext=i18n.content.scanningErrorTips.premiumContentPublicTip.replace(/{{CREDITS}}/g,m),l.actions[0].text=i18n.content.scanningErrorTips.confirm):(l.subtext=i18n.content.scanningErrorTips.premiumContentTip.replace(/{{CREDITS}}/g,m),l.actions[0].text=i18n.content.scanningErrorTips.makePublic)}},u=function(e,t){var n=i18n.content.scanningErrors,r=i18n.content.scanningErrorTips,i=" ",s=" ",o="";t==="public"?(i=n.someContentNotPublic,o=r.sharePublicly,s=r.clickToSharePublic):t==="organization"&&(i=n.someContentPrivate,o=r.shareOrg,s=r.clickToShareOrg),e.text=i,e.subtext=s,e.actions[0].text=o},a=function(e,t){var n=t[0]||"",r="https://geonet.esri.com/people?query="+n,i='<a href="'+r+'" target="_blank">'+n+"</a>",s=i18n.content.scanningErrorTips.othersSharedBelowLevelTip.replace(/{{USER_NAME}}/g,i);e.subtext=s},f=function(e,t,n){var r={};for(var i=0;i<e.length;i++)r=e[i],r.id===n?t.indexOf(r.owner)===-1&&t.push(r.owner):l(r.info.layers,t,n)},l=function(e,t,n){var r={};for(var i=0;i<e.length;i++)r=e[i],r.id===n&&t.indexOf(r.owner)===-1&&t.push(r.owner)},c=function(e,t){var n=[],r=i();for(var s=0;s<r.length;s++)t?n.push(e[r[s].title]):r[s].title!=="yoursSharedBelowLevel"&&n.push(e[r[s].title]);return n},h=function(){var e={},t=i();for(var n=0;n<t.length;n++)e[t[n].title]=p(t[n].title,t[n].media,t[n].severity,t[n].text,t[n].subtext,t[n].actions);return e},p=function(e,t,n,r,i,s){var o={media:t,title:e,severity:n,text:r,subtext:i,actions:s,items:[]};return o};return function(){return n(),{compileMediaIssues:s,customizeIssueObj:o,issueObjToList:c}}}),define("my/content/tabs/Tags",["dojo/Deferred","esri/request","esri/arcgis/utils","my/helpers/UIHelper"],function(e,t,n,r){"use strict";var i="li.expanded",s=function(e){var t=[],n="",r=i18n.collectionList,i=!1,s="";for(var o=0;o<e.allTags.length;o++){s=e.allTags[o];if(n)t.push(s);else{i=!1;for(var u=0;u<r.length;u++)s===r[u]&&(i=!0,n=s);i===!1&&t.push(s)}}e.yourTags=t,e.collectionTag=n},o=function(e){var t=$(i+" .collection-tags");e&&t.val(e)},u=function(e,t){t.collectionTag=e,$(i+" .item-update-tags").removeClass("disabled")},a=function(e,t){var n="",r=[],s=i18n.collectionList;n=e.text(),n=$.trim(n),n.charAt(n.length-1)===","&&(n=n.substr(0,n.length-1),n=$.trim(n)),r=n.split(", ");if($(i+" .collection-tags").val()==="")for(var a=0;a<r.length;a++)for(var f=0;f<s.length;f++)r[a]===s[f]&&(u(r[a],t),o(r[a]));t.yourTags=r,$(i+" .item-update-tags").removeClass("disabled")},f=function(e){var t=[];return $.each(e,function(e,n){$.inArray(n,t)===-1&&t.push(n)}),t},l=function(i){i.item.allTags=i.item.yourTags.concat(i.item.collectionTag),i.item.allTags=f(i.item.allTags);var s=new e,o=n.arcgisUrl.split("/items")[0],u=o+"/users/"+i.userName+"/items/"+i.item.id+"/update",a=i.item.userItemUrl+"/update",l=i.item.userItemUrl?a:u,p=i.item.allTags.toString(),d=t({url:l,content:{f:"json",tags:p}},{usePost:!0});return d.then(function(){r.reEnableButtons(i.item.id),c(),s.resolve(i.item)},function(){r.reEnableButtons(i.item.id),h(),s.reject()}),s.promise},c=function(){var e=$(i+" .item-update-tags");e.html(i18n.storyMap.tags.saved),e.addClass("success-button"),e.addClass("notify"),setTimeout(function(){e.html(i18n.storyMap.tags.save),e.removeClass("notify"),e.removeClass("success-button")},2e3)},h=function(){var e=$(i+" .item-update-tags");e.html(i18n.storyMap.tags.errorSaving),e.addClass("error-button"),e.addClass("notify"),setTimeout(function(){e.removeClass("error-button"),e.html(i18n.storyMap.tags.save),e.removeClass("notify")},2e3)};return{init:s,showCollectionTag:o,updateCollectionTag:u,updateYourTags:a,saveTagsToServer:l}}),define("my/content/scanning/PremiumManager",["dojo/on","dojo/Deferred","my/helpers/Formatter","esri/arcgis/AppProxyManager","esri/dijit/AppProxySettings"],function(e,t,n,r,i){"use strict";return function(e){var s=e,o=null,u=null,a=function(e,t){var s=/(.*\/)/.exec(t),a=s?s[0]:"",f=n.unProtocolUrl(a),l="http:"+f,c="https:"+f;o=new r({appid:e,referrers:[l,c]}),u=new i({proxyManagerOptions:{appid:e},webmaps:[]},null)},f=function(){return o.proxies},l=function(e){var n=new t,r=p(e);return r.then(function(t){e.isSubscriptionContent=t.subscriptionContent,e.isPremiumContent=t.premiumContent,e.isPremiumContent||e.isSubscriptionContent?(e.hasProxy=h(e),n.resolve(e)):n.resolve(e)},function(){n.resolve(e)}),n.promise},c=function(e){var n=new t,r=[],i=null,s=null;for(var u=0;u<e.length;u++)i={sourceUrl:e[u].info.originalUrl},r.push(i);return s=o.createProxies(r),s.then(function(){console.log("proxies"),console.log(o.proxies);for(var t=0;t<e.length;t++)e[t].hasProxy=!0;n.resolve(e)},function(){n.reject(e)}),n.promise},h=function(e){var t=null;for(var r=0;r<o.proxies.length;r++){t=o.proxies[r];if(e.url===n.unProtocolUrl(t.sourceUrl))return!0;if(n.unProtocolUrl(e.info.originalUrl)===n.unProtocolUrl(t.sourceUrl))return!0}return!1},p=function(e){var n=new t;return o.loaded?d(e,n):(o.on("load",function(){d(e,n)}),o.on("error",function(){n.reject()})),n.promise},d=function(e,t){var n=u._isPremium(e.info.originalUrl),r=u._consumesCredits(e.info.originalUrl);r&&(n=!1),t.resolve({premiumContent:r,subscriptionContent:n})},v=function(){o.deleteProxies(o.proxies).then(function(){console.log("success"),console.log(o.proxies)},function(){console.log("failure")})};return a(s.id,s.url),{checkSecureService:l,addProxies:c,deleteProxies:v,getProxies:f}}});var initCropit=function(e){var t;t=function(){function e(){}return e.prototype.setup=function(e,t,n,r){var i,s;return n==null&&(n=1),s=t.w/e.w,i=t.h/e.h,(r!=null?r.minZoom:void 0)==="fit"?this.minZoom=s<i?s:i:this.minZoom=s<i?i:s,this.maxZoom=this.minZoom<1/n?1/n:this.minZoom},e.prototype.getZoom=function(e){return!this.minZoom||!this.maxZoom?null:e*(this.maxZoom-this.minZoom)+this.minZoom},e.prototype.getSliderPos=function(e){return!this.minZoom||!this.maxZoom?null:this.minZoom===this.maxZoom?0:(e-this.minZoom)/(this.maxZoom-this.minZoom)},e.prototype.isZoomable=function(){return!this.minZoom||!this.maxZoom?null:this.minZoom!==this.maxZoom},e.prototype.fixZoom=function(e){return e<this.minZoom?this.minZoom:e>this.maxZoom?this.maxZoom:e},e}();var n;n=function(){function n(t,r){var i;this.element=t,this.$el=e(this.element),i={$fileInput:this.$("input.cropit-image-input"),$preview:this.$(".cropit-image-preview"),$dragZone:this.$(".cropit-drag-zone"),$zoomSlider:this.$("input.cropit-image-zoom-input"),$previewContainer:this.$(".cropit-image-preview-container")},this.options=e.extend({},n._DEFAULTS,i,r),this.init()}return n._DEFAULTS={exportZoom:1,imageBackground:!1,imageBackgroundBorderWidth:0,imageState:null,allowCrossOrigin:!1,allowDragNDrop:!0,freeMove:!1,minZoom:"fill"},n.PREVIEW_EVENTS=function(){return["mousedown","mouseup","mouseleave","touchstart","touchend","touchcancel","touchleave"].map(function(e){return""+e+".cropit"}).join(" ")}(),n.PREVIEW_MOVE_EVENTS="mousemove.cropit touchmove.cropit",n.ZOOM_INPUT_EVENTS=function(){return["mousemove","touchmove","change"].map(function(e){return""+e+".cropit"}).join(" ")}(),n.prototype.init=function(){var n,r,i,s;return this.image=new Image,this.options.allowCrossOrigin&&(this.image.crossOrigin="Anonymous"),this.$fileInput=this.options.$fileInput,this.$preview=this.options.$preview.css({backgroundRepeat:"no-repeat"}),this.$dragZone=this.options.$dragZone,this.$zoomSlider=this.options.$zoomSlider.attr({min:0,max:1,step:.01}),this.previewSize={w:this.options.width||this.$preview.width(),h:this.options.height||this.$preview.height()},this.options.width&&this.$preview.width(this.previewSize.w),this.options.height&&this.$preview.height(this.previewSize.h),this.options.imageBackground&&(e.isArray(this.options.imageBackgroundBorderWidth)?this.imageBgBorderWidthArray=this.options.imageBackgroundBorderWidth:(this.imageBgBorderWidthArray=[],[0,1,2,3].forEach(function(e){return function(t){return e.imageBgBorderWidthArray[t]=e.options.imageBackgroundBorderWidth}}(this))),n=this.options.$previewContainer,this.$imageBg=e("<img />").addClass("cropit-image-background").attr("alt","").css("position","absolute"),this.$imageBgContainer=e("<div />").addClass("cropit-image-background-container").css({position:"absolute",zIndex:0,left:-this.imageBgBorderWidthArray[3]+window.parseInt(this.$preview.css("border-left-width")),top:-this.imageBgBorderWidthArray[0]+window.parseInt(this.$preview.css("border-top-width")),width:this.previewSize.w+this.imageBgBorderWidthArray[1]+this.imageBgBorderWidthArray[3],height:this.previewSize.h+this.imageBgBorderWidthArray[0]+this.imageBgBorderWidthArray[2]}).append(this.$imageBg),this.imageBgBorderWidthArray[0]>0&&this.$imageBgContainer.css({overflow:"hidden"}),n.css("position","relative").prepend(this.$imageBgContainer),this.$preview.css("position","relative"),this.$preview.hover(function(e){return function(){return e.$imageBg.addClass("cropit-preview-hovered")}}(this),function(e){return function(){return e.$imageBg.removeClass("cropit-preview-hovered")}}(this))),this.initialOffset={x:0,y:0},this.initialZoom=0,this.initialZoomSliderPos=0,this.imageLoaded=!1,this.moveContinue=!1,this.zoomer=new t,this.options.allowDragNDrop&&jQuery.event.props.push("dataTransfer"),this.bindListeners(),this.$zoomSlider.val(this.initialZoomSliderPos),this.setOffset(((r=this.options.imageState)!=null?r.offset:void 0)||this.initialOffset),this.zoom=((i=this.options.imageState)!=null?i.zoom:void 0)||this.initialZoom,this.loadImage(((s=this.options.imageState)!=null?s.src:void 0)||null)},n.prototype.bindListeners=function(){this.$fileInput.on("change.cropit",this.onFileChange.bind(this)),this.$preview.on(n.PREVIEW_EVENTS,this.onPreviewEvent.bind(this)),this.$zoomSlider.on(n.ZOOM_INPUT_EVENTS,this.onZoomSliderChange.bind(this));if(this.options.allowDragNDrop)return this.$dragZone.on("dragover.cropit dragleave.cropit",this.onDragOver.bind(this)),this.$dragZone.on("drop.cropit",this.onDrop.bind(this)),this.$preview},n.prototype.unbindListeners=function(){return this.$fileInput.off("change.cropit"),this.$preview.off(n.PREVIEW_EVENTS),this.$preview.off("dragover.cropit dragleave.cropit drop.cropit"),this.$zoomSlider.off(n.ZOOM_INPUT_EVENTS)},n.prototype.reset=function(){return this.zoom=this.initialZoom,this.offset=this.initialOffset},n.prototype.onFileChange=function(){var e;return typeof (e=this.options).onFileChange=="function"&&e.onFileChange(),this.$preview.removeClass("dragged"),this.$preview.addClass("file-picked"),this.$preview.removeClass("carousel"),this.loadFileReader(this.$fileInput.get(0).files[0])},n.prototype.loadFileReader=function(e){var t;t=new FileReader;if(e!=null?e.type.match("image"):void 0)return this.setImageLoadingClass(),t.readAsDataURL(e),t.onload=this.onFileReaderLoaded.bind(this),t.onerror=this.onFileReaderError.bind(this);if(e!=null)return this.onFileReaderError()},n.prototype.onFileReaderLoaded=function(e){return this.reset(),this.image.crossOrigin=null,this.loadImage(e.target.result)},n.prototype.onFileReaderError=function(){var e;return typeof (e=this.options).onFileReaderError=="function"?e.onFileReaderError():void 0},n.prototype.onDragOver=function(e){return e.preventDefault(),e.dataTransfer.dropEffect="copy",this.$preview.toggleClass("cropit-drag-hovered",e.type==="dragover")},n.prototype.onDrop=function(e){var t;return e.preventDefault(),e.stopPropagation(),t=Array.prototype.slice.call(e.dataTransfer.files,0),t.some(function(e){return function(t){if(t.type.match("image"))return e.loadFileReader(t),!0}}(this)),this.$preview.addClass("dragged"),this.$preview.removeClass("file-picked"),this.$preview.removeClass("carousel"),this.$preview.removeClass("cropit-drag-hovered")},n.prototype.loadImage=function(e){var t;this.imageSrc=e;if(!this.imageSrc)return;return typeof (t=this.options).onImageLoading=="function"&&t.onImageLoading(),this.setImageLoadingClass(),this.image.onload=this.onImageLoaded.bind(this),this.image.onerror=this.onImageError.bind(this),this.image.src=this.imageSrc},n.prototype.onImageLoaded=function(e){var t;return this.setImageLoadedClass(),this.setOffset(this.offset),this.$preview.css("background-image","url("+this.imageSrc+")"),this.options.imageBackground&&this.$imageBg.attr("src",this.imageSrc),this.imageSize={w:this.image.width,h:this.image.height},this.setupZoomer(),this.imageLoaded=!0,typeof (t=this.options).onImageLoaded=="function"?t.onImageLoaded(e,this.image):void 0},n.prototype.onImageError=function(e){var t;return typeof (t=this.options).onImageError=="function"?t.onImageError(e,this.image):void 0},n.prototype.setImageLoadingClass=function(){return this.$preview.removeClass("cropit-image-loaded").addClass("cropit-image-loading")},n.prototype.setImageLoadedClass=function(){return this.$preview.removeClass("cropit-image-loading").addClass("cropit-image-loaded")},n.prototype.getEventPosition=function(e){var t,n,r,i;if((t=e.originalEvent)!=null?(n=t.touches)!=null?n[0]:void 0:void 0)e=(r=e.originalEvent)!=null?(i=r.touches)!=null?i[0]:void 0:void 0;if(e.clientX&&e.clientY)return{x:e.clientX,y:e.clientY}},n.prototype.onPreviewEvent=function(t){if(!this.imageLoaded)return;return this.moveContinue=!1,this.$preview.off(n.PREVIEW_MOVE_EVENTS),t.type==="mousedown"||t.type==="touchstart"?(this.origin=this.getEventPosition(t),this.moveContinue=!0,this.$preview.on(n.PREVIEW_MOVE_EVENTS,this.onMove.bind(this))):e(document.body).focus(),t.stopPropagation(),!1},n.prototype.onMove=function(e){var t;return t=this.getEventPosition(e),this.moveContinue&&t&&this.setOffset({x:this.offset.x+t.x-this.origin.x,y:this.offset.y+t.y-this.origin.y}),this.origin=t,e.stopPropagation(),!1},n.prototype.setOffset=function(e){this.offset=this.fixOffset(e),this.$preview.css("background-position",""+this.offset.x+"px "+this.offset.y+"px");if(this.options.imageBackground)return this.$imageBg.css({left:this.offset.x+this.imageBgBorderWidthArray[3],top:this.offset.y+this.imageBgBorderWidthArray[0]})},n.prototype.fixOffset=function(e){var t;return this.imageLoaded?(t={x:e.x,y:e.y},this.options.freeMove||(this.imageSize.w*this.zoom>=this.previewSize.w?t.x=Math.min(0,Math.max(t.x,this.previewSize.w-this.imageSize.w*this.zoom)):t.x=Math.max(0,Math.min(t.x,this.previewSize.w-this.imageSize.w*this.zoom)),this.imageSize.h*this.zoom>=this.previewSize.h?t.y=Math.min(0,Math.max(t.y,this.previewSize.h-this.imageSize.h*this.zoom)):t.y=Math.max(0,Math.min(t.y,this.previewSize.h-this.imageSize.h*this.zoom))),t.x=this.round(t.x),t.y=this.round(t.y),t):e},n.prototype.onZoomSliderChange=function(){var e;if(!this.imageLoaded)return;return this.zoomSliderPos=Number(this.$zoomSlider.val()),e=this.zoomer.getZoom(this.zoomSliderPos),this.setZoom(e)},n.prototype.enableZoomSlider=function(){var e;return this.$zoomSlider.removeAttr("disabled"),typeof (e=this.options).onZoomEnabled=="function"?e.onZoomEnabled():void 0},n.prototype.disableZoomSlider=function(){var e;return this.$zoomSlider.attr("disabled",!0),typeof (e=this.options).onZoomDisabled=="function"?e.onZoomDisabled():void 0},n.prototype.setupZoomer=function(){return this.zoomer.setup(this.imageSize,this.previewSize,this.options.exportZoom,this.options),this.zoom=this.fixZoom(this.zoom),this.setZoom(this.zoom),this.isZoomable()?this.enableZoomSlider():this.disableZoomSlider()},n.prototype.setZoom=function(e){var t,n,r,i,s;e=this.fixZoom(e),s=this.round(this.imageSize.w*e),i=this.round(this.imageSize.h*e),r=this.zoom,t=this.previewSize.w/2-(this.previewSize.w/2-this.offset.x)*e/r,n=this.previewSize.h/2-(this.previewSize.h/2-this.offset.y)*e/r,this.zoom=e,this.setOffset({x:t,y:n}),this.zoomSliderPos=this.zoomer.getSliderPos(this.zoom),this.$zoomSlider.val(this.zoomSliderPos),this.$preview.css("background-size",""+s+"px "+i+"px");if(this.options.imageBackground)return this.$imageBg.css({width:s,height:i})},n.prototype.fixZoom=function(e){return this.zoomer.fixZoom(e)},n.prototype.isZoomable=function(){return this.zoomer.isZoomable()},n.prototype.getCroppedImageData=function(t){var n,r,i,s,o;return this.imageSrc?(s={type:"image/png",quality:.75,originalSize:!1,fillBg:"#fff"},t=e.extend({},s,t),i={w:this.previewSize.w,h:this.previewSize.h},o=t.originalSize?1/this.zoom:this.options.exportZoom,n=e("<canvas />").attr({width:i.w*o,height:i.h*o}).get(0),r=n.getContext("2d"),t.type==="image/jpeg"&&(r.fillStyle=t.fillBg,r.fillRect(0,0,n.width,n.height)),r.drawImage(this.image,this.offset.x*o,this.offset.y*o,this.zoom*o*this.imageSize.w,this.zoom*o*this.imageSize.h),n.toDataURL(t.type,t.quality)):null},n.prototype.getImageState=function(){return{src:this.imageSrc,offset:this.offset,zoom:this.zoom}},n.prototype.getImageSrc=function(){return this.imageSrc},n.prototype.getOffset=function(){return this.offset},n.prototype.getZoom=function(){return this.zoom},n.prototype.getImageSize=function(){return this.imageSize?{width:this.imageSize.w,height:this.imageSize.h}:null},n.prototype.getPreviewSize=function(){return{width:this.previewSize.w,height:this.previewSize.h}},n.prototype.setPreviewSize=function(e){if(!((e!=null?e.width:void 0)>0&&(e!=null?e.height:void 0)>0))return;this.previewSize={w:e.width,h:e.height},this.$preview.css({width:this.previewSize.w,height:this.previewSize.h}),this.options.imageBackground&&this.$imageBgContainer.css({width:this.previewSize.w+this.imageBgBorderWidthArray[1]+this.imageBgBorderWidthArray[3],height:this.previewSize.h+this.imageBgBorderWidthArray[0]+this.imageBgBorderWidthArray[2]});if(this.imageLoaded)return this.setupZoomer()},n.prototype.disable=function(){return this.unbindListeners(),this.disableZoomSlider(),this.$el.addClass("cropit-disabled")},n.prototype.reenable=function(){return this.bindListeners(),this.enableZoomSlider(),this.$el.removeClass("cropit-disabled")},n.prototype.round=function(e){return+(Math.round(e*100)+"e-2")},n.prototype.$=function(e){return this.$el?this.$el.find(e):null},n}();var r,i;r="cropit",i={init:function(t){return this.each(function(){var i;if(!e.data(this,r))return i=new n(this,t),e.data(this,r,i)})},destroy:function(){return this.each(function(){return e.removeData(this,r)})},isZoomable:function(){var e;return e=this.first().data(r),e!=null?e.isZoomable():void 0},"export":function(e){var t;return t=this.first().data(r),t!=null?t.getCroppedImageData(e):void 0},imageState:function(){var e;return e=this.first().data(r),e!=null?e.getImageState():void 0},imageSrc:function(t){var n;return t!=null?this.each(function(){var n;return n=e.data(this,r),n!=null&&(n.reset(),n.options.allowCrossOrigin&&(n.image.crossOrigin="Anonymous")),n!=null?n.loadImage(t):void 0}):(n=this.first().data(r),n!=null?n.getImageSrc():void 0)},offset:function(t){var n;return t!=null&&t.x!=null&&t.y!=null?this.each(function(){var n;return n=e.data(this,r),n!=null?n.setOffset(t):void 0}):(n=this.first().data(r),n!=null?n.getOffset():void 0)},zoom:function(t){var n;return t!=null?this.each(function(){var n;return n=e.data(this,r),n!=null?n.setZoom(t):void 0}):(n=this.first().data(r),n!=null?n.getZoom():void 0)},imageSize:function(){var e;return e=this.first().data(r),e!=null?e.getImageSize():void 0},previewSize:function(t){var n;return t!=null?this.each(function(){var n;return n=e.data(this,r),n!=null?n.setPreviewSize(t):void 0}):(n=this.first().data(r),n!=null?n.getPreviewSize():void 0)},disable:function(){return this.each(function(){var t;return t=e.data(this,r),t.disable()})},reenable:function(){return this.each(function(){var t;return t=e.data(this,r),t.reenable()})}},e.fn.cropit=function(e){return i[e]?i[e].apply(this,[].slice.call(arguments,1)):i.init.apply(this,arguments)}};window.initCropit=initCropit,define("lib-app/jquery.cropit",function(){}),define("my/content/dialogs/ImagePicker",["dojo/Deferred","dojo/promise/all","esri/request","esri/arcgis/utils","my/models/Credentials","my/helpers/UIHelper","lib-app/jquery.cropit"],function(e,t,n,r,i,s){"use strict";var o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null,d=null,v=null,m=0,g=!1,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=!1,O="",M=function(e,t,n,r,i,s,u,m,A,M,D,H){o=e,a=t,f=n,l=r,c=i,h=s,p=u,d=m,v=A,y=$("#choose-panel"),b=$("#upload-panel"),w=$("#crop-panel"),E=$("#upload-image"),S=$(".close-dialog.picker"),x=$("#choose-image"),T=$(".cropit-image-input"),N=$(".save-image:not(.disabled)"),C=$(".back.upload.btn"),k=$(".back.crop.btn"),L=M,R(),U(),l.hide(),p.hide(),d.hide(),v.hide(),h.show(),ft(),tt(),nt(),g=!0;if(D){$(".image-carousel").hide(),$("#or-upload").hide(),$("#not-supported-picker-text").html(i18n.storyMap.imagePicker.notInIEVersion.replace(/{{VERSION_NUMBER}}/g,H)),$("#picker-not-supported").show();return}$("#picker-not-supported").hide(),$("#image-cropper").cropit({allowDragNDrop:!0,imageBackground:!0,imageBackgroundBorderWidth:85,allowCrossOrigin:!0,onImageLoading:function(){$("#drag-drop-inside").css("display","none"),$("#drag-drop-loading").css("display","inline-block")},onImageLoaded:function(e,t){O="",$("#image-picker-image-form")[0].reset();var n=/^(data:)/g.test(t.src);n?P(!1):$.ajax(t.src,{success:function(){P(!1)},error:function(){_(t.src)}})},onImageError:function(e,t){var n=/^(data:)/g.test(t.src);n?(O="",console.log("image error"),B(),Q(),bt()):_(t.src)},onFileReaderError:function(){console.log("file reader error"),B(),Q(),bt()}})},_=function(e){var t=$("#uncropped-image")[0];t.onload=function(){D(t)},t.onerror=function(){O="",console.log("image error"),B(),Q(),bt()},t.src=e},D=function(e){var t={width:e.naturalWidth,height:e.naturalHeight};O=e.src,P(!0,t)},P=function(e,t){B(),Q();var n=$(".cropit-image-preview").hasClass("file-picked"),r=$(".cropit-image-preview").hasClass("dragged"),i=$(".cropit-image-preview").hasClass("carousel"),s=j(n,r,i),o=!1;if(s){o=F(n,r,i,t);if(o){var u=0,a=0,f=286,l=190,c=null,h=!1;e?(u=t.width,a=t.height):(c=$("#image-cropper").cropit("imageSize"),u=c.width,a=c.height),h=u===f&&a===l,h?W(!0,!0):e?W(!0,!1):(H(),W())}}},H=function(){var e=$(".cropit-image-background"),t={height:e.height(),width:e.width()},n=$("#image-cropper").cropit("previewSize"),r={x:0,y:0};r.x=(t.width-n.width)/-2,r.y=(t.height-n.height)/-2,$("#image-cropper").cropit("offset",r)},B=function(){$("#drag-drop-loading").css("display","none"),$("#drag-drop-inside").css("display","inline-block")},j=function(e,t,n){var r=$("#image-cropper").cropit("imageSrc"),i=!1,s=!1,o=!1;if(e||t){i=/(image\/gif|image\/jpeg|image\/png)(?=;)/gi.test(r);if(!i)return e?bt():t&&wt(),!1}else if(n){s=/\/rest\/services\/(.*?)\/FeatureServer/gi.test(r);if(!s){o=/(.jpg|.png|.gif)/gi.test(r);if(!o)return gt(),!1}}return Et(),St(),yt(),!0},F=function(e,t,n,r){var i=$("#image-cropper").cropit("imageSize"),s=r?lt(r.width,r.height):lt(i.width,i.height);return s?(e||t?k.removeClass("from-carousel"):n&&k.addClass("from-carousel"),ht(),dt(),mt(),!0):(e?pt():t?vt():n&&ct(),!1)},I=function(e){var t=$("#no-crop-warning");A=!0,e?($(".cropit-image-preview-container").show(),$("#uncropped-image").hide(),t.hide()):($(".cropit-image-preview-container").hide(),$("#uncropped-image").show(),t.show()),$(".dialog-title.crop").html(i18n.storyMap.imagePicker.saveImage),$("#range-container").hide()},q=function(e){A=!1,$(".cropit-image-preview-container").show(),$("#uncropped-image").hide(),$("#no-crop-warning").hide(),e?$(".dialog-title.crop").html(i18n.storyMap.imagePicker.cropImage):$(".dialog-title.crop").html(i18n.storyMap.imagePicker.saveImage),$("#range-container").show()},R=function(){$("#modal-container-image-picker").on("click",function(e){e.currentTarget===e.target&&st()}),a.on("click",function(){Z()}),f.on("click",function(){et()}),E.on("click",function(){ht(),yt(),z()}),x.on("click",function(){dt(),mt(),Et(),St(),T.click()}),N.on("click",function(){xt()}),S.on("click",function(){st()}),C.on("click",function(){U()}),k.on("click",function(){ft(),q(!0),$(this).hasClass("from-carousel")?(k.removeClass("from-carousel"),U()):z()})},U=function(){dt(),mt(),Et(),St(),y.show(),b.hide(),w.hide()},z=function(){y.hide(),b.show(),w.hide()},W=function(e,t){(e||t)&&I(t),y.hide(),b.hide(),w.show()},X=function(){a.off("click"),f.off("click"),E.off("click"),S.off("click"),x.off("click"),c.off("click"),N.off("click"),C.off("click"),k.off("click")},V=function(e){u=e,J()},J=function(){h.hide(),u&&u.length>0?(p.hide(),d.hide(),l.show(),m=0,G(0),c.on("click",function(){var e=c.attr("src");$("#image-cropper").cropit("imageSrc",e),K(),$(".cropit-image-preview").addClass("carousel"),$(".cropit-image-preview").removeClass("file-picked"),$(".cropit-image-preview").removeClass("dragged")})):u&&u.length===0?(l.hide(),d.hide(),p.show(),tt(),nt(),$("#modal-image-picker .carousel-page-status").css("opacity",0)):u||(d.show(),l.hide(),p.hide(),tt(),nt(),$("#modal-image-picker .carousel-page-status").css("opacity",0))},K=function(){$("#carousel-image").css("display","none"),$("#carousel-image-loading").css("display","inline-block")},Q=function(){$("#carousel-image-loading").css("display","none"),$("#carousel-image").css("display","inline-block")},G=function(e){v.hide(),l.show(),c.on("load",function(){$("#current-carousel-image").html(e+1),ht(),yt(),Y(),e===0&&($("#total-carousel-images").html(u.length),u.length>1&&$("#modal-image-picker .carousel-page-status").css("opacity",1))}),c.on("error",function(){l.hide(),v.show(),$("#current-carousel-image").html(e+1),ht(),yt(),Y(),e===0&&($("#total-carousel-images").html(u.length),u.length>1&&$("#modal-image-picker .carousel-page-status").css("opacity",1))}),c.attr("src",u[e])},Y=function(){m===u.length-1?nt():it(),m===0?tt():rt()},Z=function(){a.hasClass("disabled")||(m--,G(m))},et=function(){f.hasClass("disabled")||(m++,G(m))},tt=function(){a.addClass("disabled")},nt=function(){f.addClass("disabled")},rt=function(){a.removeClass("disabled")},it=function(){f.removeClass("disabled")},st=function(){U(),ft(),ht(),yt(),dt(),mt(),Et(),St(),B(),Q(),q(!0)},ot=function(){$(".dialog-body.crop.cropping").css("display","none"),$(".dialog-body.crop.saving").css("display","block"),$(".modal-footer.picker").css("display","none"),q(!1)},ut=function(){$(".dialog-body.crop.saving").css("display","none"),$(".dialog-body.crop.saved").css("display","block"),$(".modal-footer.picker").css("display","none")},at=function(){$(".dialog-body.crop.saving").css("display","none"),$(".dialog-body.crop.error").css("display","block"),N.css("display","none"),$(".modal-footer.picker").css("display","block")},ft=function(){$(".dialog-body.crop.saved").css("display","none"),$(".dialog-body.crop.error").css("display","none"),$(".dialog-body.crop.cropping").css("display","block"),N.css("display","block"),$(".modal-footer.picker").css("display","block")},lt=function(e,t){var n=!1,r=286,i=190;return e>=r&&t>=i&&(n=!0),n},ct=function(){$(".invalid-dimensions.choose").css("display","block")},ht=function(){$(".invalid-dimensions.choose").css("display","none")},pt=function(){$(".minimum-dimensions.upload").addClass("dimensions-error")},dt=function(){$(".minimum-dimensions.upload").removeClass("dimensions-error")},vt=function(){$(".minimum-dimensions.upload").addClass("dimensions-error"),$("#drag-drop-zone").addClass("error")},mt=function(){$(".minimum-dimensions.upload").removeClass("dimensions-error"),$("#drag-drop-zone").removeClass("error")},gt=function(){$(".accepted-file-types.choose").css("display","block")},yt=function(){$(".accepted-file-types.choose").css("display","none")},bt=function(){$(".accepted-file-types.upload").addClass("file-type-error")},wt=function(){$(".accepted-file-types.upload").addClass("file-type-error"),$("#drag-drop-zone").addClass("error")},Et=function(){$(".accepted-file-types.upload").removeClass("file-type-error")},St=function(){$(".accepted-file-types.upload").removeClass("file-type-error"),$("#drag-drop-zone").removeClass("error")},xt=function(){var e={},n={},s=i.getCredentials().userName,u=document.createElement("form"),a="",f=null,l="",c="",h=A,p="",d="",v="",m="",g="";u.setAttribute("method","post"),u.setAttribute("enctype","multipart/form-data"),h&&O?(g=r.arcgisUrl.split("/items")[0],d=g+"/users/"+s+"/items/"+o.id+"/update",v=o.userItemUrl+"/update",m=o.userItemUrl?v:d,p=O,e=Ot(m,p),n=Tt()):(a=Lt(),f=At(a),l=/(image\/.*)(?=;)/g.exec(a),c=l[0].split("/")[1],e=Nt(u,f,c,o),n=Ct(u,f,c,o)),ot(),t([e,n]).then(function(){ut(),kt(h&&p?p:a),L(),setTimeout(function(){S.trigger("click")},1e3)},function(){at()})},Tt=function(){var t=new e;return t.resolve(),t.promise},Nt=function(t,n,r,i){var s=new e,o=new FormData(t),u={};return o.append("thumbnail",n,"thumbnail."+r),u=Mt(i,o),u.then(function(){s.resolve()},function(){s.reject()}),s.promise},Ct=function(t,n,r,i){var s=new e,o=new FormData(t),u={};return o.append("largeThumbnail",n,"largeThumbnail."+r),u=Mt(i,o),u.then(function(){s.resolve()},function(){s.reject()}),s.promise},kt=function(e){o.thumbnail=e,o.hasOwnImage=!0,s.updateThumbnail(o.id,e)},Lt=function(){var e=$("#image-cropper").cropit("export");return e},At=function(e){var t={},n=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(n.length),s=new DataView(i);for(var o=0;o<n.length;o++)s.setUint8(o,n.charCodeAt(o));return t=new Blob([i],{type:r}),t},Ot=function(t,r){var i=new e;return n({url:t,content:{f:"json",thumbnailUrl:r},handleAs:"json"},{usePost:!0}).then(function(){i.resolve()},function(){i.reject()}),i.promise},Mt=function(t,s){var o=new e,u=r.arcgisUrl.split("/items")[0],a=i.getCredentials(),f=u+"/users/"+a.userName+"/items/"+t.id+"/update",l=t.userItemUrl+"/update",c=t.userItemUrl?l:f;return n({url:c,form:s,content:{f:"json"},handleAs:"json"}).then(function(){o.resolve()},function(){o.reject()}),o.promise},_t=function(e){var t=[],n="",r=i.getCredentials().token;for(var s=0;s<e.length;s++)n=e[s].url,e[s].info.isThumbnail||(e[s].info.isFeatureService&&(n+="?token="+r),t.push(n));return t},Dt=function(){g&&(X(),o=null,u=null,a=null,f=null,l=null,c=null,h=null,p=null,d=null,v=null,m=0,g=!1,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=!1,O="")};return{init:M,setImages:V,resetPicker:st,destroy:Dt,convertToPickerImages:_t}}),define("lib-build/hbars!my/content/dialogs/RemoveLayerDialog",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a="function",f=t.helperMissing;return'<div id="remove-layer-modal" class="modal remove-layer-modal" data-modal="remove-layer">\r\n	<div class="dialog-header">\r\n	  <h3 class="dialog-title">'+u(o((i=e!=null?e.labels:e)!=null?i.title:i,e))+'</h3>\r\n	  <a class="modal-dismiss remove-layer-cancel icon-close" href="#"></a>\r\n	</div>  \r\n	<div class="dialog-body leader-1">\r\n		<div class="text-wrapper">\r\n			<h4 class="item-subtitle">'+u((s=(s=t.numWithIssue||(e!=null?e.numWithIssue:e))!=null?s:f,typeof s===a?s.call(e,{name:"numWithIssue",hash:{},data:r}):s))+'</h4>\r\n		</div>\r\n		<div id="layer-carousel-container">\r\n			<div class="carousel-page-status">\r\n				<span id="current-carousel-layer"></span><span>/</span><span id="total-carousel-layers"></span>\r\n			</div>\r\n			<div id="layer-previous" class="carousel-arrow icon-stories-arrow-left"></div><!--\r\n		 --><div id="layer-item-container">			\r\n				<div id="layer-item-carousel">\r\n					<div id="layer-item"></div>\r\n				</div>			\r\n			</div><!--\r\n		 --><div id="layer-next" class="carousel-arrow icon-stories-arrow-right"></div>\r\n		</div>\r\n		<div class="text-wrapper">\r\n			<h4 class="item-subtitle">'+u(o((i=e!=null?e.labels:e)!=null?i.clickBelowWhenDone:i,e))+'</h4>\r\n		</div>\r\n	</div>\r\n	<div class="modal-footer">\r\n	  <div id="remove-layer-rescan" class="btn modal-dismiss">'+u((s=(s=t.checkAgain||(e!=null?e.checkAgain:e))!=null?s:f,typeof s===a?s.call(e,{name:"checkAgain",hash:{},data:r}):s))+"</div>\r\n	</div>\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/dialogs/RemoveLayerItem",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o="function",u=t.helperMissing,a=this.lambda,f=this.escapeExpression,l="<p>";return i=(s=(s=t.issueExplanation||(e!=null?e.issueExplanation:e))!=null?s:u,typeof s===o?s.call(e,{name:"issueExplanation",hash:{},data:r}):s),i!=null&&(l+=i),l+"</p>\r\n<p>"+f(a((i=e!=null?e.labels:e)!=null?i.issueSolution:i,e))+'</p>\r\n<div class="link-text-container leader-half">\r\n	<div id="layer-url-icon" class="link-text-icon share icon-copy" data-clipboard-text="'+f((s=(s=t.layerUrl||(e!=null?e.layerUrl:e))!=null?s:u,typeof s===o?s.call(e,{name:"layerUrl",hash:{},data:r}):s))+'"></div>\r\n	<input id="layer-url-text" class="share-text small-link" value="'+f((s=(s=t.layerUrl||(e!=null?e.layerUrl:e))!=null?s:u,typeof s===o?s.call(e,{name:"layerUrl",hash:{},data:r}):s))+'" readonly="" title="'+f((s=(s=t.layerUrl||(e!=null?e.layerUrl:e))!=null?s:u,typeof s===o?s.call(e,{name:"layerUrl",hash:{},data:r}):s))+'">\r\n	<span id="layer-copied-message" class="embed-alert-text copied-message">'+f((s=(s=t.copied||(e!=null?e.copied:e))!=null?s:u,typeof s===o?s.call(e,{name:"copied",hash:{},data:r}):s))+'</span>\r\n</div>\r\n<div class="leader-half">\r\n	<a class="underlined-link" href="'+f((s=(s=t.mapUrl||(e!=null?e.mapUrl:e))!=null?s:u,typeof s===o?s.call(e,{name:"mapUrl",hash:{},data:r}):s))+'" target="_blank">'+f(a((i=e!=null?e.labels:e)!=null?i.editMap:i,e))+"</a>\r\n</div>"},useData:!0})}),define("my/content/dialogs/RemoveLayerDialog",["lib-build/hbars!./RemoveLayerDialog","lib-build/hbars!./RemoveLayerItem","my/helpers/ZeroClipboardHelper"],function(e,t,n){"use strict";return function(r){var i=r.issues.serviceOkItemNot.items,s=r,o=0,u=null,a=null,f=null,l=null,c=null,h=function(){c=n.initZeroClipboard(),p(),T.modal()},p=function(){var t=i18n.content.removeLayer.layersWithIssue.replace(/{{NUM_WITH_ISSUE}}/g,i.length);$("#modal-container-remove-layer").html(e({labels:i18n.content.removeLayer,checkAgain:i18n.content.notification.refreshExplanation,numWithIssue:t,items:i})),d(),v()},d=function(){u=$("#layer-item-carousel"),a=$("#layer-item"),f=$("#layer-previous"),l=$("#layer-next")},v=function(){m(),b(),$("#total-carousel-layers").html(i.length)},m=function(){f.on("click",g),l.on("click",y)},g=function(){if(f.hasClass("disabled"))return;o--,b()},y=function(){if(l.hasClass("disabled"))return;o++,b()},b=function(){var e=k(i[o]),t=o+1;E(e),x(),S(),$("#current-carousel-layer").html(t),w()},w=function(){o===i.length-1?l.addClass("disabled"):l.removeClass("disabled"),o===0?f.addClass("disabled"):f.removeClass("disabled")},E=function(e){var n=i18n.content.removeLayer,r='<span class="standout-text">'+e.layer.title+"</span>",i=n.issueExplanation.replace(/{{LAYER_NAME}}/g,r);a.html(t({labels:n,issueExplanation:i,layerUrl:e.layer.info.originalUrl,copied:i18n.storyMap.shareDialog.copied,mapUrl:e.map.url}))},S=function(){var e=new c($("#layer-url-icon"));c.on("error",function(){$("#layer-url-icon").css("display","none"),$("#layer-url-text").css("padding-left","13px")})},x=function(){var e=$("#layer-url-icon");$("#layer-url-text").on("click",function(){$(this).select()}),e.on("mousedown",N),e.on("mouseup",C)},N=function(){var e=$(this),t=$("#layer-copied-message");e.addClass("copied"),e.removeClass("icon-copy"),e.addClass("icon-check"),e.addClass("success"),t.show(),setTimeout(function(){e.removeClass("icon-check"),e.removeClass("success"),e.addClass("icon-copy"),e.hasClass("copied")&&e.removeClass("copied"),t.hide()},1e3)},C=function(){$(this).removeClass("copied")},k=function(e){var t=L(e.mapId),n={issue:e,map:t,layer:A(e.id,t)};return n},L=function(e){var t=null;for(var n=0;n<s.media.maps.items.length;n++){t=s.media.maps.items[n];if(t.id===e)return t}return null},A=function(e,t){var n=null;if(!t)return null;for(var r=0;r<t.info.layers.length;r++){n=t.info.layers[r];if(n.id===e)return n}return null};h()}}),define("my/content/scanning/Scanner",["dojo/Deferred","dojo/promise/all","my/content/Builder","my/content/tabs/SubmitToGallery","my/content/scanning/ItemScanner","my/models/Issue","my/content/scanning/StoryIssues","my/content/scanning/StoryUpdate","my/content/scanning/StoryUI","my/content/Templater","my/helpers/TabHelper","my/helpers/UIHelper","my/helpers/AnimationHelper","my/content/tabs/Tags","my/models/Credentials","my/content/scanning/PremiumManager","my/content/tabs/MapsSharing","my/content/dialogs/ImagePicker","my/content/ExpandedStory","my/content/dialogs/RemoveLayerDialog","my/helpers/Formatter"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";var E=null,S=function(t){var n=new e,r=t.storyMap,i=t.useExistingMedia,s=t.targetAccessLevel?t.targetAccessLevel:r.accessLevel,o=t.targetAccessLevel?!0:!1,u=t.updateUI===!1?!1:!0,a=t.expandedMaps||[],f=t.premiumDeferred,l=t.existingItemData;return i?E&&E.id===r.id?T({deferred:n,templateData:E,accessLevel:s,id:r.id,updateUI:u,hasTargetLevel:o,expandedMaps:a,premiumDeferred:f}):x({deferred:n,storyMap:r,accessLevel:s,updateUI:u,hasTargetLevel:o,existingItemData:l,premiumDeferred:f}):x({deferred:n,storyMap:r,accessLevel:s,updateUI:u,hasTargetLevel:o,existingItemData:l,premiumDeferred:f}),n.promise},x=function(e){var t=e.deferred,r=e.storyMap,i=e.accessLevel,s=e.updateUI,o=e.hasTargetLevel,u=e.existingItemData,a=e.premiumDeferred,f={},l=C(r);f=n.buildMedia(l,u),f.then(function(e){T({deferred:t,templateData:e,accessLevel:i,id:l.id,updateUI:s,hasTargetLevel:o,expandedMaps:[],premiumDeferred:a})},function(){t.reject()})},T=function(e){var t=e.deferred,n=e.templateData,i=e.accessLevel,s=e.id,h=e.updateUI,p=e.hasTargetLevel,d=e.expandedMaps,v=e.premiumDeferred,m=[],g=new o,b=null,w=!0,E=A(n,i),S=null,x=!1;E.then(function(e){e.issues=g.compileMediaIssues(e.media),g.customizeIssueObj(e,i);if(p&&e.issues.yoursSharedBelowLevel.items.length>0){b=N(e.issues);if(b){e.allClear=!0,t.resolve(e);return}w=!1}m=g.issueObjToList(e.issues,w),e.media.maps&&l.scanTab(e.media.maps),u.updateAllClear(e),e.media.maps&&h!==!1&&(a.updateMapUI(e.media.maps,e,!0),O(e)),e.id===s&&k(e),window.builderIntegration||r.updateCriteria(e.storyMap),e.allClear?(c.enableStoryShareButtons(e.id),c.hideErrorStatusPane(e.id),f.templatizeSuccessStatusPane(e.id),j(e,i),c.updateNotificationPane(e,d,w),e.storyMap.type==="Map Tour"&&e.media.images&&e.media.images.items.length===0&&(a.hideContentLoader("images",e.id),c.showImageError(e.id))):(S=y.getExpandedStory(),x=e.id===S.id,x&&(f.templatizeErrorStatusPane(m,e.id),j(e,i,v),c.updateNotificationPane(e,d,w),c.disableStoryShareButtons(e.id,!1),c.showErrorStatusPane(e.id),c.highlightFirstErrorTab(e),e.storyMap.type==="Map Tour"&&e.media.images&&e.media.images.items.length===0&&(a.hideContentLoader("images",e.id),c.showImageError(e.id)))),c.addMediaTabsEvents(e.id,e),M(e),_(e.storyMap),t.resolve(e)})},N=function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t].items.length>0&&e[t].title!=="yoursSharedBelowLevel")return!1;return!0},C=function(e){if(e.accessLevel==="org"||e.accessLevel==="account")e.accessLevel="organization";var t={id:e.id,storyMap:e,media:{},storyComponent:"",titleType:"",allClear:!0,issues:{},premiumManager:new v(e)};return t},k=function(e){E=e},L=function(){return E},A=function(n,r){var s=[],o=null,u=[],a=new e;if(n.media.maps){s=n.media.maps.items;for(var f=0;f<s.length;f++)o=i.scanMapFinally(s[f],n.storyMap.accessLevel,r,n.premiumManager),u.push(o);t(u).then(function(){a.resolve(n)})}else a.resolve(n);return a.promise},O=function(e){var t='.item[data-id="'+e.id+'"]';$(t+" .map-sharing").off("click").on("click",function(t){if($(t.currentTarget).parents(".sharing-icons.locked").length||$(t.currentTarget).hasClass("temp-disabled")){t.preventDefault();return}var n=$(this),r=n.data("sharing"),i=n.data("id"),s=n.data("type"),o=n.data("map-id")?[n.data("map-id")]:[],u={};n.parent().parent().hasClass("locked")||(c.disableFadeableButtons(e.id),u=B(!1,r,i,s,o,e),u.then(function(t){var n=w.formatNotificationString(t.newLevel,t.type,!1,!1,!1,"");c.reEnableButtons(e.id),f.templatizeSuccessNotification(e.id,n),c.showSuccessNotification(e.id,!1),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel)},function(){c.reEnableButtons(e.id),f.templatizeErrorNotification(e.id),c.showErrorNotification(e.id),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel)}))}),window.builderIntegration&&$(t+" .edit-item").off("click").on("click",function(){var e=$(this).data("id");typeof window.editMapCallback=="function"&&window.editMapCallback(e)}),c.addToggleLayerEvents(e.id)},M=function(e){var t='.item[data-id="'+e.id+'"]';window.builderIntegration&&$(t+" .section-link").off("click").on("click",function(){var e=$(this).data("section-number"),t=parseInt(e,10),n=t-1,r=$(this).data("type");typeof window.sectionClickCallback=="function"&&window.sectionClickCallback(n,r)})},_=function(e){$(".collection-tags").change(function(){p.updateCollectionTag($(this).val(),e)}),$(".item-tags-list").off("blur").on("blur",function(){p.updateYourTags($(this),e)}),$(".item-tags-list").on("keypress",function(e){var t=$(this);if(e.keyCode===13){t.html(t.html()+", "),t[0].focus();var n=document.createRange();n.selectNodeContents(t[0]),n.collapse(!1);var r=window.getSelection();return r.removeAllRanges(),r.addRange(n),!1}}),$(".item-tags-list").on("keyup",function(){$("li.expanded .item-update-tags").removeClass("disabled")}),$(".item-update-tags").on("click",function(){if($(this).hasClass("disabled")||$(this).hasClass("notify")||$(this).hasClass("temp-disabled"))return;var t=d.getCredentials(),n={item:e,userName:t.userName},i=p.saveTagsToServer(n);c.disableFadeableButtons(e.id),i.then(function(e){r.updateCriteria(e)},function(){})})},D=function(n,r,i){var o=new e,u=[],a={},l=s.getPossibleIssues(),h=r.issues[l.yoursSharedBelowLevel].items,p=[],d=null;c.disableRefreshIcon(r.id);for(var v=0;v<h.length;v++)a=h[v],P(a,r,u,p,n);return t(u).then(function(e){var t={storyMap:r.storyMap,useExistingMedia:!0,expandedMaps:p},n={};i?(n={changedMapLayers:e,expandedMaps:p},o.resolve(n)):(d=S(t),d.then(function(){c.updateSharedRows(e,!0),o.resolve(e)},function(){c.updateSharedRows(e,!0),o.resolve(e)}))},function(){var e={storyMap:r.storyMap,useExistingMedia:!0,expandedMaps:p};d=S(e),d.then(function(){f.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevels,r.id),c.showErrorNotification(r.id),o.reject()},function(){f.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevels,r.id),c.showErrorNotification(r.id),o.reject()})}),o.promise},P=function(e,t,n,r,i){var s=!1,o={};if(e.itemType==="layer"){r.indexOf(e.mapId)===-1&&r.push(e.mapId),s=H(e,t.media.maps.items);if(s===!0)return}o=B(!0,i,e.id,e.itemType,[],t),n.push(o)},H=function(e,t){var n={},r={};for(var i=0;i<t.length;i++){n=t[i];if(n.id===e.mapId)for(var s=0;s<n.info.layers.length;s++){r=n.info.layers[s];if(r.id===e.id)return r.info.partOfMap}}return!1},B=function(t,n,r,i,s,o){var a=new e,l={},h=null;return t||c.disableRefreshIcon(o.id),l=u.updateMapObj(n,r,i,o),l.then(function(e){var n={};t?a.resolve(e):(n={storyMap:e.storyObj.storyMap,useExistingMedia:!0,expandedMaps:s},h=S(n),h.then(function(){c.updateSharedRow(e,!1),a.resolve(e)},function(){c.updateSharedRow(e,!1),a.resolve(e)}))},function(){var e={};t?a.reject():(e={storyMap:o.storyMap,useExistingMedia:!0,expandedMaps:s},f.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevel,o.id),c.showErrorNotification(o.id),h=S(e),h.then(function(){a.reject()},function(){a.reject()}))}),a.promise},j=function(e,t,n){var r='.item[data-id="'+e.id+'"]',i=r+" .notification-issue",o=s.getPossibleIssues();e.issues.serviceOkItemNot.items.length&&(new b(e),$("#remove-layer-rescan").on("click",function(){F(e)})),$(r+" .item-side-buttons .refresh").on("click",function(t){!$(this).hasClass("disabled")&&!$(t.currentTarget).hasClass("temp-disabled")&&F(e)}),$(i).on("click",function(t){($(t.target).hasClass("notification-issue")||$(t.target).closest(".notification-explanation").length>0)&&c.selectNotification($(this),e.id,e.issues,[])}),$(i+'[data-issue-type="'+o.serviceOkItemNot+'"] .issue-action[data-action="ignore"]').on("click",function(t){if($(t.currentTarget).hasClass("temp-disabled")){t.preventDefault();return}y.setIgnoreServiceItem(!0),F(e)}),$(i+'[data-issue-type="'+o.yoursSharedBelowLevel+'"] .issue-action.positive').on("click",function(n){if($(n.currentTarget).hasClass("temp-disabled")){n.preventDefault();return}R(e,t)}),$(i+'[data-issue-type="'+o.premiumContent+'"] .issue-action.positive').on("click",function(r){if($(r.currentTarget).hasClass("temp-disabled")){r.preventDefault();return}e.storyMap.accessLevel==="public"?J(e,t,!0):z(n,e,t,!0,!0)}),$(i+'[data-issue-type="'+o.subscriptionContent+'"] .issue-action.positive').on("click",function(n){if($(n.currentTarget).hasClass("temp-disabled")){n.preventDefault();return}e.storyMap.accessLevel==="public"&&J(e,t,!1)})},F=function(e){var t='.item[data-id="'+e.id+'"]',n=$(t+" .refresh-tooltip-container .tooltip-content"),r=n.css("width"),i={storyMap:e.storyMap,useExistingMedia:!1},s=null;n.html(i18n.content.notification.checking),n.css("width",r),c.disableFadeableButtons(e.id),c.spinRefreshIcon(e.id),c.disableRefreshIcon(e.id),s=S(i),s.then(function(e){I(e)},function(){q(e)})},I=function(e){var t=[],n=e.media.images,r=$("#modal-image-picker").data("item-id");setTimeout(function(){c.haltRefreshIcon(e.id)},500),c.reEnableButtons(e.id),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel),n?t=g.convertToPickerImages(n.items):t=[],r===e.id&&g.setImages(t)},q=function(e){setTimeout(function(){c.haltRefreshIcon(e.id)},500),c.emptyMediaContainers(e.id),c.reEnableButtons(e.id),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel),c.showContentErrorMessage(e.id),g.setImages(null),c.emptyStatusPane(e.id)},R=function(e,t){var n={};c.disableFadeableButtons(e.id),n=D(t,e,!1),n.then(function(){var n=w.formatNotificationString(t,"content",!1,!1,!1,"");c.reEnableButtons(e.id),f.templatizeSuccessNotification(e.id,n),c.showSuccessNotification(e.id,!0),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel)},function(){c.reEnableButtons(e.id),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel)})},U=function(e,t,n,r,i){var s=X(t,n,r),o=[];s.then(function(r){var s=S({storyMap:t.storyMap,useExistingMedia:!0,expandedMaps:r.expandedMaps}),u=tt(i.changedMapLayers);u==="maps"?u="both":u="layers",o=K(r.results,t),o=o.concat(i.changedMapLayers),s.then(function(){var s=w.formatNotificationString(t.storyMap.accessLevel,"story",!0,!1,!1,u);c.updateSharedRows(o,!0),a.updateStoryMapUI(t.storyMap.accessLevel,t.id),c.emptyExpandedMaps(t.id),r.expandedMaps=r.expandedMaps.concat(i.expandedMaps);for(var l=0;l<r.expandedMaps.length;l++)c.toggleLayers(r.expandedMaps[l],t.id,!1);f.templatizeSuccessNotification(t.id,s),c.showSuccessNotification(t.id,!0),c.reEnableButtons(t.id),c.showBySharingLevel(t.id,t.storyMap.accessLevel),c.restrictMapLayerSharing(t.id,t.storyMap.accessLevel),e&&e.resolve({storyAndContent:!0,premiumContent:n,subscriptionContent:!n,storyMap:t.storyMap,changedItemsType:u})},function(){var r=w.formatNotificationString(t.storyMap.accessLevel,"story",!1,!1,!1,u);a.updateStoryMapUI(t.storyMap.accessLevel,t.id),c.updateSharedRows(o,!0),c.reEnableButtons(t.id),f.templatizeSuccessNotification(t.id,r),c.showSuccessNotification(t.id,!0),c.restrictMapLayerSharing(t.id,t.storyMap.accessLevel),e&&e.resolve({storyAndContent:!0,premiumContent:n,subscriptionContent:!n,storyMap:t.storyMap,changedItemsType:u})})},function(){Q(e,t,n),c.updateSharedRows(i.changedMapLayers,!0),a.updateStoryMapUI(t.storyMap.accessLevel,t.id)})},z=function(e,n,r,i,s){var o=W(n,r),u=D(r,n,!0);t([o,u]).then(function(t){U(e,n,i,s,t[1])},function(){G(e,n,o)})},W=function(t,n){var r=new e,i=m.updateItemSharing(n,t.id,"storyMap",t),s=null;return i.then(function(e){r.resolve(e)},function(){s=S({storyMap:t.storyMap,useExistingMedia:!0}),s.then(function(){f.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevel,t.id),c.showErrorNotification(t.id),r.reject()},function(){f.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevel,t.id),c.showErrorNotification(t.id),r.reject()})}),r.promise},X=function(t,n,r){var i=new e,s=[],o=new e,u=[];return r?(s=Y(t.media.maps.items),s=s.concat(Z(t.media.maps.items))):n?s=Y(t.media.maps.items):s=Z(t.media.maps.items),u=V(s),c.disableFadeableButtons(t.id),app.cfg.proxyNetworkManager.addRequest({item:s,deferred:o,request:t.premiumManager.addProxies}),o.promise.then(function(e){i.resolve({results:e,expandedMaps:u})},function(){i.reject()}),i.promise},V=function(e){var t=[],n=null;for(var r=0;r<e.length;r++)n=e[r],n.type==="layer"&&t.indexOf(n.info.mapId)===-1&&t.push(n.info.mapId);return t},J=function(e,t,n){var r=X(e,n,!1);r.then(function(r){var i=[],s=null,o=w.formatNotificationString(t,"content",!1,n,!n,"");c.emptyExpandedMaps(e.id);for(var u=0;u<r.expandedMaps.length;u++)c.toggleLayers(r.expandedMaps[u],e.id,!1);c.reEnableButtons(e.id),f.templatizeSuccessNotification(e.id,o),c.showSuccessNotification(e.id,!0),c.restrictMapLayerSharing(e.id,e.storyMap.accessLevel),s=S({storyMap:e.storyMap,useExistingMedia:!0,expandedMaps:r.expandedMaps}),s.then(function(){i=K(r.results,e),c.updateSharedRows(i,!1)},function(){i=K(r.results,e),c.updateSharedRows(i,!1)})},function(){Q(null,e,n)})},K=function(e,t){var n=[],r=null,i=null;for(var s=0;s<e.length;s++)i=e[s],r={type:i.type,storyObj:t,itemId:i.id},n.push(r);return n},Q=function(e,t,n){var r=null,i="";n?i=i18n.content.errors.cantUpdatePremiumContent:i=i18n.content.errors.cantUpdateSubscriptionContent,f.templatizeErrorNotification(i,t.id),c.showErrorNotification(t.id),c.reEnableButtons(t.id),c.restrictMapLayerSharing(t.id,t.storyMap.accessLevel),e&&e.reject({message:i,storyMap:t.storyMap}),r=S({storyMap:t.storyMap,useExistingMedia:!0,expandedMaps:[]}),r.then(function(){},function(){})},G=function(e,t,n){var r=S({storyMap:t.storyMap,useExistingMedia:!0,expandedMaps:[]});r.then(function(){var r="";n.isRejected()?r=i18n.content.errors.cantChangeSharingLevel:r=i18n.content.errors.cantChangeSharingLevels,f.templatizeErrorNotification(r,t.id),c.showErrorNotification(t.id),c.reEnableButtons(t.id),c.restrictMapLayerSharing(t.id,t.storyMap.accessLevel),e&&e.reject({message:r,storyMap:t.storyMap})},function(){var r="";n.isRejected()?r=i18n.content.errors.cantChangeSharingLevel:r=i18n.content.errors.cantChangeSharingLevels,f.templatizeErrorNotification(r,t.id),c.showErrorNotification(t.id),c.reEnableButtons(t.id),c.restrictMapLayerSharing(t.id,t.storyMap.accessLevel),e&&e.reject({message:r,storyMap:t.storyMap})})},Y=function(e){var t=[],n=null,r=null;for(var i=0;i<e.length;i++){n=e[i],n.isPremiumContent&&!n.hasProxy&&t.push(n);for(var s=0;s<n.info.layers.length;s++)r=n.info.layers[s],r.isPremiumContent&&!r.hasProxy&&t.push(r)}return t},Z=function(e){var t=[],n=null,r=null;for(var i=0;i<e.length;i++){n=e[i],n.isSubscriptionContent&&!n.hasProxy&&t.push(n);for(var s=0;s<n.info.layers.length;s++)r=n.info.layers[s],r.isSubscriptionContent&&!r.hasProxy&&t.push(r)}return t},et=function(e){var t=!1,n=null;return e.allClear&&e.media.maps&&(n=Z(e.media.maps.items),n.length&&(t=!0)),t},tt=function(e){var t="",n=[],r=[],i=null;for(var s=0;s<e.length;s++)i=e[s],i.type==="map"?n.push(i):i.type==="layer"&&r.push(i);return n.length&&r.length?t="both":n.length&&!r.length?t="maps":!n.length&&r.length&&(t="layers"),t};return{scan:S,getStoryMedia:L,changeBulkItemSharing:D,checkIfOnlyIssueSubscription:et,addProxyBulkShare:z,checkSharedItemsType:tt}}),define("lib-build/hbars!my/content/StoryMap",["Handlebars"],function(e){return e.template({1:function(e,t,n,r,i){var s,o,u="function",a=t.helperMissing,f=this.escapeExpression,l=this.lambda,c='<li class="item row padding-leader-half padding-trailer-half';return s=t["if"].call(e,e!=null?e.allClear:e,{name:"if",hash:{},fn:this.program(2,r,i),inverse:this.program(4,r,i),data:r}),s!=null&&(c+=s),c+='" data-index="'+f((o=(o=t.index||(e!=null?e.index:e))!=null?o:a,typeof o===u?o.call(e,{name:"index",hash:{},data:r}):o))+'" data-id="'+f((o=(o=t.id||(e!=null?e.id:e))!=null?o:a,typeof o===u?o.call(e,{name:"id",hash:{},data:r}):o))+'" data-story-type="'+f((o=(o=t.type||(e!=null?e.type:e))!=null?o:a,typeof o===u?o.call(e,{name:"type",hash:{},data:r}):o))+'">		\r\n	<div class="item-close expandable">				\r\n		<h6 class="item-close-text header-light">'+f(l((s=i[1]!=null?i[1].labels:i[1])!=null?s.collapse:s,e))+'</h6>\r\n	</div>		\r\n	<div class="row leader-half trailer-half">\r\n		<div class="column-4">\r\n			<div class="dialog-container"></div>\r\n			<div class="image-container">\r\n				<img class="item-photo" src="'+f((o=(o=t.thumbnail||(e!=null?e.thumbnail:e))!=null?o:a,typeof o===u?o.call(e,{name:"thumbnail",hash:{},data:r}):o))+'">\r\n				<div class="photo-bottom-overlay modal-show" data-modal="image-picker">\r\n					<div class="photo-camera-container">\r\n						<img class="photo-camera" src="assets/images/my-stories/camera.png"/>\r\n					</div><!--					\r\n				 --><div class="photo-text">'+f(l((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.imagePicker:s)!=null?s.chooseImage:s,e))+'</div>\r\n				</div>\r\n				<div class="item-thumbnail-icon item-status-icon icon-stories-error"></div>					\r\n				<!--<div class="item-thumbnail-icon item-edit-icon icon-stories-plus expandable"></div>-->\r\n			</div>\r\n			<div class="item-side-buttons expandable">\r\n',s=this.invokePartial(n.shareButtons,"				","shareButtons",e,{cantSharePublicMessage:i[1]!=null?i[1].cantSharePublicMessage:i[1],canSharePublicly:i[1]!=null?i[1].canSharePublicly:i[1],sharingLevel:i[1]!=null?i[1].sharingLevel:i[1],labels:i[1]!=null?i[1].labels:i[1]},t,n,r),s!=null&&(c+=s),c+='				<div class="notification-container"></div>							\r\n				<div class="status-pane-container"></div>															\r\n			</div>\r\n		</div>				\r\n	 	<div class="item-text column-20 container">\r\n	 		<div class="item-title-container row">\r\n	 			<div class="item-metadata-container whole-line column-18">\r\n	 				<div>\r\n	 					<div class="item-title-container">\r\n	 						<h2 class="item-title editing">'+f((o=(o=t.title||(e!=null?e.title:e))!=null?o:a,typeof o===u?o.call(e,{name:"title",hash:{},data:r}):o))+'</h2>\r\n	 						<span class="item-title-error-message">'+f(l((s=i[1]!=null?i[1].labels:i[1])!=null?s.saveFailed:s,e))+'</span>\r\n	 					</div>	 					\r\n	 					<h4 class="item-subtitle inline">'+f((o=(o=t.type||(e!=null?e.type:e))!=null?o:a,typeof o===u?o.call(e,{name:"type",hash:{},data:r}):o))+'</h4><span class="separator"></span><span class="access">',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"shared",{name:"ifEquals",hash:{},fn:this.program(6,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"private",{name:"ifEquals",hash:{},fn:this.program(6,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"organization",{name:"ifEquals",hash:{},fn:this.program(8,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"public",{name:"ifEquals",hash:{},fn:this.program(10,r,i),inverse:this.noop,data:r}),s!=null&&(c+=s),c+='</span><span class="separator"></span><span>'+f((o=(o=t.modifiedStr||(e!=null?e.modifiedStr:e))!=null?o:a,typeof o===u?o.call(e,{name:"modifiedStr",hash:{},data:r}):o))+'</span><span class="separator num-views-separator"></span><span class="num-views block-element">'+f((o=(o=t.numViewsStr||(e!=null?e.numViewsStr:e))!=null?o:a,typeof o===u?o.call(e,{name:"numViewsStr",hash:{},data:r}):o))+'</span>\r\n	 				</div>		 				\r\n					<div class="item-summary-container expandable leader-half trailer-half">\r\n						<h4 class="item-subtitle summary">'+f(l((s=i[1]!=null?i[1].labels:i[1])!=null?s.summary:s,e))+'</h4>\r\n						<p class="item-summary editing" contentEditable="true">',s=t["if"].call(e,e!=null?e.snippet:e,{name:"if",hash:{},fn:this.program(12,r,i),inverse:this.program(14,r,i),data:r}),s!=null&&(c+=s),c+='</p>\r\n						<span class="item-snippet-error-message">'+f(l((s=i[1]!=null?i[1].labels:i[1])!=null?s.saveFailed:s,e))+'</span>\r\n					</div>\r\n					<div class="item-edit-actions expandable">		 				\r\n						<a class="btn icon-edit item-edit item-action fadeable-button" href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'&edit" target="_blank">'+f(l((s=i[1]!=null?i[1].labels:i[1])!=null?s.editStory:s,e))+'</a>\r\n						<a class="btn item-action item-view-live icon-window-lines fadeable-button" href="'+f((o=(o=t.url||(e!=null?e.url:e))!=null?o:a,typeof o===u?o.call(e,{name:"url",hash:{},data:r}):o))+'" target="_blank">',s=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"public",{name:"ifEquals",hash:{},fn:this.program(16,r,i),inverse:this.program(18,r,i),data:r}),s!=null&&(c+=s),c+='</a>\r\n						<div class="modal-show btn icon-delete item-delete item-action fadeable-button" data-modal="delete-item">'+f(l((s=i[1]!=null?i[1].labels:i[1])!=null?s["delete"]:s,e))+'</div>						\r\n						<div class="social-share-buttons">\r\n							<div class="tooltip above social-tooltip">\r\n								<div class="social-share-button share-dialog-button icon-link modal-show fadeable-button" data-modal="share-story"></div>\r\n								<div class="tooltip-wrapper social share-dialog no-show">\r\n									<span class="tooltip-content">'+f(l((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.socialSharing:s)!=null?s.availableWhenPublic:s,e))+'</span>\r\n								</div>\r\n							</div>	\r\n							<div class="tooltip above social-tooltip">\r\n								<div class="social-share-button facebook-share icon-stories-facebook fadeable-button"></div>\r\n								<div class="tooltip-wrapper social no-show">\r\n									<span class="tooltip-content">'+f(l((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.socialSharing:s)!=null?s.availableWhenPublic:s,e))+'</span>\r\n								</div>\r\n							</div>							\r\n							<div class="tooltip above social-tooltip">\r\n								<div class="social-share-button twitter-share icon-twitter fadeable-button"></div>\r\n								<div class="tooltip-wrapper social no-show">\r\n									<span class="tooltip-content">'+f(l((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.socialSharing:s)!=null?s.availableWhenPublic:s,e))+'</span>\r\n								</div>\r\n							</div>							\r\n						</div>\r\n					</div>															\r\n	 			</div>\r\n	 			<div class="infographics-container column-6 leader-1 expandable"></div>\r\n	 		</div>	 			\r\n',s=this.invokePartial(n.content," 			","content",e,{isBuilder:!1,labels:i[1]!=null?i[1].labels:i[1]},t,n,r),s!=null&&(c+=s),c+'		</div>					 \r\n	</div>	\r\n	<div class="item-highlight"></div>						\r\n</li>\r\n'},2:function(e,t,n,r){return""},4:function(e,t,n,r){return" has-issues"},6:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].sharingLevel:i[2])!=null?s["private"]:s,e))},8:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].sharingLevel:i[2])!=null?s.organization:s,e))},10:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].sharingLevel:i[2])!=null?s["public"]:s,e))},12:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return u((i=(i=t.snippet||(e!=null?e.snippet:e))!=null?i:o,typeof i===s?i.call(e,{name:"snippet",hash:{},data:r}):i))},14:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=(s=i[2]!=null?i[2].labels:i[2])!=null?s.placeholders:s)!=null?s.noSummary:s,e))},16:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].labels:i[2])!=null?s.viewLive:s,e))},18:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression;return u(o((s=i[2]!=null?i[2].labels:i[2])!=null?s.preview:s,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o="";return s=t.each.call(e,e!=null?e.storyMaps:e,{name:"each",hash:{},fn:this.program(1,r,i),inverse:this.noop,data:r}),s!=null&&(o+=s),o},usePartial:!0,useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/ShareButtons",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.sharingLevel:e)!=null?i["private"]:i,e))},3:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.sharingLevel:e)!=null?i.organization:i,e))},5:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression;return o(s((i=e!=null?e.sharingLevel:e)!=null?i["public"]:i,e))},7:function(e,t,n,r){return" active"},9:function(e,t,n,r){return""},11:function(e,t,n,r){return" disabled-public"},13:function(e,t,n,r){var i,s="function",o=t.helperMissing,u=this.escapeExpression;return u((i=(i=t.cantSharePublicMessage||(e!=null?e.cantSharePublicMessage:e))!=null?i:o,typeof i===s?i.call(e,{name:"cantSharePublicMessage",hash:{},data:r}):i))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s,o=this.lambda,u=this.escapeExpression,a=t.helperMissing,f="function",l='<div class="item-actions">\r\n	<span>'+u(o((i=e!=null?e.labels:e)!=null?i.shared:i,e))+': </span><h4 class="item-subtitle access">';return i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"shared",{name:"ifEquals",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(l+=i),i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"private",{name:"ifEquals",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),i!=null&&(l+=i),i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"organization",{name:"ifEquals",hash:{},fn:this.program(3,r),inverse:this.noop,data:r}),i!=null&&(l+=i),i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"public",{name:"ifEquals",hash:{},fn:this.program(5,r),inverse:this.noop,data:r}),i!=null&&(l+=i),l+='</h4>\r\n	<div class="btn-group">								\r\n	    <div class="tooltip above sharing-button-container story private">\r\n			<button class="story-sharing map-sharing-icon server-button icon-user private locked',i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"private",{name:"ifEquals",hash:{},fn:this.program(7,r),inverse:this.noop,data:r}),i!=null&&(l+=i),i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"shared",{name:"ifEquals",hash:{},fn:this.program(7,r),inverse:this.noop,data:r}),i!=null&&(l+=i),l+='" data-id="'+u((s=(s=t.id||(e!=null?e.id:e))!=null?s:a,typeof s===f?s.call(e,{name:"id",hash:{},data:r}):s))+'" data-sharing="private" data-type="story-map"></button>\r\n			<div class="tooltip-wrapper">\r\n				<p class="tooltip-content">'+u(o((i=e!=null?e.sharingLevel:e)!=null?i["private"]:i,e))+'</p>\r\n			</div>								\r\n		</div><!--\r\n	 --><div class="tooltip above sharing-button-container story organization">\r\n			<button class="story-sharing map-sharing-icon server-button icon-community organization locked',i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"organization",{name:"ifEquals",hash:{},fn:this.program(7,r),inverse:this.noop,data:r}),i!=null&&(l+=i),l+='" data-id="'+u((s=(s=t.id||(e!=null?e.id:e))!=null?s:a,typeof s===f?s.call(e,{name:"id",hash:{},data:r}):s))+'" data-sharing="organization" data-type="story-map"></button>\r\n			<div class="tooltip-wrapper">\r\n				<p class="tooltip-content">'+u(o((i=e!=null?e.sharingLevel:e)!=null?i.organization:i,e))+'</p>\r\n			</div>								\r\n		</div><!--\r\n	 --><div class="tooltip above sharing-button-container story public ',i=t["if"].call(e,e!=null?e.canSharePublicly:e,{name:"if",hash:{},fn:this.program(9,r),inverse:this.program(11,r),data:r}),i!=null&&(l+=i),l+='">\r\n			<button class="story-sharing map-sharing-icon server-button icon-stories-globe public locked',i=(t.ifEquals||e&&e.ifEquals||a).call(e,e!=null?e.accessLevel:e,"public",{name:"ifEquals",hash:{},fn:this.program(7,r),inverse:this.noop,data:r}),i!=null&&(l+=i),i=t["if"].call(e,e!=null?e.canSharePublicly:e,{name:"if",hash:{},fn:this.program(9,r),inverse:this.program(11,r),data:r}),i!=null&&(l+=i),l+='" data-id="'+u((s=(s=t.id||(e!=null?e.id:e))!=null?s:a,typeof s===f?s.call(e,{name:"id",hash:{},data:r}):s))+'" data-sharing="public" data-type="story-map">\r\n			</button>\r\n			<div class="tooltip-wrapper">\r\n				<p class="tooltip-content">',i=t["if"].call(e,e!=null?e.canSharePublicly:e,{name:"if",hash:{},fn:this.program(5,r),inverse:this.program(13,r),data:r}),i!=null&&(l+=i),l+"</p>\r\n			</div>								\r\n		</div>								\r\n	</div>									\r\n</div>"},useData:!0})}),define("lib-build/hbars!my/content/Content",["Handlebars"],function(e){return e.template({1:function(e,t,n,r){return""},3:function(e,t,n,r){return" leader-half"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r,i){var s,o=this.lambda,u=this.escapeExpression,a='<div class="item-content-container expandable row';return s=t["if"].call(e,e!=null?e.isBuilder:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),s!=null&&(a+=s),a+'">										\r\n	<div class="content-tabs-container media row trailer-1"></div>						\r\n	<div>						\r\n		<div class="item-table-container row" data-media-type="maps" data-tab-type="maps">\r\n			<div class="loading-container content-loader map-content-loader padding-leader-1 padding-trailer-1">\r\n				<h2 class="progress-title">'+u(o((s=e!=null?e.labels:e)!=null?s.loading:s,e))+'</h2>\r\n				<div class="loader">\r\n				   <span class="side side-left"><span class="fill"></span></span>\r\n				   <span class="side side-right"><span class="fill"></span></span>\r\n				</div>\r\n			</div>\r\n			<div class="maps-tab-error no-show">\r\n				<h2>'+u(o((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.maps:s)!=null?s.unableRetrieveTitle:s,e))+"</h2>\r\n				<p>"+u(o((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.maps:s)!=null?s.unableRetrieveDescription:s,e))+'</p>\r\n			</div>\r\n			<div class="item-media-container maps-container"></div>							\r\n		</div>\r\n		<div class="item-table-container row" data-media-type="images" data-tab-type="images">\r\n			<div class="loading-container content-loader image-content-loader padding-leader-1 padding-trailer-1">\r\n				<h2 class="progress-title">'+u(o((s=e!=null?e.labels:e)!=null?s.loading:s,e))+'</h2>\r\n				<div class="loader">\r\n				   <span class="side side-left"><span class="fill"></span></span>\r\n				   <span class="side side-right"><span class="fill"></span></span>\r\n				</div>\r\n			</div>\r\n			<div class="image-tab-error no-show">\r\n				<h2>'+u(o((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.images:s)!=null?s.unableRetrieveTitle:s,e))+"</h2>\r\n				<p>"+u(o((s=(s=i[1]!=null?i[1].labels:i[1])!=null?s.images:s)!=null?s.unableRetrieveDescription:s,e))+'</p>\r\n			</div>\r\n			<div class="item-media-container images-container"></div>\r\n		</div>\r\n		<div class="item-table-container row" data-media-type="videos" data-tab-type="videos">\r\n			<div class="loading-container content-loader video-content-loader padding-leader-1 padding-trailer-1">\r\n				<h2 class="progress-title">'+u(o((s=e!=null?e.labels:e)!=null?s.loading:s,e))+'</h2>\r\n				<div class="loader">\r\n				   <span class="side side-left"><span class="fill"></span></span>\r\n				   <span class="side side-right"><span class="fill"></span></span>\r\n				</div>\r\n			</div>\r\n			<div class="item-media-container videos-container"></div>\r\n		</div>\r\n		<div class="item-table-container row" data-media-type="webpages" data-tab-type="webpages">\r\n			<div class="loading-container content-loader webpage-content-loader padding-leader-1 padding-trailer-1">\r\n				<h2 class="progress-title">'+u(o((s=e!=null?e.labels:e)!=null?s.loading:s,e))+'</h2>\r\n				<div class="loader">\r\n				   <span class="side side-left"><span class="fill"></span></span>\r\n				   <span class="side side-right"><span class="fill"></span></span>\r\n				</div>\r\n			</div>\r\n			<div class="item-media-container webpages-container"></div>\r\n		</div>						\r\n		<div class="item-table-container row" data-tab-type="tags">\r\n			<div class="tags-container"></div>\r\n		</div>\r\n		<div class="item-table-container row" data-tab-type="gallery">\r\n			<div class="loading-container content-loader gallery-loader padding-leader-1 padding-trailer-1">\r\n				<h2 class="progress-title">'+u(o((s=e!=null?e.labels:e)!=null?s.loading:s,e))+'</h2>\r\n				<div class="loader">\r\n				   <span class="side side-left"><span class="fill"></span></span>\r\n				   <span class="side side-right"><span class="fill"></span></span>\r\n				</div>\r\n			</div>\r\n			<div class="item-media-container submit-to-gallery-container"></div>													\r\n		</div>\r\n	</div>\r\n	<div class="content-tab-error">\r\n		<h2>'+u(o((s=(s=e!=null?e.labels:e)!=null?s.errors:s)!=null?s.unableToFind:s,e))+"</h2>\r\n		<p>"+u(o((s=(s=e!=null?e.labels:e)!=null?s.errors:s)!=null?s.unableToRetrieve:s,e))+"</p>\r\n	</div>					\r\n</div>"},useData:!0,useDepths:!0})}),define("lib-build/hbars!my/content/BuilderPage",["Handlebars"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,r){var i,s=this.lambda,o=this.escapeExpression,u='<div id="builder-story" data-index="0" data-id='+o(s((i=e!=null?e.storyMap:e)!=null?i.id:i,e))+' class="item row">\r\n	<div class="item-side-buttons column-6 expandable">\r\n		<div class="notification-container"></div>\r\n		<div class="status-pane-container"></div>			\r\n	</div>\r\n	<div class="item-text column-18 container"> 				\r\n';return i=this.invokePartial(n.content,"		","content",e,{isBuilder:!0,labels:e!=null?e.labels:e},t,n,r),i!=null&&(u+=i),u+"	</div>\r\n</div>"},usePartial:!0,useData:!0})}),define("my/content/StoriesList",["Handlebars","lib-build/hbars!./StoryMap","my/content/Templater","my/models/Credentials","lib-build/hbars!./ShareButtons","lib-build/hbars!./Content","lib-build/hbars!./BuilderPage"],function(e,t,n,r,i,s,o){"use strict";var u=function(u,a,f){var l=null;$("#list-container").css("height","inherit"),a&&$("#item-list").empty();if(u.length===0){f?n.templatizeError({noSearchResults:!0,isEnglish:app.cfg.isEnglish}):a&&(n.templatizeError({noStories:!0}),l=$("#create-story-no-stories-btn"),l.on("click",function(e){$(e.currentTarget).hasClass("create-story-disabled")&&(e.preventDefault(),$("#modal-container-create-story").click())}),window.CreateStoryDialog&&window.onCreateStoryDialogLoaded(null,l));return}$("#error-container").css("display","none");var c=!0,h=r.getCredentials().portal;h&&h.user&&(c=h.canSharePublic===!1?!1:!0,h.user.role&&h.user.role.toLowerCase()==="org_admin"&&(c=!0)),e.registerPartial("shareButtons",i),e.registerPartial("content",s);if(window.builderIntegration){$("#builder-loading").css("display","none");var p=o({storyMap:u[0],labels:i18n.storyMap,sharingLevel:i18n.sharingLevel,canSharePublicly:c,cantSharePublicMessage:i18n.content.errors.publicDisabled},{helpers:e.helpers});$("#builder-container").html(p)}else $("#item-list").append(t({storyMaps:u,labels:i18n.storyMap,sharingLevel:i18n.sharingLevel,canSharePublicly:c,cantSharePublicMessage:i18n.content.errors.publicDisabled},{helpers:e.helpers}))};return{storiesListToScreen:u}}),define("my/content/scanning/ScanAll",["dojo/Deferred","dojo/promise/all","my/content/scanning/Scanner","my/content/scanning/StoryUpdate","my/content/Templater","my/content/StoriesList","my/helpers/UIHelper"],function(e,t,n,r,i,s,o){"use strict";var u=1500,a=function(n,r,i){var s=new e,a=[],c=n.length,h=6,p={},d={},v={},m={numWithIssues:0,aborted:!1};o.onScanStart(c),$("#scanning-stop").on("click",function(){l(m,a,r,s,c)});for(var g=0;g<n.length;g++)v=new e,d[n[g].id]=v,p[n[g].id]=v.promise;for(var y=0;y<h;y++)n.length&&(f(n[0],n,a,d,r,m,c,s),n.splice(0,1));return t(p).then(function(){var e=c!==i;o.onScanComplete(m.numWithIssues,e),setTimeout(function(){o.exitScanMode(a.length),s.resolve(a)},u)}),s.promise},f=function(e,t,r,i,s,u,a,l){var h={storyMap:e,useExistingMedia:!1},p=n.scan(h);p.then(function(e){u.aborted||(e.allClear||u.numWithIssues++,r.push(e.storyMap),o.updateNumScanned(r.length,a),i[e.storyMap.id].resolve(e),s(),t.length&&(f(t[0],t,r,i,s,u,a),t.splice(0,1)))},function(){c(i[e.id],u,l,r,a)})},l=function(e,t,n,r,i){e.aborted=!0,o.onScanStopped(t.length,i,e.numWithIssues),setTimeout(function(){h(r,t,i)},u)},c=function(e,t,n,r,i){e.reject();if(t.aborted===!0)return;t.aborted=!0,o.onScanError(),setTimeout(function(){h(n,r,i)},u)},h=function(e,t,n){e.reject(t),o.exitScanMode(n)};return{scanAllStories:a}}),define("my/helpers/SocialShare",[],function(){"use strict";var e=function(){window.fbAsyncInit=function(){FB.init({appId:app.cfg.facebook.appId,cookie:!0,xfbml:!0,version:"v2.4"})},function(e,t,n){var r,i=e.getElementsByTagName(t)[0];if(e.getElementById(n))return;r=e.createElement(t),r.id=n,r.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(r,i)}(document,"script","facebook-jssdk")},t=function(e,t,r){e.status==="connected"?i(t):e.status==="not_authorized"?n(t):r&&n(t)},n=function(e){FB.login(function(n){t(n,e,!1)},{scope:"publish_actions"})},r=function(e){FB.getLoginStatus(function(n){t(n,e,!0)})},i=function(e){FB.api("https://graph.facebook.com/me/objects/storymaps:story_map","POST",{object:{"og:url":e.url,"og:title":e.title,"og:image":e.thumbnail,"og:description":e.snippet}},function(t){var r="";t&&t.error?(t.error.code===190&&n(e),console.log(t.error)):(r=t.id,s(r))})},s=function(e){FB.ui({method:"share_open_graph",action_type:"storymaps:create",action_properties:JSON.stringify({story_map:e})},function(e){e&&e.error?console.log(e.error):console.log(e)})},o=function(e,t){var n="text="+encodeURIComponent(e)+"&url="+t+"&related=EsriStoryMaps"+"&hashtags=storymap";window.open("https://twitter.com/intent/tweet?"+n,"","toolbar=0,status=0,width=626,height=252")};return e(),{shareFacebook:r,shareTwitter:o}}),define("my/content/scanning/StorySharing",["dojo/promise/all","dojo/Deferred","my/content/tabs/MapsSharing","my/content/scanning/Scanner","my/content/scanning/StoryUI","my/content/Templater","my/helpers/UIHelper","my/helpers/AnimationHelper"],function(e,t,n,r,i,s,o,u){"use strict";var a=function(e){var n=new t,i=e.targetAccess,s=e.premiumDeferred,o={},a=r.getStoryMedia(),c={},h={},p=[];return i==="private"?(h=f(a,i,!1),h.then(function(e){var t={storyMap:e,storyAndContent:!1};n.resolve(t)},function(){n.reject({isSharingError:!0})})):(c={storyMap:a.storyMap,useExistingMedia:!0,targetAccessLevel:i,updateUI:!1,premiumDeferred:s},o=r.scan(c),o.then(function(e){e.allClear?(p=e.issues.yoursSharedBelowLevel.items,p.length>0?l(n,e,i,a.id):(h=f(e,i,!1),h.then(function(e){var t={storyMap:e,storyAndContent:!1};n.resolve(t)},function(){n.reject({isSharingError:!0})}))):(u.pulsateNotification(e.id),n.reject({isSharingError:!0,needsUserInput:!0}))},function(){n.reject({isSharingError:!1})})),n.promise},f=function(e,u,a){var f=new t,l=n.updateItemSharing(u,e.id,"storyMap",e),c={},h=null;return l.then(function(e){a?f.resolve(e.storyObj.storyMap):(i.updateStoryMapUI(e.storyObj.storyMap.accessLevel,e.itemId),c={storyMap:e.storyObj.storyMap,useExistingMedia:!0},h=r.scan(c),h.then(function(){f.resolve(e.storyObj.storyMap)},function(){f.resolve(e.storyObj.storyMap)}))},function(){c={storyMap:e.storyMap,useExistingMedia:!0},h=r.scan(c),h.then(function(){s.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevel,e.id),o.showErrorNotification(e.id),f.reject()},function(){s.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevel,e.id),o.showErrorNotification(e.id),f.reject()})}),f.promise},l=function(t,n,s,u){var a={},l={},c=[],h=null;a=r.changeBulkItemSharing(s,n,!0),c.push(a),l=f(n,s,!0),c.push(l),e(c).then(function(e){var n=e[0].changedMapLayers,s=r.checkSharedItemsType(n),u=e[0].expandedMaps,a=e[1],f={storyMap:a,useExistingMedia:!0},l={storyMap:a,storyAndContent:!0,changedItemsType:s};h=r.scan(f),h.then(function(){o.emptyExpandedMaps(a.id);for(var e=0;e<u.length;e++)o.toggleLayers(u[e],a.id,!1);o.updateSharedRows(n,!0),i.updateStoryMapUI(a.accessLevel,a.id),o.reEnableButtons(a.id),t.resolve(l)},function(){o.emptyExpandedMaps(a.id);for(var e=0;e<u.length;e++)o.toggleLayers(u[e],a.id,!1);o.updateSharedRows(n,!0),i.updateStoryMapUI(a.accessLevel,a.id),o.reEnableButtons(a.id),t.resolve(l)})},function(){o.reEnableButtons(u),t.reject({isSharingError:!0})})};return{share:a}}),define("my/helpers/InlineEditing",["my/models/Item","my/helpers/UIHelper","my/helpers/Formatter","my/content/Templater","my/helpers/AnimationHelper"],function(e,t,n,r,i){"use strict";var s="",o="",u=function(e){a(e),f(e)},a=function(e){var t=$('.item[data-id="'+e.id+'"] .item-title'),n=250;t.attr("contentEditable",!0),t.off("keydown").on("keydown",function(e){e.keyCode===13&&(e.preventDefault(),t.blur()),l(t,e,n)}),h(t,n),t.off("focusin").on("focusin",function(){s=$(this).html()}),t.off("focusout").on("focusout",function(n){var r=t.text(),o={title:r};t.html("&nbsp;"),setTimeout(function(){t.text(r)},1),o.title!==""&&s!==o.title&&(p(n,t,e,o),t.removeClass("editing"),t.addClass("saved-successfully"),i.animateHideSuccessBorder(t,function(){t.addClass("editing")})),s=o.title})},f=function(e){var t='.item[data-id="'+e.id+'"]',n=$(t+" .item-summary"),r=250;n.attr("contentEditable",!0),n.off("keydown").on("keydown",function(e){e.keyCode===13&&(e.preventDefault(),n.blur()),l(n,e,r)}),h(n,r),n.off("focusin").on("focusin",function(){var e="";$(this).html()===i18n.storyMap.placeholders.noSummary&&$(this).html(""),e=$(this).html().replace(/<.*?>/g,""),$(this).html(e),o=$(this).html()}),n.off("focusout").on("focusout",function(t){var r={snippet:n.text()};r.snippet===""&&n.html(i18n.storyMap.placeholders.noSummary),n.removeClass("limit-reached"),r.snippet!==o&&(p(t,n,e,r),n.removeClass("editing"),n.addClass("saved-successfully"),i.animateHideSuccessBorder(n,function(){n.addClass("editing")})),o=r.snippet})},l=function(e,t,n){var r=e.text().length>=n,i=c(t.keyCode);r&&i?(e.addClass("limit-reached"),t.preventDefault()):e.removeClass("limit-reached")},c=function(e){var t=!1;if(e===32||e>=46&&e<=90||e>=96&&e<=111||e>=186&&e<=222)t=!0;return t},h=function(e,t){e.off("paste").on("paste",function(){var r=e.css("height");e.css("max-height",r),e.css("opacity",0),setTimeout(function(){var r=n.cleanHtmlText(e.html());r.length>t&&(r=r.slice(0,t)),e.html(r),e.css("opacity",1)},100)})},p=function(t,n,r,s){var o="",u="";s.title?u=i18n.content.errors.errorUpdatingTitle:s.snippet&&(u=i18n.content.errors.errorUpdatingSummary),n[0]===t.target&&(o=e.updateItem(r,s),o.then(function(){},function(){var e=null;s.title?e=$('.item[data-id="'+r.id+'"] .item-title-error-message'):s.snippet&&(e=$('.item[data-id="'+r.id+'"] .item-snippet-error-message')),n.removeClass("saved-successfully"),n.addClass("error"),e.css("display","block"),i.animateHideErrorBorder(n,e)}))};return{addInlineEditingEvents:u}}),define("my/content/DummyStories",["my/helpers/Formatter","my/content/StoriesList"],function(e,t){"use strict";var n=function(){var t=[{thumbnail:"assets/images/my-stories/placeholders/realOne.png",accessLevel:"organization",title:"Resilient Cities",type:"Map Journal",modifiedStr:e.formatModifiedString(new Date(1423008e6)),numViewsStr:e.formatNumViews(6430),allClear:!0},{thumbnail:"assets/images/my-stories/placeholders/mts.png",accessLevel:"public",title:"Explore a Tapestry of World Ecosystems",type:"Map Series",modifiedStr:e.formatModifiedString(new Date(14284512e5)),numViewsStr:e.formatNumViews(20870),allClear:!0},{thumbnail:"assets/images/my-stories/placeholders/realTwo.png",accessLevel:"private",title:"A Breakthrough in Global Satellite Coverage",type:"Map Journal",modifiedStr:e.formatModifiedString(new Date(14259456e5)),numViewsStr:e.formatNumViews(34),allClear:!0},{thumbnail:"assets/images/my-stories/placeholders/boat.png",accessLevel:"public",title:"Oceanic Expeditions",type:"Map Tour",modifiedStr:e.formatModifiedString(new Date(1431648e6)),numViewsStr:e.formatNumViews(567),allClear:!0},{thumbnail:"assets/images/my-stories/placeholders/forest.png",accessLevel:"public",title:"Modeling Forestry Change",type:"Map Series",modifiedStr:e.formatModifiedString(new Date(14345856e5)),numViewsStr:e.formatNumViews(2389),allClear:!0}];return t},r=function(){var e=n();t.storiesListToScreen(e,!1,!1)};return{renderDummyStories:r}}),define("my/content/NetworkManager",[],function(){"use strict";return function(e){var t=[],n=0,r=0,i=function(e){r=e},s=function(e){t.push(e),o()},o=function(){var e=null;n<r&&t.length&&(e=t.shift(),n++,u(e))},u=function(e){var t=e.request(e.item);t.then(function(t){e.deferred.resolve(t),n--,o()},function(){e.deferred.reject(),n--,o()})};return i(e),{addRequest:s}}}),define("my/content/GetStoriesManager",["my/models/Credentials"],function(e){"use strict";return function(t){var n=t.batchReturnedCallback,r=t.batchErrorCallback,i=t.allLoadedCallback,s=t.queryString,o=t.numInBatch,u=t.numInFirstBatch?t.numInFirstBatch:t.numInBatch,a=1,f=0,l=0,c=e.getCredentials(),h=function(e){var t=e?u:o,i={q:s,num:t,start:a,sortField:"modified",sortOrder:"desc"};c.portal.queryItems(i).then(function(r){f===0&&(f=r.total),n({results:r,isFirstTime:e}),l+=t,a+=t,p()}).otherwise(function(e){r(e)})},p=function(){l<f?h(!1):i()};return{getStories:h}}}),define("my/helpers/FolderHelper",["dojo/Deferred","dojo/promise/all"],function(e,t){"use strict";var n=function(t){var n=new e,i=t.getPortalUser(),s=null,o=i.getFolders();return o.then(function(e){s=r(e,i),s.then(function(e){n.resolve(e)})},function(){n.resolve()}),n.promise},r=function(n,r){var i=new e,s={},o=[],u=null;for(var a=0;a<n.length;a++)u=r.getItems(n[a].id),o.push(u),u.then(function(e){var t=null;for(var n=0;n<e.length;n++)t=e[n],t.type==="Web Mapping Application"&&(s[t.id]=t.userItemUrl)},function(){});return t(o).then(function(){i.resolve(s)}),i.promise};return{compileFolderList:n}}),define("my/content/dialogs/FindMoreDialog",["dojo/Deferred","dojo/promise/all","dojo/parser","dijit/registry","my/content/GetStoriesManager","my/models/Credentials","my/content/NetworkManager","my/models/Item","my/helpers/FolderHelper","my/content/Templater"],function(e,t,n,r,i,s,o,u,a,f){"use strict";return function(l,c){var h=(new Date("December 12, 2014")).getTime(),p=100,d=2e3,v=[],m=null,g=new o(app.cfg.CONCURRENT_SCAN_REQUESTS),y=null,b=null,w=null,E=function(){y.footerButtons.addClass("inactive")},S=function(){y.updateAllButton.removeClass("inactive")},x=function(){y.updateAllButton.addClass("inactive")},T=function(){y.closeButton.removeClass("inactive")},N=function(){y.modalContainer.removeClass("disabled-click")},C=function(){y.modalContainer.addClass("disabled-click")},k=function(){O(),f.templatizeLoading($("#find-loader-title"),b.gettingStories,!0),x(),T(),L(y.loaderPanel),M()},L=function(e){e===y.updateTablePanel&&(A(),S()),$(".dynamic-component").removeClass("active"),e.addClass("active")},A=function(){f.templatizeUpdateTable(v)},O=function(){y={modalContainer:$("#modal-container-find-stories"),footerButtons:$("#modal-container-find-stories .modal-bottom-button"),closeButton:$("#close-find"),updateAllButton:$("#update-all"),loaderPanel:$("#find-searching-stories"),allUpdatedPanel:$("#find-all-good"),updateTablePanel:$("#find-update-summary"),errorLoadingPanel:$("#find-error-searching"),updateProgressPanel:$("#find-update-progress"),updateCompletePanel:$("#find-update-complete"),updateErrorPanel:$("#find-error-updating")},b=i18n.cantFindStories},M=function(){y.updateAllButton.off("click").on("click",function(e){if($(e.currentTarget).hasClass("inactive")){e.preventDefault();return}L(y.updateProgressPanel),J()})},_=function(){var e="update-progress-bar",t="updateProgressBar",i=r.byId(e),s=b.updatingNumberOfNumber.replace(/{{CURRENT_NUMBER}}/,1).replace(/{{TOTAL}}/,v.length),o="stop-update",u=null;C(),E(),u=f.templatizeProgressBar({progressBar:i,progressString:null,title:s,progressBarId:e,progressBarDojoId:t,stopId:o}),$("#find-update-progress-bar-container").html(u),n.parse()},D=function(){N(),T(),L(y.updateErrorPanel)},P=function(e){var t=r.byId("update-progress-bar"),n=b.updatingNumberOfNumber.replace(/{{CURRENT_NUMBER}}/,e).replace(/{{TOTAL}}/,v.length);t&&(t.set({value:e/v.length*100}),$("#find-update-progress .progress-title").html(n))},H=function(){var e=r.byId("update-progress-bar");L(y.updateCompletePanel),e&&e.destroy(),setTimeout(function(){w(),B()},d)},B=function(){N(),$("#close-find").click()},j=function(e,t){k(),w=t;var n=F(e);n?L(y.allUpdatedPanel):I()},F=function(e){var t=!1;return e.getTime()>h&&(t=!0),t},I=function(){var e=s.getCredentials(),t=new i({queryString:"owner: "+e.userName+" AND type:Web Mapping Application",batchReturnedCallback:q,batchErrorCallback:W,allLoadedCallback:X,numInBatch:p});t.getStories(!0)},q=function(e){var t=null;for(var n=0;n<e.results.results.length;n++)t=e.results.results[n],R(t)},R=function(e){var t="",n=null,r=!1;r=U(e);if(r)return;t=z(e.url),t&&(n=u.createItem({item:e,type:t,index:0}),v.push(n))},U=function(e){var t="";for(var n=0;n<e.typeKeywords.length;n++){t=e.typeKeywords[n];switch(t.toLowerCase()){case"story maps":return!0;default:}}return!1},z=function(e){var t="",n=null,r="";return n=/^(.+)\/apps\/(MapTour|MapJournal|MapSeries|StorytellingSwipe)\//.exec(e),n&&n.length>0&&(r=n[2],r==="MapTour"?t="Map Tour":r==="MapJournal"?t="Map Journal":r==="MapSeries"?t="Map Series":r==="StorytellingSwipe"?t="Swipe/Spyglass":t=""),t},W=function(){L(y.errorLoadingPanel)},X=function(){var e=s.getCredentials(),t=null;t=a.compileFolderList(e.portal),t.then(function(e){m=e,V(),v.length===0?L(y.allUpdatedPanel):L(y.updateTablePanel)})},V=function(){var e=null;for(var t=0;t<v.length;t++)e=v[t],e.userItemUrl=m[e.id]},J=function(){var n=null,r=null,i=[],s=[],o="",u=0;_();for(var a=0;a<v.length;a++)r=new e,n=v[a],s=K(n),o=s.toString(),g.addRequest({item:{storyMap:n,typeKeywords:o},deferred:r,request:Y}),i.push(r.promise),r.promise.then(function(){u++,P(u)},function(){});t(i).then(function(){H()},function(){D()})},K=function(e){var t=[],n=[],r=[];return n=Q(e.type),r=e.typeKeywords.concat(n),t=G(r),t},Q=function(e){var t=[],n=["Map Tour","MapTour"],r=["MapJournal"],i=["SwipeSpyglass"],s=["MapSeries"],o=["JavaScript","Map","Mapping Site","Online Map","Ready To Use","selfConfigured","Web Map","Story Map","Story Maps"];switch(e){case"Map Tour":t=n;break;case"Map Journal":t=r;break;case"Map Series":t=s;break;case"Swipe/Spyglass":t=i;break;default:}return t=t.concat(o),t},G=function(e){var t="";return t=$.grep(e,function(t,n){return n===$.inArray(t,e)}),t},Y=function(t){var n=new e,r=t.storyMap,i=t.typeKeywords,s=null;return s=u.updateItem(r,{typeKeywords:i}),s.then(function(){n.resolve()},function(){n.reject()}),n.promise};return j(l,c),{}}}),define("my/content/scanning/CacheManager",[],function(){"use strict";var e=null;return function(){var t=function(){e={maps:{},images:{},videos:{}}},n=function(t,n){var r=null;return e[t]&&e[t][n]&&(r=e[t][n]),r},r=function(t,n,r){e[t]&&(e[t][n]=r)};return t(),{getFromCache:n,updateCache:r}}}),define("my/MyStories",["dojo/on","dojo/has","dojo/Deferred","dojo/promise/all","dojo/io-query","esri/config","esri/arcgis/utils","esri/arcgis/Portal","esri/arcgis/OAuthInfo","esri/IdentityManager","esri/request","my/models/Credentials","my/models/Item","my/content/dialogs/ShareDialog","my/content/scanning/Scanner","my/content/scanning/ScanAll","my/content/Templater","my/helpers/Formatter","my/helpers/FilterSort","my/helpers/UIHelper","my/helpers/SocialShare","my/content/StoriesList","my/content/scanning/StorySharing","my/content/tabs/Tags","my/models/Issue","my/helpers/InlineEditing","my/helpers/AnimationHelper","my/content/DummyStories","my/content/dialogs/ImagePicker","my/helpers/CookieHelper","my/content/NetworkManager","my/content/dialogs/FindMoreDialog","my/content/GetStoriesManager","my/helpers/FolderHelper","my/content/ExpandedStory","my/content/scanning/CacheManager"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,N,C,k,L,A,O,M,_,D,P,H,B){"use strict";s.defaults.io.timeout=app.cfg.TIMEOUT_MILLISECONDS,s.defaults.io.proxyUrl="//www.arcgis.com/sharing/proxy",s.defaults.alwaysUseProxy=!1;var j=5,F=100,I=10,q=[],R=[],U=0,z="",W=null,X=null,V=function(){q=[],R=[],H.setExpandedStory({}),U=0,z="",W=null,X=null},J=function(){var e=window.signInManager.checkIfSignedIn(),r=null;N.init(),window.builderIntegration||($("#find-more-container").hide(),t("ie")&&t("ie")<10&&$("#search").val(i18n.header.searchStories)),window.builderIntegration?(window.init=function(e,t,r,i,s){var u=null,a=null,l=new n;return window.sectionClickCallback=r,window.editMapCallback=i,app.cfg.cacheManager=new B,f.initialize(e),u={isFirstTime:!0,results:{total:1,results:[t]}},o.arcgisUrl=e.credentials[0].server+"/sharing/content/items",at(u),W=q[0],a={userName:e.credentials[0].userId,token:e.credentials[0].token,portal:null,orgId:O.getAccountId(),groups:[],firstName:"",accountCreatedDate:e.credentials[0].creationTime},c.setCredentials(a),app.cfg.scanNetworkManager=new M(app.cfg.CONCURRENT_SCAN_REQUESTS),app.cfg.proxyNetworkManager=new M(app.cfg.CONCURRENT_PROXY_REQUESTS),l.resolve(),l.promise},window.check=function(e){Q();var t=new n,r=null,i=null;return Tt(W.id),b.emptyMediaContainers(W.id),b.showBySharingLevel(W.id,W.accessLevel),b.expandStory(W.id),H.setExpandedStory(W),r={storyMap:W,useExistingMedia:!1,existingItemData:e},i=d.scan(r),i.then(function(e){X=e,kt(e),e.allClear?t.resolve():t.reject(!0),K()},function(){b.showContentErrorMessage(W.id),b.restrictMapLayerSharing(W.id,W.accessLevel),t.reject(!1),K()}),t.promise},window.share=function(e){var t=new n,r=new n,i=new n,s='.item[data-id="'+X.id+'"] .story-sharing',o=Mt({targetAccess:e,baseSelector:s,storyObj:X,premiumDeferred:r}),u={targetAccess:e,message:"",successful:!1,needsUserInput:!1,storyAndContent:!1,delayPromise:i.promise,allClear:!1};return r.promise.then(function(t){G(i,t,e,u)},function(e){Y(i,e,u)}),o.then(function(n){G(t,n,e,u)},function(e){Y(t,e,u)}),t.promise},window.parent&&window.parent.myStoriesInit&&window.parent.myStoriesInit()):e?(r=window.signInManager.getUserCookie(),et(r)):(window.signInManager.showSignInDialog(et,!1),L.renderDummyStories(),$("#sign-in-container").off("click"))},K=function(){$("#builder-loading").css("display","none"),$("#builder-container").css("display","block")},Q=function(){$("#builder-loading").css("display","block"),$("#builder-container").css("display","none")},G=function(e,t,n,r){r.storyAndContent=t.storyAndContent,r.successful=!0,r.message=g.formatNotificationString(n,"story",t.storyAndContent,t.premiumContent,t.subscriptionContent,t.changedItemsType),r.allClear=t.storyMap.allClear,e.resolve(r)},Y=function(e,t,n){t.needsUserInput&&(n.needsUserInput=!0),n.message=t.message,n.allClear=t.storyMap.allClear,e.reject(n)},Z=function(){o.arcgisUrl="https://"+O.getAccountBaseUrl()+"/sharing/content/items"},et=function(e){Z(),tt(e.email),$("#item-list").empty(),st()},tt=function(e){var t=it();f.registerToken({expires:t,server:o.arcgisUrl.split("/sharing/")[0],ssl:!1,token:rt(),userId:e}),nt()},nt=function(){f.on("dialog-create",function(e){var t=O.fetchCookie("esri_auth"),n=JSON.parse(t);n.expires<=Date.now()?window.location=window.location:e.target._busy.reject()})},rt=function(){var e=window.signInManager.fetchCookie("esri_auth");if(!e)return;return e=JSON.parse(e.replace('"ssl":undefined','"ssl":""')),e?e.token:null},it=function(){var e=JSON.parse(window.signInManager.fetchCookie("esri_auth")),t=e.expires,n=20736e5,r=Date.now()+n,i=0;return t>r?i=r:t<=Date.now()?i=r:i=t,i},st=function(){var e=new u.Portal(o.arcgisUrl.split("/sharing/")[0]);e.on("load",function(){ot(e)})},ot=function(e){e.signIn().then(function(e){var t={userName:e.username,orgId:e.orgId,token:e.credential.token,portal:e.portal,firstName:e.firstName,accountCreatedDate:e.created};c.setCredentials(t),V(),ut()}).otherwise(function(e){console.log("error",e)})},ut=function(){z=i.queryToObject(window.location.search.substring(1)).itemId;var e=c.getCredentials(),n=window.builderIntegration?"id:"+z:"owner: "+e.userName+" AND typekeywords:Story Maps AND type:Web Mapping Application",r=new D({queryString:n,batchReturnedCallback:at,batchErrorCallback:ft,allLoadedCallback:dt,numInBatch:F,numInFirstBatch:j}),s=null;app.cfg.scanNetworkManager=new M(app.cfg.CONCURRENT_SCAN_REQUESTS),app.cfg.proxyNetworkManager=new M(app.cfg.CONCURRENT_PROXY_REQUESTS),ht(e.firstName),t("ie")&&t("ie")<I?($(".header-fadeable-tooltip").addClass("no-show"),$("#page-loader").css("display","none"),m.templatizeError({incompatibleBrowser:!0,version:I})):(window.initCropit(window.jQuery),y.initBloodhound(q.slice()),s=P.compileFolderList(e.portal),s.then(function(e){app.cfg.folderWebApps=e}),r.getStories(!0))},at=function(e){var t=lt(e.results.results),n=!1;q=q.concat(t),e.isFirstTime&&(n=!0,b.updateNumStories(e.results.total),window.allLoadedTime=new Date,console.log("story loaded, clicking: "+((window.allLoadedTime-window.initialLoadTime)/1e3).toFixed(1)+" seconds")),ct(t,n,!1)},ft=function(e){m.templatizeError({inaccessible:!0}),console.log(e),$("#page-loader").css("display","block")},lt=function(e){var t=[],n={item:{},index:0};for(var r=0;r<e.length;r++){n.item=e[r],n.index=U++;var i=h.createItem(n);x.init(i),t.push(i)}return t},ct=function(e,t,n){E.storiesListToScreen(e,t,n),wt()},ht=function(e){var t=null;m.templatizeHeader(e),t=$("#create-story-btn"),t.on("click",function(e){$(e.currentTarget).hasClass("create-story-disabled")&&(e.preventDefault(),$("#modal-container-create-story").click())}),$("#header-container").css("display","none"),$("#header-container").fadeIn(800),$("#page-loader .progress-title").html(i18n.loading.loadingText),window.CreateStoryDialog&&pt(t,null),Et()},pt=function(e,t){new window.CreateStoryDialog,e&&e.length&&(e.removeClass("create-story-disabled"),$(".create-disabled-tooltip.create-story").addClass("no-show"),e.on("click",function(){new window.CreateStoryDialog})),t&&t.length&&(t.removeClass("create-story-disabled"),$(".create-disabled-tooltip").addClass("no-show"),t.on("click",function(){new window.CreateStoryDialog}))},dt=function(){var e={sortType:"modified",reversed:!1};y.add(q.slice()),R=q.slice(),R=y.sort(R,e,!1),$("#page-loader").css("display","none"),m.templatizeWhereAreStories(),m.templatizeFindMoreStoriesDialog(),$("#find-more-container").show(),T.modal();var t=$("#find-more-button");t.off("click").on("click",function(){var e=c.getCredentials();new _(e.accountCreatedDate,_t)}),$(".header-fadeable").removeClass("header-disabled"),$(".header-fadeable-tooltip").addClass("no-show"),$("#scan-all-stories").off("click").on("click",function(e){if($(e.currentTarget).hasClass("header-disabled")){e.preventDefault();return}var t=R.slice(0),n=R.slice(0),r=q.length,i=v.scanAllStories(t,wt,r);$('.dropdown-option[data-criteria="all-clear"]').css("display","block"),i.then(function(e){vt(e,n,!1)},function(e){vt(e,n,!0)})})},vt=function(e,t,n){var r=[],i=!1,s={sortType:"all-clear",reversed:!1},o=y.getSearchTerm(),u=o?!0:!1,a=y.getFilterCriteria(),f=a.length?!0:!1,l=f||u;b.updateSortedBy("");if(n){for(var c=0;c<t.length;c++){i=!1;for(var h=0;h<e.length;h++)t[c].id===e[h].id&&(i=!0);i===!1&&r.push(t[c])}e=e.concat(r)}R=e.slice(0),y.clearSortedBy(),R=y.sort(R,s,!1),b.updateSortedBy("all-clear"),E.storiesListToScreen(R,!0,l),wt()},mt={hideItem:function(e){var t=H.getExpandedStory();e.stopPropagation(),Tt(t.id)},deleteItem:function(){var e=H.getExpandedStory(),t=c.getCredentials(),n={item:e,user:t.userName,success:function(){q.splice(e.index,1),gt(q.slice()),y.reseedSuggestions(q.slice()),b.updateNumStories(q.length),R=q.slice(),ct(R,!0,!1)},error:function(t){t?(m.templatizeErrorNotification(i18n.storyMap.cantBeDeleted,e.id),b.showErrorNotification(e.id)):(m.templatizeErrorNotification(i18n.storyMap.errors.cantDeleteStory,e.id),b.showErrorNotification(e.id))}};h.deleteItem(n)}},gt=function(e){var t={},n=-1;for(var r=0;r<e.length;r++)t=e[r],n=r,h.updateItemIndex(t,n)},yt=function(){$(".item").off("click").on("click",function(){window.builderIntegration||Nt($(this))})},bt=function(){$(".item").off("click")},wt=function(){yt(),$(".item").hover(function(){$(this).addClass("hovered")},function(){$(this).removeClass("hovered")}),$(".item-close").off("click").on("click",mt.hideItem),$(".facebook-share").off("click").on("click",function(){var e=H.getExpandedStory();if($(this).hasClass("disabled")||$(this).hasClass("temp-disabled"))return;w.shareFacebook(e)}),$(".twitter-share").off("click").on("click",function(){var e=H.getExpandedStory();if($(this).hasClass("disabled")||$(this).hasClass("temp-disabled"))return;w.shareTwitter(e.title,e.url)})},Et=function(){$("#search").off("keydown").on("keydown",function(e){if($(e.currentTarget).hasClass("header-disabled")){e.preventDefault();return}}),$("#search").off("keyup").on("keyup",function(e){if($(e.currentTarget).hasClass("header-disabled")){e.preventDefault();return}var t=$(this).val(),n=!0,r=y.getSearchTerm();y.filterResults(t,q.slice(),function(e,i,s){R=e.items,s?n=!1:!r&&t&&b.showClearButton(),b.updateSearchResultCount(R.length),ct(R,i,n),e.clearList&&b.hideClearButton()})}),$("#sort-button").off("click").on("click",function(e){if($(e.currentTarget).hasClass("header-disabled")){e.preventDefault();return}return $("#sort-dropdown").css("display","inline-block"),bt(),$("#filter-dropdown").hide(),$("body > *").not("#sort-dropdown").off("click").on("click",function(){return $("#sort-dropdown").hide(),$("body > *").not("#sort-dropdown").off("click"),yt(),!1}),!1}),$("#sort-dropdown .dropdown-option").off("click").on("click",function(){var e={sortType:$(this).data("criteria"),reversed:!1};return R=y.sort(R,e,!0),ct(R,!0,!1),b.updateSearchResultCount(R.length),b.updateSortedBy(e.sortType),$("#sort-dropdown").hide(),!1}),$("#filter-button").off("click").on("click",function(e){if($(e.currentTarget).hasClass("header-disabled")){e.preventDefault();return}return $("#filter-dropdown").css("display","inline-block"),bt(),$("#sort-dropdown").hide(),$("body > *").not("#filter-dropdown").off("click").on("click",function(){return $("#filter-dropdown").hide(),$("body > *").not("#filter-dropdown").off("click"),yt(),!1}),!1}),$("#filter-dropdown .dropdown-option").off("click").on("click",function(){var e=$(this).data("category"),t=$(this).data("value"),n={category:e,value:t},r=y.checkIsInFilterCriteria(n),i=null,s=null,o=y.getSortedBy(),u=q.slice();return b.updateFilteredBy(n),r?s=y.removeFilter(n,u):(i=y.getCriteriaByCategory(e),i&&(b.updateFilteredBy(i),s=y.removeFilter(i,u),R=s.items),s=y.addFilter(n,R)),R=y.sort(s.items,o,!1),s.clearList&&b.hideClearButton(),b.updateSearchResultCount(R.length),ct(R,!0,!0),bt(),!1}),$("#clear-button").off("click").on("click",function(e){if($(e.currentTarget).hasClass("header-disabled")){e.preventDefault();return}R=q.slice(),ct(R,!0,!1),St()}),$("#my-stories-header").off("click").on("click",function(e){var t=H.getExpandedStory();!$(e.target).hasClass("btn")&&e.target!==$("#search")[0]&&e.target.parentElement!==$("#sort-button")[0]&&e.target.parentElement.parentElement!==$("#sort-button")[0]&&t&&t.id&&Tt(t.id)}),$("#list-container").off("click").on("click",function(e){var t=H.getExpandedStory();e.target===e.currentTarget&&t&&t.id&&Tt(t.id)})},St=function(){y.clearSortedBy(),b.updateSortedBy(""),y.clearFilterCriteria(),b.updateFilteredBy(null),$("#search").val(""),y.clearSearch(),b.hideClearButton()},xt=function(e){var t=null,n=-1,r={};if(!e.className)return null;$(e).hasClass("item")?t=e:t=$(e).parents(".item"),n=$(t).data("index");if(typeof n=="number"||typeof parseInt(n,10)=="number")r=q[n];return r},Tt=function(e){b.collapseStory(e),b.resetContentDefaults(e),A.destroy(),H.setExpandedStory({})},Nt=function(e){var t=$(".expanded"),n=xt(e[0]),r=c.getCredentials(),i=r.portal.getPortalUser(),s=H.getExpandedStory();if(t.data("index")===e.data("index"))return;Tt(s.id),n&&(app.cfg.folderWebApps?(n.userItemUrl=app.cfg.folderWebApps[n.id],Ct(n,r)):i.getItem(n.id).then(function(e){e.ownerFolder&&(n.userItemUrl=e.userItemUrl),Ct(n,r)},function(){Ct(n,r)}))},Ct=function(e,n){var r={},i={},s=$('.item[data-id="'+e.id+'"] .item-delete'),o=null,u=$('.item[data-id="'+e.id+'"] .share-dialog-button'),a=null,f=null,l=!1,c=-1;f=$('.item[data-id="'+e.id+'"]'),b.emptyMediaContainers(e.id),b.showBySharingLevel(e.id,e.accessLevel),b.expandStory(e.id),H.setExpandedStory(e),f.find(".item-edit").on("click",function(e){$(this).hasClass("temp-disabled")&&e.preventDefault()}),f.find(".item-view-live").on("click",function(e){$(this).hasClass("temp-disabled")&&e.preventDefault()}),At(),C.addInlineEditingEvents(e),m.templatizeTags(e,e.id),x.showCollectionTag(e.collectionTag),$(f).find(".content-loader").css("display","block"),m.templatizeDeleteDialog(),m.templatizeImagePicker(),typeof window.FileReader=="undefined"&&(l=!0,c=t("ie")),t("ie")&&t("ie")===10&&(l=!0,c=10),A.init(e,$("#image-previous"),$("#image-next"),$("#carousel-image-and-text"),$("#carousel-image"),$("#loading-prompt"),$("#empty-prompt"),$("#error-prompt"),$("#no-image-prompt"),function(){Lt(f)},l,c),$("#modal-image-picker").data("item-id",e.id),e.hasOwnImage||(f.find(".photo-text").addClass("placeholder"),f.find(".photo-text").html(i18n.storyMap.imagePicker.uploadImage)),f.find(".photo-bottom-overlay").css("display","block"),p.init(e),T.modal(),$("#delete-confirm").off("click").on("click",mt.deleteItem),o=$(".delete-modal .modal-dismiss, #delete-confirm"),a=$("#close-share"),s.on("click",function(e){$(e.currentTarget).hasClass("temp-disabled")&&(e.preventDefault(),$("#delete-cancel").click())}),u.on("click",function(e){if($(e.currentTarget).hasClass("disabled")||$(e.currentTarget).hasClass("temp-disabled"))e.preventDefault(),a.click()}),f.find(".photo-bottom-overlay").hover(function(){f.find(".photo-text:not(.placeholder)").css("display","inline-block")},function(){f.find(".photo-text:not(.placeholder)").css("display","none")}),b.handleNoOrg(n),i={storyMap:e,useExistingMedia:!1},r=d.scan(i),r.then(function(e){kt(e)},function(){b.showContentErrorMessage(e.id),b.restrictMapLayerSharing(e.id,e.accessLevel),A.setImages(null)})},kt=function(e){window.scanTime=new Date,console.log("scan done: "+((window.scanTime-window.initialLoadTime)/1e3).toFixed(1)+" seconds");var t=[],n=e.media.images,r=$("#modal-image-picker").data("item-id");Ot(e);for(var i=0;i<q.length;i++)if(q[i].id===e.id){q[i]=e.storyMap;break}b.restrictMapLayerSharing(e.id,e.storyMap.accessLevel),n?t=A.convertToPickerImages(n.items):t=[],r===e.id&&A.setImages(t)},Lt=function(e){e.find(".photo-text").removeClass("placeholder"),e.find(".photo-text").html(i18n.storyMap.imagePicker.chooseImage)},At=function(){$(".expanded .item-photo").off("click").on("click",function(){var e=H.getExpandedStory();window.open(e.url)})},Ot=function(e){var t='.item[data-id="'+e.id+'"] .story-sharing',n=null;$(t).off("click").on("click",function(r){var i=$(r.target).data("sharing");if($(r.currentTarget).hasClass("locked")||$(r.currentTarget).hasClass("temp-disabled")){r.preventDefault();return}n=Mt({targetAccess:i,baseSelector:t,storyObj:e}),n.then(function(){},function(){})})},Mt=function(e){var t=new n,r=e.premiumDeferred,i=e.targetAccess,s=$(e.baseSelector+".active").data("sharing"),o=e.storyObj,u={},a=null,f=null,l=d.checkIfOnlyIssueSubscription(o);return i!==s?(b.disableFadeableButtons(o.id),i==="public"&&l?(a={storyMap:o.storyMap,useExistingMedia:!0,targetAccessLevel:i,updateUI:!1,premiumDeferred:r},f=d.scan(a),f.then(function(e){e.allClear?d.addProxyBulkShare(t,o,i,!1,!1):(k.pulsateNotification(e.id),t.reject({message:i18n.content.errors.cantChangeSharingLevels,needsUserInput:!0,storyMap:e.storyMap}))},function(){m.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevels,o.id),b.showErrorNotification(o.id),b.reEnableButtons(o.id),b.restrictMapLayerSharing(o.id,o.storyMap.accessLevel),t.reject({message:i18n.content.errors.cantChangeSharingLevels,storyMap:o.storyMap})})):(u=S.share({targetAccess:i,premiumDeferred:r}),u.then(function(e){var n=e.storyMap,r=g.formatNotificationString(n.accessLevel,"story",e.storyAndContent,!1,!1,e.changedItemsType);m.templatizeSuccessNotification(n.id,r),b.showSuccessNotification(n.id,e.storyAndContent?!0:!1),b.reEnableButtons(o.id),b.showBySharingLevel(n.id,n.accessLevel),b.restrictMapLayerSharing(n.id,n.accessLevel),t.resolve(e)},function(e){e.isSharingError?(b.reEnableButtons(o.id),b.restrictMapLayerSharing(o.id,o.storyMap.accessLevel)):(m.templatizeErrorNotification(i18n.content.errors.cantChangeSharingLevels,o.id),b.showErrorNotification(o.id),b.reEnableButtons(o.id),b.restrictMapLayerSharing(o.id,o.storyMap.accessLevel)),t.reject({message:i18n.content.errors.cantChangeSharingLevels,needsUserInput:e.needsUserInput,storyMap:o.storyMap})}))):t.resolve(),t.promise},_t=function(){window.location.href=window.location.href};return window.onCreateStoryDialogLoaded=pt,{init:J}}),define("my/helpers/EngStrings",[],function(){"use strict";var e={authorsStories:"{{USER_NAME}}'s stories",totalStoriesSingle:"{{NUM_STORIES}} story",totalStoriesPlural:"{{NUM_STORIES}} stories",numViewsSingle:"{{NUM_VIEWS}} view",numViewsPlural:"{{NUM_VIEWS}} views",numResultsSingle:"{{NUM_RESULTS}} result",numResultsPlural:"{{NUM_RESULTS}} results",storiesHaveIssuesSingle:"{{NUM_STORIES}} story has issues",storiesHaveIssuesPlural:"{{NUM_STORIES}} stories have issues",scanStopMessage:"{{NUM_SCANNED}} of {{TOTAL}} stories scanned, {{NUM_ISSUES}} with issues",noStoriesInSearch:"Bummer, we couldn't find any stories.",arcGISOnline:"ArcGIS Online",storyMapTour:"Story Map Tour",mapTour:"Map Tour",journal:"Journal",mapJournal:"Map Journal",mapSeries:"Map Series",basic:"Basic",shorlist:"Shortlist",swipeSpyglass:"Swipe/Spyglass",swipe:"Swipe",spyglass:"Spyglass",facebook:"Facebook",twitter:"Twitter",picasa:"Picasa",flickr:"Flickr",url:"Url",vimeo:"Vimeo",youTube:"YouTube",notApplicable:"n/a",toTranslate:{}};return e}),require(["my/MyStories","my/helpers/EngStrings"],function(){}),define("../../src/BuildConfig",function(){});