/* 
This source is a compressed form of part of the git commit 
ba1aad0121b658b5 2014-02-24 10:26:59 -0800
Uncompressed source is available from https://github.com/Esri/local-government-online-apps 
*/ 
/*

 | ArcGIS Solutions
 | Version 10.2
 | Copyright 2012 Esri
 |
 | Licensed under the Apache License, Version 2.0 (the "License");
 | you may not use this file except in compliance with the License.
 | You may obtain a copy of the License at
 |
 |    http://www.apache.org/licenses/LICENSE-2.0
 |
 | Unless required by applicable law or agreed to in writing, software
 | distributed under the License is distributed on an "AS IS" BASIS,
 | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 | See the License for the specific language governing permissions and
 | limitations under the License.
*/
define("js/lgonlineApp","js/lgonlineBase js/lgonlineCommand js/lgonlineDijit js/lgonlineDrawing js/lgonlineEditing js/lgonlineFrame js/lgonlineMap js/lgonlineOutput".split(" "),function(){return{}});
require({cache:{"js/lgonlineBase":function(){define("js/lgonlineBase","dojo/dom-construct dojo/dom dojo/on dojo/dom-style dojo/dom-class dojo/_base/array dojo/topic dojo/_base/lang".split(" "),function(g,m,n,k,h,c,d,f){dojo.declare("js.LGObject",null,{constructor:function(a){var b,f,c=this;void 0!==a&&dojo.safeMixin(this,a);this.checkPrerequisites&&this.checkPrerequisites();a={};this.rootId&&(a.id=this.rootId);this.rootClass?a.className=this.rootClass:a.style="display:none";void 0!==this.parentDiv?
(b=this.parentDiv,(f=m.byId(b))||(b=null)):b=null;f&&f.getLGObject&&f.getLGObject().addItem?(this.rootDiv=g.create("div",a),f.getLGObject().addItem(this.rootDiv)):this.rootDiv=g.create("div",a,b);this.rootDiv.getLGObject=function(){return c}},getRootDiv:function(){return this.rootDiv},lgById:function(a){var b=null;(a=m.byId(a))&&a.getLGObject&&(b=a.getLGObject());return b},deleteDivFromDom:function(){this.rootDiv&&this.rootDiv.parentNode.removeChild(this.rootDiv)},injectCSS:function(a){var b;b=document.createElement("style");
b.setAttribute("type","text/css");b.styleSheet?b.styleSheet.cssText=a:(a=document.createTextNode(a),b.appendChild(a));document.body.appendChild(b);return b},checkForSubstitution:function(a){var b,f=a;a&&1<a.length&&(b=a.substring(0,1),"@"===b?this.i18n&&(f=this.followAttributePath(this.i18n,a.substring(1))):"."===b&&(f=this.followAttributePath(null,a.substring(1))));return f},followAttributePath:function(a,b){var f,c=a,d;try{d=b.split(".");for(f=0;f<d.length;f+=1)c=null===c?this.lgById(d[f]):c[d[f]]}catch(g){c=
null}return c},toBoolean:function(a,b){var f;if(!0===a)return!0;if(!1===a)return!1;if("string"===typeof a){f=a.toLowerCase();if("true"===f)return!0;if("false"===f)return!1}return void 0===b?!0:b},toNumber:function(a,b){if("number"===typeof a)return a;a=parseFloat(a);return!isNaN(a)?a:void 0===b?0:b},log:function(a,b){console&&console.log(a);b&&this.publishMessage("error",a);window.gLogMessageBox&&window.gLogMessageBox.append(a)},publishMessage:function(a,b){d.publish("publish",{id:this.rootId,tag:a,
data:b});d.publish(a,b)},subscribeToMessage:function(a,b){var f=this;d.subscribe(a,function(b){d.publish("receive",{id:f.rootId,tag:a,data:b})});d.subscribe(a,b)}});dojo.declare("js.LGGraphic",js.LGObject,{constructor:function(){n(window,"resize",f.hitch(this,this.handleWindowResize));this.handleWindowResize()},setIsVisible:function(a,b){b?(k.set(this.getRootDiv(),"display","block"),k.set(this.getRootDiv(),"visibility",a?"visible":"hidden")):(a?this.show():this.hide(),k.set(this.getRootDiv(),"visibility",
"visible"))},getIsVisible:function(){return"none"!==k.get(this.getRootDiv(),"display")},toggleVisibility:function(){this.getIsVisible()?this.hide():this.show()},show:function(){k.set(this.getRootDiv(),"display","block")},hide:function(){k.set(this.getRootDiv(),"display","none")},handleWindowResize:function(){void 0!==this.fill&&!0===this.fill?this.fillParentDiv():void 0!==this.horizOffset&&void 0!==this.vertOffset&&this.alignOver(this.rootDiv,this.rootDiv.parentNode,this.horizOffset,this.vertOffset)},
fillParentDiv:function(){var a;this.rootDiv.parentNode&&(a={left:"0px",top:"0px",width:this.rootDiv.parentNode.clientWidth+"px",height:this.rootDiv.parentNode.clientHeight+"px"},dojo.style(this.rootDiv,a))},alignOver:function(a,b,f,d){var g,k,h,n=this;a&&b&&(g=dojo.marginBox(a),k=dojo.marginBox(b),h={},"number"===typeof f?h=this.insertHorizPositioningStyle(h,f,g,k):"object"===typeof f&&c.forEach(f,function(a){h=n.insertHorizPositioningStyle(h,a,g,k)}),"number"===typeof d?h=this.insertVertPositioningStyle(h,
d,g,k):"object"===typeof d&&c.forEach(d,function(a){h=n.insertVertPositioningStyle(h,a,g,k)}),dojo.style(a,h))},insertHorizPositioningStyle:function(a,b,f,c){0<b?a.left=b+"px":0===b?a.left=Math.round((c.w-f.w)/2)+"px":a.right=-b+"px";return a},insertVertPositioningStyle:function(a,b,f,c){0<b?a.top=b+"px":0===b?a.top=Math.round((c.h-f.h)/2)+"px":a.bottom=-b+"px";return a},applyTheme:function(a,b){h.remove(b||this.rootDiv,"appTheme2");h.add(b||this.rootDiv,"appTheme");a&&h.add(b||this.rootDiv,"appThemeHover")},
applyThemeAltBkgd:function(a,b){h.remove(b||this.rootDiv,"appTheme");h.add(b||this.rootDiv,"appTheme2");a&&h.add(b||this.rootDiv,"appThemeHover")}});dojo.declare("js.LGDependency",null,{constructor:function(){var a,b=this;this.dependencyId&&(a=this.lgById(this.dependencyId),this.onDependencyPrep(a),a.ready.then(function(){b.onDependencyReady()}))},onDependencyPrep:function(){return null},onDependencyReady:function(){return null}});dojo.declare("js.LGDefaults",null,{constructor:function(){this.defaultValues=
{};this.listenForDefaultsTrigger&&this.listenForDefaultsUpdate()},listenForDefaultsUpdate:function(){var a=this;this.subscribeToMessage(this.listenForDefaultsTrigger,function(b){a.defaultValues=b;a.onDefaultsUpdate()})},onDefaultsUpdate:function(){return null},changeDefaults:function(){this.broadcastDefaultsUpdate()},broadcastDefaultsUpdate:function(){this.broadcastDefaultsPublish&&this.publishMessage(this.broadcastDefaultsPublish,this.defaultValues)}})})},"js/lgonlineCommand":function(){define("js/lgonlineCommand",
"dojo/dom-construct dojo/dom dojo/on dojo/Deferred dojo/DeferredList dojo/dom-style dojo/dom-class dojo/_base/array dojo/_base/lang dojo/string dijit/form/TextBox dijit/layout/ContentPane esri/dijit/BasemapGallery esri/dijit/Basemap esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/tasks/LegendLayer esri/dijit/PopupTemplate js/lgonlineBase js/lgonlineMap".split(" "),function(g,m,n,k,h,c,d,f,a,b,p,l,q,s,t,u,v,w,x){dojo.declare("js.LGDropdownBox",js.LGGraphic,{constructor:function(){var e=
this;this.applyTheme(!1);this.isShowable=!0;this.trigger&&(this.subscribeToMessage("command",function(a){a!==e.trigger&&e.setIsVisible(!1)}),this.subscribeToMessage(this.trigger,function(a){e.handleTrigger(a)}))},setShowable:function(e){this.isShowable=e;!this.isShowable&&this.getIsVisible()&&this.toggleVisibility()},handleTrigger:function(){this.isShowable&&this.toggleVisibility()}});dojo.declare("js.LGMapBasedMenuBox",[js.LGDropdownBox,js.LGMapDependency],{constructor:function(){this.ready=new k},
onDependencyReady:function(){this.ready.resolve(this);this.inherited(arguments)}});dojo.declare("js.LGBasemapBox",js.LGMapBasedMenuBox,{onDependencyReady:function(){var e,a,b=this.getBasemapGroup();e=this.rootId+"_gallery";a=(new l({id:e,className:this.galleryClass})).placeAt(this.rootDiv);touchScroll(e);e=(new q({basemaps:[new s({layers:this.mapObj.mapInfo.itemInfo.itemData.baseMap.baseMapLayers,title:this.mapObj.mapInfo.itemInfo.itemData.baseMap.title,thumbnailUrl:this.webmapThumbnail||"images/webmap.png"})],
showArcGISBasemaps:!0,basemapsGroup:b,bingMapsKey:this.mapObj.commonConfig.bingMapsKey,map:this.mapObj.mapInfo.map},g.create("div"))).placeAt(this.rootDiv);a.set("content",e.domNode);e.startup();this.inherited(arguments)},getBasemapGroup:function(){var e=null;this.basemapgroupTitle&&(this.basemapgroupOwner&&0<this.basemapgroupTitle.length&&0<this.basemapgroupOwner.length)&&(e={title:this.basemapgroupTitle,owner:this.basemapgroupOwner});return e}});dojo.declare("js.LGCallMethods",js.LGObject,{constructor:function(){var e,
a=this;this.todo&&f.forEach(this.todo,function(b){try{if(e=m.byId(b.rootId))if(e=e.getLGObject())e[b.method](b.arg)}catch(f){a.log("LGCallMethods_1: "+f.toString())}})}});dojo.declare("js.LGButton",js.LGGraphic,{constructor:function(){var e;this.applyTheme(!0);this.iconUrl&&(e={src:this.iconUrl},this.iconClass&&(e.className=this.iconClass),this.iconImg=g.create("img",e,this.rootDiv));this.displayText&&(e={innerHTML:this.checkForSubstitution(this.displayText)},this.displayTextClass&&(e.className=this.displayTextClass),
g.create("div",e,this.rootDiv));this.tooltip&&(this.rootDiv.title=this.checkForSubstitution(this.tooltip))}});dojo.declare("js.LGRadioButton",js.LGButton,{constructor:function(){this.isOn=this.toBoolean(this.isOn,!1);this.setIsOn(this.isOn);this.controller=null;n(this.rootDiv,"click",this.handleClick)},setController:function(e){this.controller=e},setIsOn:function(e){(this.isOn=e)?this.applyThemeAltBkgd(!0):this.applyTheme(!0)},handleClick:function(e){e=e.currentTarget.getLGObject();e.controller&&
e.controller.selectMember(e)}});dojo.declare("js.LGRadioButtonController",js.LGObject,{constructor:function(){this.members=[];this.currentMember=null},addMember:function(e){this.members.push(e);e.setController(this)},selectMember:function(e){var a,b=this;this.currentMember&&(this.currentMember.setIsOn(!1),this.currentMember=null);"number"===typeof e?0<this.members.length&&(e=Math.max(0,Math.min(e,b.members.length-1)),b.currentMember=b.members[e],b.currentMember.setIsOn(!0)):"string"===typeof e?f.some(this.members,
function(a){return a.value===e?(b.currentMember=a,b.currentMember.setIsOn(!0),!0):!1}):e&&(a=e.rootId,f.some(this.members,function(e){return e.rootId===a?(b.currentMember=e,b.currentMember.setIsOn(!0),!0):!1}))},getCurrentMember:function(){return this.currentMember}});dojo.declare("js.LGCommand",[js.LGButton,js.LGDependency],{constructor:function(){this.publish&&(this.clickHandler=n(this.rootDiv,"click",this.handleClick))},onDependencyPrep:function(){this.setIsVisible(!1);this.inherited(arguments)},
onDependencyReady:function(){this.setIsVisible(!0);this.inherited(arguments)},handleClick:function(e){e=e.currentTarget.getLGObject();e.publishMessage("command",e.publish);e.publishMessage(e.publish,e.publishArg)}});dojo.declare("js.LGCommandToggle",js.LGCommand,{constructor:function(){var e=this;this.iconDisabledUrl=this.iconDisabledUrl||this.iconUrl;this.isEnabled=this.toBoolean(this.isEnabled,!0);e.setIsEnabled(this.isEnabled);this.isVisible=this.toBoolean(this.isVisible,!0);e.setIsVisible(this.isVisible);
this.triggerEnable&&this.subscribeToMessage(this.triggerEnable,function(){e.isEnabled=!0;e.setIsEnabled(e.isEnabled)});this.triggerDisable&&this.subscribeToMessage(this.triggerDisable,function(){e.isEnabled=!1;e.setIsEnabled(e.isEnabled)});this.triggerVisible&&this.subscribeToMessage(this.triggerVisible,function(){e.isVisible=!0;e.setIsVisible(e.isVisible)});this.triggerInvisible&&this.subscribeToMessage(this.triggerInvisible,function(){e.isVisible=!1;e.setIsVisible(e.isVisible)})},setIsEnabled:function(e){(this.isEnabled=
e)?(this.iconImg.src=this.iconUrl,d.add(this.rootDiv,"appThemeHover")):(this.iconImg.src=this.iconDisabledUrl,d.remove(this.rootDiv,"appThemeHover"))},handleClick:function(e){var a=e.currentTarget.getLGObject();a.isEnabled&&a.inherited("handleClick",arguments)}});dojo.declare("js.LGLaunchUrl",js.LGObject,{constructor:function(){this.subscribeToMessage(this.sameWinTrigger,function(e){e&&window.open(e,"_parent")});this.subscribeToMessage(this.newWinTrigger,function(e){e&&window.open(e,"_blank")})}});
dojo.declare("js.LGPrintMap",js.LGMapBasedMenuBox,{constructor:function(){var e,a=this;this.radioButtonController=new js.LGRadioButtonController;e=new js.LGRadioButton({rootId:this.rootId+"_landscape",parentDiv:this.rootId,iconUrl:this.landscapeButtonIconUrl,rootClass:this.orientationButtonClass,iconClass:this.orientationButtonIconClass,tooltip:this.checkForSubstitution(this.landscapeButtonTooltip),value:this.landscapeServerSpec});e.setIsVisible(!0);this.radioButtonController.addMember(e);c.set(e.rootDiv,
"display","inline-block");e=new js.LGRadioButton({rootId:this.rootId+"_portrait",parentDiv:this.rootId,iconUrl:this.portraitButtonIconUrl,rootClass:this.orientationButtonClass,iconClass:this.orientationButtonIconClass,tooltip:this.checkForSubstitution(this.portraitButtonTooltip),value:this.portraitServerSpec});e.setIsVisible(!0);this.radioButtonController.addMember(e);c.set(e.rootDiv,"display","inline-block");this.titleEntryTextBox=(new p({id:this.rootId+"_titleEntry",value:this.title,trim:!0,placeHolder:this.titleHint||
this.checkForSubstitution(this.titleHintDefault)||""})).placeAt(this.rootId);c.set(this.titleEntryTextBox.domNode,"width","97%");d.add(this.titleEntryTextBox.domNode,this.titleClass);this.authorEntryTextBox=(new p({id:this.rootId+"_authorEntry",value:this.author,trim:!0,placeHolder:this.authorHint||this.checkForSubstitution(this.authorHintDefault)||""})).placeAt(this.rootId);c.set(this.authorEntryTextBox.domNode,"width","97%");d.add(this.authorEntryTextBox.domNode,this.authorClass);e=new js.LGButton({rootId:this.rootId+
"_doPrint",parentDiv:this.rootId,iconUrl:this.printButtonIconUrl,rootClass:this.printButtonClass,iconClass:this.printButtonIconClass,tooltip:this.checkForSubstitution(this.printButtonTooltip)});e.setIsVisible(!0);c.set(e.rootDiv,"display","inline-block");this.radioButtonController.selectMember(0);n(e.rootDiv,"click",function(){var e,b,c=[],d;a.publishMessage(a.publishWorking);a.setIsVisible(!1);e=a.mapObj.getOperationalLayers();f.forEach(e,function(e){b=new w;b.layerId=e.id;c.push(b)});e=(e=a.radioButtonController.getCurrentMember())?
e.value:null;d=new u;d.map=a.mapObj.mapInfo.map;d.outSpatialReference=a.mapObj.mapInfo.map.spatialReference;d.template=new v;d.template.format=a.format||"PDF";d.template.layout=e||a.layout||"Letter ANSI A Landscape";d.template.layoutOptions={titleText:a.titleEntryTextBox.value,authorText:a.authorEntryTextBox.value,copyrightText:a.copyrightText,legendLayers:c};d.template.preserveScale=a.toBoolean(a.preserveScale,!1);d.template.showAttribution=!0;a.printTask.execute(d,function(e){a.publishMessage(a.publishReady);
a.publishMessage(a.publishPrintUrl,e.url)},function(e){a.publishMessage(a.publishReady);a.log("Print failed: "+e.message,!0)})})},checkPrerequisites:function(){if(this.commonConfig.helperServices&&this.commonConfig.helperServices.printTask&&this.commonConfig.helperServices.printTask.url)this.printTask=new t(this.commonConfig.helperServices.printTask.url,{async:!1});else throw this.log("no print task configured"),"no print task configured";}});dojo.declare("js.LGFetchPrintedMap",[js.LGObject,js.LGMapDependency],
{constructor:function(){this.fetchPrintUrl=null;this.printAvailabilityTimeoutMinutes=this.toNumber(this.printAvailabilityTimeoutMinutes,10);this.printTimeouter=null},onDependencyReady:function(){var e=this;this.subscribeToMessage(this.triggerPrintUrl,function(a){clearTimeout(e.printTimeouter);e.fetchPrintUrl=a;e.publishMessage(e.publishPrintAvailable);0<e.printAvailabilityTimeoutMinutes&&(e.printTimeouter=setTimeout(function(){e.publishMessage(e.publishPrintNotAvailable)},6E4*e.printAvailabilityTimeoutMinutes))});
this.subscribeToMessage(this.trigger,function(){null!==e.fetchPrintUrl&&e.publishMessage(e.publish,e.fetchPrintUrl)})}});dojo.declare("js.LGLocate",js.LGObject,{constructor:function(){var e=this,a;this.ready=new k;Modernizr.geolocation?(this.subscribeToMessage(this.trigger,function(){a=setTimeout(function(){alert(e.checkForSubstitution("@messages.geolocationTimeout"))},16E3);navigator.geolocation.getCurrentPosition(function(b){clearTimeout(a);e.log("go to "+b.coords.latitude+" "+b.coords.longitude);
e.publishMessage(e.publish,new esri.geometry.Point(b.coords.longitude,b.coords.latitude,new esri.SpatialReference({wkid:4326})))},function(b){clearTimeout(a);switch(b.code){case b.PERMISSION_DENIED:b=e.checkForSubstitution("@messages.geolocationDenied");break;case b.TIMEOUT:b=e.checkForSubstitution("@messages.geolocationTimeout");break;default:b=e.checkForSubstitution("@messages.geolocationUnavailable")}alert(b)},{timeout:8E3})}),this.ready.resolve(e)):this.ready.reject(e)}});dojo.declare("js.LGSearch",
js.LGObject,{constructor:function(){this.busyIndicator&&(this.busyIndicator=this.lgById(this.busyIndicator))},search:function(){return null},toList:function(){return[]},publish:function(e,a){this.publishMessage(e,a)},sortByLabel:function(e,a){var b=0;e&&(a&&e.label&&a.label)&&(b=e.label.localeCompare(a.label));return b},getRepresentativePoint:function(e){var a;"point"===e.type?a=e:"polygon"===e.type?(a=e.getExtent().getCenter(),e.contains(a)||(a=e.getPoint(0,0))):"polyline"===e.type&&(a=e.getPoint(0,
0));return a}});dojo.declare("js.LGSearchAddress",[js.LGSearch,js.LGMapDependency],{constructor:function(){this.searcher=new esri.tasks.Locator(this.searchUrl);this.searcher.outSpatialReference=new esri.SpatialReference({wkid:this.outWkid});this.params={};this.params.outFields=this.outFields;this.ready=new k},onDependencyReady:function(){this.params.searchExtent=this.mapObj.mapInfo.map.extent;this.ready.resolve(this);this.inherited(arguments)},search:function(e,a,b){this.params.address={};this.params.address[this.addressParamName]=
e;this.searcher.addressToLocations(this.params,a,b)},toList:function(a){var b,c=this,d=[];a&&f.forEach(a,function(a){b=!1;a.score>=c.minimumScore&&(c.validLocators?f.some(c.validLocators,function(e){if(a.attributes.Loc_name===e)return b=!0}):b=!0);b&&d.push({label:a.address,data:new esri.geometry.Point(a.location.x,a.location.y,new esri.SpatialReference({wkid:102100}))})});return d},publish:function(a,b){this.publishMessage(a,b)}});dojo.declare("js.LGSearchFeatureLayer",[js.LGSearch,js.LGMapDependency],
{constructor:function(){if(!this.searchPattern||0>this.searchPattern.indexOf("${1}"))this.searchPattern="%${1}%";this.caseInsensitiveSearch=this.toBoolean(this.caseInsensitiveSearch,!0);this.ready=new k;this.displayField=this.displayField?this.displayField.split(",")[0].trim():""},onDependencyReady:function(){var a,b,c,d=",",h,g=this,k=[],l;if(this.searchLayerName)try{if((a=this.mapObj.getLayer(this.searchLayerName))&&a.url){this.searchURL=a.url;f.forEach(a.fields,function(a){d+=a.name+","});this.searchFields&&
0<this.searchFields.length?(c=this.searchFields.split(","),this.searchFields=[],f.forEach(c,function(a){g.searchFields.push(a.trim())}),f.forEach(this.searchFields,function(a){0<=d.indexOf(","+a+",")&&k.push(a)})):this.searchFields=[];if(0===k.length){this.showSearchLayerFieldError(this.searchFields,this.searchLayerName,a);this.ready.reject(this);this.inherited(arguments);return}""!==this.displayField&&0>d.indexOf(","+this.displayField+",")&&(this.showSearchLayerFieldError([this.displayField],this.searchLayerName,
a),this.displayField="");this.searchFields=k;this.objectIdField=a.objectIdField;this.publishPointsOnly="boolean"===typeof this.publishPointsOnly?this.publishPointsOnly:!0;this.searcher=new esri.tasks.QueryTask(this.searchURL);this.generalSearchParams=new esri.tasks.Query;this.generalSearchParams.returnGeometry=!1;this.generalSearchParams.outSpatialReference=this.mapObj.mapInfo.map.spatialReference;l=[a.objectIdField];""!==this.displayField&&(l=l.concat(this.displayField));this.generalSearchParams.outFields=
l.concat(this.searchFields);this.objectSearchParams=new esri.tasks.Query;this.objectSearchParams.returnGeometry=!0;this.objectSearchParams.outSpatialReference=this.mapObj.mapInfo.map.spatialReference;this.objectSearchParams.outFields=["*"];h=this.mapObj.mapInfo.itemInfo.itemData.operationalLayers;f.some(h,function(a){return a.title===g.searchLayerName?(g.popupTemplate=new x(a.popupInfo),!0):!1});this.log("Search layer "+this.searchLayerName+" set up for queries");this.ready.resolve(this);this.inherited(arguments);
return}}catch(q){b=q.toString()}this.showSearchLayerError(this.searchLayerName,b);this.ready.reject(this);this.inherited(arguments)},showSearchLayerError:function(a,b){var c;b||(b=this.checkForSubstitution("@messages.searchLayerMissing"));c='"'+(a||"")+'"<br>';c+=b+"<br><hr>";c+=this.checkForSubstitution("@prompts.mapLayers")+"<br><ul>";f.forEach(this.mapObj.getLayerNameList(),function(a){c+='<li>"'+a+'"</li>'});c+="</ul>";this.log(c,!0)},showSearchLayerFieldError:function(a,b,c){var d="",g;f.forEach(a,
function(a){0<d.length&&(d+=",");d+=a});g='"'+d+'"<br>';g=1<a.length?g+this.checkForSubstitution("@messages.allSearchFieldsMissing"):g+this.checkForSubstitution("@messages.searchFieldMissing");g+='<br><hr>"'+b+'"<br>';g+=this.checkForSubstitution("@prompts.layerFields")+"<br><ul>";f.forEach(c.fields,function(a){g+='<li>"'+a.name+'"</li>'});g+="</ul>";this.log(g,!0)},search:function(a,b,c){var d,g="",h,k="";!0===this.caseInsensitiveSearch?(d=a.toUpperCase(),h="UPPER(${0}) LIKE '"+this.searchPattern+
"'"):(d=a,h="${0} LIKE '"+this.searchPattern+"'");d=d.replace(/'/g,"''");f.forEach(this.searchFields,function(a){g=g+k+dojo.string.substitute(h,[a,d]);k="  OR  "});0<g.length&&(this.generalSearchParams.where=g,this.searcher.execute(this.generalSearchParams,b,c))},toList:function(a,b){var c=this,d=[],g,h,k=b.toUpperCase();a&&(a.features&&0<a.features.length)&&(f.forEach(a.features,function(a){h="";a.attributes[c.displayField]?h=a.attributes[c.displayField].toString():f.some(c.searchFields,function(e){return a.attributes[e]&&
(g=a.attributes[e].toString(),0<=g.toUpperCase().indexOf(k))?(h=g,!0):!1});""===h&&(h="result");d.push({label:h,data:a.attributes[c.objectIdField]})}),d.sort(c.sortByLabel));return d},publish:function(a,b){var f,c,d=this;this.busyIndicator&&this.busyIndicator.setIsVisible(!0);this.objectSearchParams.where=this.objectIdField+"="+b;this.searcher.execute(this.objectSearchParams,function(b){b&&b.features&&0<b.features.length?(f=b.features[0],f.infoTemplate=d.popupTemplate,c=d.publishPointsOnly?d.getRepresentativePoint(f.geometry):
f,d.publishMessage(a,c)):d.log("LGSearchFeatureLayer_1: no results");d.busyIndicator&&d.busyIndicator.setIsVisible(!1)},function(a){d.log("LGSearchFeatureLayer_2: "+a.message);d.busyIndicator&&d.busyIndicator.setIsVisible(!1)})}});dojo.declare("js.LGSearchMultiplexer",js.LGSearch,{constructor:function(){var a=this,b;this.ready=new k;b=this.createSearchersList();(new h(b)).then(function(b){f.every(b,function(a){return a[0]})?a.ready.resolve(a):a.ready.reject(a)})},createSearchersList:function(){var a=
this,b=[];this.searchers=[];this.searchers=[];this.searcherNames&&f.forEach(this.searcherNames,function(f){if(f=a.lgById(f))a.searchers.push(f),b.push(f.ready)});return b},search:function(a,b,c){var d=[],g=[];f.forEach(this.searchers,function(b,c){var h=new k;g.push(h);b.search(a,function(g){g=b.toList(g,a);g=f.map(g,function(a){return{data:{iSearcher:c,itemData:a.data},label:a.label}});d=d.concat(g);h.resolve()},function(a){h.reject(a)})});(new h(g)).then(function(a){var e=!0;c&&(e=!f.some(a,function(a){return!a[0]?
(c(a[1]),!0):!1}));e&&b&&b(d)})},toList:function(a){return a},publish:function(a,b){this.searchers[b.iSearcher].publish(a,b.itemData)}});dojo.declare("js.LGSearchFeatureLayerMultiplexer",[js.LGSearchMultiplexer,js.LGMapDependency],{createSearchersList:function(){var a=[],b=[],f=[],c,d;this.searchers=[];this.searchLayerName&&(b=this.searchLayerName.split(","));this.displayFields&&(f=this.displayFields.split(","));for(c=0;c<b.length;c+=1)d=this.rootId+"_"+this.searchers.length,d=new js.LGSearchFeatureLayer({app:this.app,
commonConfig:this.commonConfig,i18n:this.i18n,webmap:this.webmap,rootId:d,parentDiv:this.parentDiv,dependencyId:this.dependencyId,busyIndicator:this.busyIndicator,publishPointsOnly:this.publishPointsOnly,searchPattern:this.searchPattern,caseInsensitiveSearch:this.caseInsensitiveSearch,searchLayerName:b[c].trim(),searchFields:this.searchFields,displayField:f[c]}),this.searchers.push(d),a.push(d.ready);return a},onDependencyReady:function(){0===this.searchers.length&&this.showSearchLayerError("")},
showSearchLayerError:function(a,b){var c;b||(b=this.checkForSubstitution("@messages.searchLayerMissing"));c='"'+(a||"")+'"<br>';c+=b+"<br><hr>";c+=this.checkForSubstitution("@prompts.mapLayers")+"<br><ul>";f.forEach(this.mapObj.getLayerNameList(),function(a){c+='<li>"'+a+'"</li>'});c+="</ul>";this.log(c,!0)}});dojo.declare("js.LGSearchBoxByText",js.LGDropdownBox,{constructor:function(){var a=this,b,d,h,k,l,q,m;b=this.rootId+"_entry";g.create("label",{"for":b,innerHTML:this.checkForSubstitution(this.showPrompt)},
this.rootId);this.searchEntryTextBox=(new p({id:b,value:"",trim:!0,placeHolder:this.hint,intermediateChanges:!0})).placeAt(this.rootId);c.set(this.searchEntryTextBox.domNode,"width","99%");b=g.create("div",{className:this.resultsListBoxClass},this.rootId);d=g.create("table",{className:this.resultsListTableClass},b);h=g.create("tbody",{className:this.resultsListBodyClass},d);touchScroll(b);k=this.lgById(this.searcher);l="";q=0;m=null;n(this.searchEntryTextBox,"change",function(){var b=a.searchEntryTextBox.get("value");
l!==b&&(l=b,g.empty(h),clearTimeout(m),0<b.length&&(m=setTimeout(function(){var c,d,r;c=g.create("tr",null,h);g.create("td",{className:a.resultsListSearchingClass},c);d=q=(new Date).getTime();k.search(b,function(c){d<q||(g.empty(h),c=k.toList(c,b),r=(new Date).getTime(),a.log("retd "+c.length+" items in "+(r-d)/1E3+" secs"),0<c.length&&f.forEach(c,function(b){var c;c=g.create("tr",null,h);c=g.create("td",{className:a.resultsListEntryClass,innerHTML:b.label},c);a.applyTheme(!0,c);n(c,"click",function(){k.publish(a.publish,
b.data)})}))},function(b){a.log("LGSearchBoxByText_1: "+b.message);l="";g.empty(h)})},1E3)))})},toggleVisibility:function(){this.inherited(arguments);this.getIsVisible()&&this.searchEntryTextBox.focus()}});dojo.declare("js.LGShare",js.LGObject,{constructor:function(){var a=this;this.busyIndicator&&(this.busyIndicator=this.lgById(this.busyIndicator));this.subscribeToMessage(this.trigger,function(){a.share()})},share:function(){var a=this,b,c;b=encodeURIComponent(this.getSubject());c=encodeURIComponent(this.getUrlToShare());
this.tinyURLServiceURL&&0<this.tinyURLServiceURL.length?(this.busyIndicator&&this.busyIndicator.setIsVisible(!0),c=esri.substitute({url:c},this.tinyURLServiceURL),esri.request({url:c,handleAs:"json"},{useProxy:!1}).then(function(c){var f,d;try{if(f=a.followAttributePath(c,a.tinyURLResponseAttribute))d=esri.substitute({subject:b,url:f},a.shareUrl),a.publishMessage(a.publish,d)}catch(g){a.log("LGShare_1: "+g.toString())}a.busyIndicator&&a.busyIndicator.setIsVisible(!1)},function(b){a.log("LGShare_2: "+
b.toString());a.busyIndicator&&a.busyIndicator.setIsVisible(!1)})):(c=esri.substitute({subject:b,url:c},this.shareUrl),this.publishMessage(this.publish,c))},getSubject:function(){return""},getUrlToShare:function(){return this.getAppUrl()},getAppUrl:function(){return window.location.toString()}});dojo.declare("js.LGShareAppExtents",[js.LGShare,js.LGMapDependency],{getSubject:function(){var a="";this.subject&&(a=this.checkForSubstitution(this.subject));return a},getUrlToShare:function(){var a=this.getAppUrl();
return a+(0>a.indexOf("?")?"?":"&")+this.getMapExtentsArg()},getMapExtentsArg:function(){return"ex="+this.mapObj.getMapExtentsAsString()}});dojo.declare("js.LGFilterLayers1",js.LGMapBasedMenuBox,{constructor:function(){this.layers=[];this.switchDelayTimer=null;this.busyIndicator&&(this.busyIndicator=this.lgById(this.busyIndicator));this.switchDelayTimer=null;this.switchDelaySecs=1E3*this.toNumber(this.nonieSwitchDelaySecs,1.5);this.switchDelayMultiplier=1},onDependencyReady:function(){var b;this.fieldname1&&
(f.forEach(this.mapObj.mapInfo.itemInfo.itemData.operationalLayers,a.hitch(this,function(a){var b;if(a.layerObject&&"Feature Layer"===a.layerObject.type)for(b=0;b<a.layerObject.fields.length;b+=1)if(a.layerObject.fields[b].name===this.fieldname1){a={layerObject:a.layerObject,fieldType:a.layerObject.fields[b].type};this.layers.push(a);break}})),g.create("label",{innerHTML:this.hint1},g.create("div",{},this.rootId)),b=(new p({id:this.rootId+"_field1",value:this.value1,trim:!0,placeHolder:this.hint1,
intermediateChanges:!0})).placeAt(this.rootId),c.set(b.domNode,"width","99%"),this.tooltip&&b.set("title",this.checkForSubstitution(this.tooltip)),n(b,"change",a.hitch(this,function(){this.value1=b.value;this.onValueChanged()})));0===this.layers.length?(this.setShowable(!1),this.showFieldError(this.fieldname1)):this.applyFilter()},showFieldError:function(b){var c;c='"'+b+'"<br>';c+=this.checkForSubstitution("@messages.fieldNotFound")+"<br><hr>";c+=this.checkForSubstitution("@prompts.mapLayers")+"<br><ul>";
f.forEach(this.mapObj.mapInfo.itemInfo.itemData.operationalLayers,a.hitch(this,function(a){var b;if(a.layerObject&&"Feature Layer"===a.layerObject.type){c+='<li>"'+a.layerObject.name+'"<ul>';for(b=0;b<a.layerObject.fields.length;b+=1)c+='<li>"'+a.layerObject.fields[b].name+'"</li>';c+="</ul></li>"}}));c+="</ul>";this.log(c,!0)},onValueChanged:function(){this.applyFilter()},applyFilter:function(){var a=this;this.busyIndicator&&this.busyIndicator.setIsVisible(!0);null!==this.switchDelayTimer&&clearTimeout(this.switchDelayTimer);
this.switchDelayTimer=setTimeout(function(){a.switchDelayTimer=null;a.applyFilterCore();a.busyIndicator&&a.busyIndicator.setIsVisible(!1)},this.switchDelaySecs*this.switchDelayMultiplier);this.switchDelayMultiplier=1},applyFilterCore:function(){f.forEach(this.layers,a.hitch(this,function(a){this.setLayerDefinitionExpression(a.layerObject,a.fieldType);a.layerObject.clearSelection()}))},setLayerDefinitionExpression:function(a,c){var f=a.defaultDefinitionExpression;try{this.value1&&""!==this.value1&&
("esriFieldTypeString"===c?f=b.substitute(this.defnExpression,{fieldname1:this.fieldname1,value1:"'"+this.value1+"'"}):"esriFieldTypeInteger"===c&&(f=b.substitute(this.defnExpression,{fieldname1:this.fieldname1,value1:this.value1}))),a.setDefinitionExpression(f)}catch(d){}}});dojo.declare("js.LGFilterLayers1WithDefaults",[js.LGFilterLayers1,js.LGDefaults],{constructor:function(){this.changeDefaults()},onValueChanged:function(){this.inherited(arguments);this.changeDefaults()},changeDefaults:function(){this.defaultValues.value1=
this.value1;this.defaultValues.fieldname1=this.fieldname1;this.inherited(arguments)}})})},"js/lgonlineDijit":function(){define("js/lgonlineDijit",["dojo/Deferred","dojo/dom-construct","js/lgonlineMap"],function(g,m){dojo.declare("js.LGMapDijitContainer",[js.LGGraphic,js.LGMapDependency],{constructor:function(){this.ready=new g},onDependencyReady:function(){this.createDijit()},createDijit:function(){var g=this;require([this.dijitAmd],function(k){g.dijit=(new k({map:g.mapObj.mapInfo.map},m.create("div",
null,g.rootDiv))).startup();g.ready.resolve(g)})}})})},"js/lgonlineDrawing":function(){define("js/lgonlineDrawing",["dojo/Deferred","dojo/_base/Color","esri/lang","js/lgonlineMap"],function(g,m,n){dojo.declare("js.LGHighlighter",[js.LGObject,js.LGMapDependency],{constructor:function(){this.showFeaturePopup=this.toBoolean(this.showFeaturePopup,!0)},onDependencyReady:function(){var g,h,c=this;this.highlighterLayer=c.mapObj.createGraphicsLayer("highlighterLayer");this.lineHiliteColor=new m(this.lineHiliteColor||
"#0000ff");this.fillHiliteColor=new m(this.fillHiliteColor||[0,0,255,0.1]);this.intervalID=this.intervalTerminator=null;this.subscribeToMessage("highlightItem",function(d){var f,a,b;d&&(f=d.geometry?d.geometry:d,d.attributes&&(a=d.attributes),d.infoTemplate&&(b=d.infoTemplate),d=c.createHighlightGraphics(f,a,b),0<d.length&&(h=(g=f.getExtent())?g.getCenter():f,c.showHighlight(d,h,c.highlightZoomLevel,n.isDefined(a)&&n.isDefined(b)&&c.showFeaturePopup)))})},createHighlightGraphics:function(g,h,c){var d,
f=[];if("polyline"===g.type)f.push(new esri.Graphic(g,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.lineHiliteColor,3),h,c));else if("point"===g.type){if(!g.x||!g.y||isNaN(g.x)||isNaN(g.y))return f;for(d=0;4>=d;++d)f.push(new esri.Graphic(g,new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,2.5*(d+16),new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color(this.lineHiliteColor),3),new dojo.Color([0,0,0,0])),
h,c))}else g.type&&f.push(new esri.Graphic(g,new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.lineHiliteColor,3),this.fillHiliteColor),h,c));return f},showHighlight:function(k,h,c,d){var f,a,b,p,l=this;h?f=this.mapObj.centerAt(h):(f=new g,f.resolve());f.then(function(){c?a=l.mapObj.setZoom(c):(a=new g,a.resolve());a.then(function(){l.intervalTerminator&&(clearTimeout(l.intervalTerminator),clearInterval(l.intervalID));
l.highlighterLayer.clear();l.mapObj.hidePopup();1<k.length?(b=0,p=!0,l.intervalID=setInterval(function(){l.highlighterLayer.clear();l.highlighterLayer.add(k[b]);p?++b:--b;b===k.length?(p=!1,--b):0>b&&(p=!0,b=0)},120),l.intervalTerminator=setTimeout(function(){clearInterval(l.intervalID);l.intervalTerminator=null;l.intervalID=null;l.highlighterLayer.clear()},5E3)):l.highlighterLayer.add(k[0]);d&&l.mapObj.showPopupWithFeature(h,k[0])})})}})})},"js/lgonlineEditing":function(){define("js/lgonlineEditing",
"dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/aspect esri/dijit/editing/TemplatePicker esri/dijit/editing/Editor esri/toolbars/draw esri/graphic js/lgonlineBase js/lgonlineMap js/lgonlineCommand".split(" "),function(g,m,n,k,h,c,d,f){dojo.declare("js.LGEditTemplatePicker",js.LGMapBasedMenuBox,{constructor:function(){var a;a=dojo.byId(this.colorizerId).getLGObject();a=".templatePicker{border:1px solid transparent!important;}.templatePicker .dojoxGrid{background-color:transparent;}.templatePicker .dojoxGrid .dojoxGridScrollbox{background-color:transparent;}.templatePicker .dojoxGrid .dojoxGridRow{background-color:transparent;}.templatePicker .dojoxGrid .dojoxGridCell{border:1px solid transparent}.templatePicker .dojoxGrid .dojoxGridRow{border:1px solid transparent}.templatePicker .grid .dojoxGridRowOver{background-color:transparent;color:inherit;}.templatePicker .grid .dojoxGridRowOver .dojoxGridCell{background-color:transparent;color:inherit;}.templatePicker .dojoxGrid .dojoxGridCellFocus{border:1px solid transparent!important;}.templatePicker .dojoxGrid .dojoxGridRowOdd{background-color:transparent;}.templatePicker .dojoxGrid .selectedItem{border:1px solid transparent!important;color:"+
a.foregroundColor()+"!important;background-color:"+a.alternateBackgroundColor()+"!important}";this.injectCSS(a)},onDependencyReady:function(){var a,b,c;a=this.mapObj.mapInfo;this.layerInfos=[];this.layers=[];m.forEach(a.itemInfo.itemData.operationalLayers,n.hitch(this,function(a){var f,d=a.layerObject;if(d instanceof esri.layers.FeatureLayer&&d.isEditable()&&(null===a.capabilities||"Query"!==a.capabilities)&&(null===d.capabilities||"Query"!==d.capabilities))c={featureLayer:d},b=null,a.popupInfo&&
a.popupInfo.fieldInfos?b=a.popupInfo.fieldInfos:d.infoTemplate&&(d.infoTemplate.info&&d.infoTemplate.info.fieldInfos)&&(b=d.infoTemplate.info.fieldInfos),b&&(f=[],m.forEach(b,function(a){a.visible&&f.push(a)}),c.fieldInfos=f),this.layerInfos.push(c),this.layers.push(d)}));0===this.layers.length?this.setShowable(!1):(this.map=a.map,this.templatePickerHolder=g.create("div",{className:this.templatePickerHolderClass}),g.place(this.templatePickerHolder,this.rootId),touchScroll(this.templatePickerHolder));
this.inherited(arguments)},createEditor:function(){var a=this,b,f;this.templatePickerHolder&&(this.setIsVisible(!1,!0),b=g.create("div"),g.place(b,this.templatePickerHolder),f=new h({featureLayers:this.layers,rows:"auto",columns:2,grouping:!0},b),f.startup(),this.setIsVisible(!1,!1),b=g.create("div"),g.place(b,this.templatePickerHolder),f={map:this.map,templatePicker:f,toolbarVisible:!1,layerInfos:this.layerInfos},this.editor=new c({settings:f},b),this.editor.startup(),k.before(this.editor,"_applyEdits",
function(b){m.forEach(b,function(b){b.adds&&a.preprocessEditAdds(b);b.updates&&a.preprocessEditUpdates(b);b.deletes&&a.preprocessEditDeletes(b)})}),this.mapObj.disablePopups())},destroyEditor:function(){this.editor&&(this.editor.destroy(),this.editor=null,this.mapObj.enablePopups())},show:function(){this.createEditor();this.inherited(arguments)},hide:function(){this.destroyEditor();this.inherited(arguments)},preprocessEditAdds:function(a){return a},preprocessEditUpdates:function(a){return a},preprocessEditDeletes:function(a){return a}});
dojo.declare("js.LGEditTemplatePickerWithDefaults",[js.LGEditTemplatePicker,js.LGDefaults],{preprocessEditAdds:function(a){a.adds[0].attributes[this.defaultValues.fieldname1]=this.defaultValues.value1;return a}});dojo.declare("js.LGFeatureByClick",[js.LGObject,js.LGMapDependency],{onDependencyReady:function(){var a=this;this.inherited(arguments);this.clickHandle=this.subscribeToMessage("mapClick",function(b){a.handleClick(b)})},handleClick:function(){return null}});dojo.declare("js.LGAddFeatureByClick",
js.LGFeatureByClick,{onDependencyReady:function(){this.inherited(arguments);esri.bundle.toolbars.draw.addPoint=this.checkForSubstitution("@tooltips.collect");this.drawingToolbar=new d(this.mapObj.mapInfo.map,{});this.drawingToolbarActive=!1;this.drawingToolbar.on("draw-end",n.hitch(this,this.handleDrawEnd))},handleClick:function(a){this.drawingToolbarActive||(this.drawingToolbarActive=!0,this.drawingToolbar.activate(d.POINT),this.drawingToolbar._updateTooltip(a))},handleDrawEnd:function(a){var b=
this,c;this.drawingToolbarActive=!1;this.drawingToolbar.deactivate();c=new f(a.geometry,new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE,10,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,0,0]),1),new dojo.Color([0,255,0,0.25])));this.mapObj.mapInfo.map.graphics.add(c);setTimeout(function(){alert(b.checkForSubstitution("@messages.yourContentSubmitted"));b.mapObj.mapInfo.map.graphics.remove(c)},2E3)}})})},"js/lgonlineFrame":function(){define("js/lgonlineFrame",
"dojo/dom-construct dojo/on dojo/dom-style dojo/_base/array dojo/_base/lang js/lgonlineBase".split(" "),function(g,m,n,k,h){dojo.declare("js.LGColorizer",js.LGObject,{constructor:function(){var c,d="",f=this,a=["#fff","#333333","#5d5d5d","#5d5d5d"];this.colors=[];k.some(this.colorTable,function(a){return f.theme===a.theme?(f.colors=a.colors,!0):!1});if(this.colors.length<a.length)for(c=this.colors.length;c<a.length;c+=1)this.colors.push(a[c]);d+=".appTheme{color:"+this.colors[0]+";background-color:"+
this.colors[1]+"}";d+=".appTheme2{color:"+this.colors[0]+";background-color:"+this.colors[3]+"}";d+=".appThemeHover:hover{background-color:"+this.colors[2]+"}";this.injectCSS(d)},foregroundColor:function(){return this.colors[0]},backgroundColor:function(){return this.colors[1]},hoverColor:function(){return this.colors[2]},alternateBackgroundColor:function(){return this.colors[3]}});dojo.declare("js.LGFrame",js.LGGraphic,{constructor:function(){var c;c={};this.headerDivId&&(c.id=this.headerDivId);
this.headerDivClass&&(c.className=this.headerDivClass);this.headerDiv=g.create("div",c,this.rootDiv);this.applyTheme(!1,this.headerDiv);c={};this.contentDivId&&(c.id=this.contentDivId);this.contentDivClass&&(c.className=this.contentDivClass);this.contentDiv=g.create("div",c,this.rootDiv);this.handleWindowResize()},handleWindowResize:function(){this.inherited(arguments);this.resizeContentDiv()},resizeContentDiv:function(){var c,d,f;this.headerDiv&&this.contentDiv&&(c=dojo.marginBox(this.rootDiv),d=
dojo.marginBox(this.headerDiv),f=c.h-d.h,0<f&&(f={},f.top=d.h+"px",f.height=c.h-d.h+"px",n.set(this.contentDiv,f)))}});dojo.declare("js.LGGallery",js.LGGraphic,{constructor:function(){var c,d=this;c=g.create("table",null,this.rootDiv);this.applyTheme(!1,c);m(window,"resize",h.hitch(this,this.handleParentResize));this.rootDiv.getContentDiv=function(){return d.addItem()};c=g.create("tbody",null,c);this.galleryRow=g.create("tr",null,c);c={innerHTML:"&lt;",style:{visibility:"hidden"}};this.arrowClass&&
(c.className=this.arrowClass);this.leftArrow=g.create("td",c,this.galleryRow);this.applyTheme(!0,this.leftArrow);m(this.leftArrow,"click",h.hitch(this,this.shiftLeft));c.innerHTML="&gt;";this.rightArrow=g.create("td",c,this.galleryRow);this.applyTheme(!0,this.rightArrow);m(this.rightArrow,"click",h.hitch(this,this.shiftRight));this.zeroItemWidth=dojo.marginBox(this.rootDiv).w;this.numItemsToDisplay=this.iFirstItem=this.numItems=this.itemWidth=0;this.firstItem=null;this.handleParentResize()},addItem:function(c){var d;
d={};"string"===typeof c&&(d.innerHTML=c);this.itemClass&&(d.className=this.itemClass);d=g.create("td",d);"string"!==typeof c&&d.appendChild(c);this.galleryRow.insertBefore(d,this.rightArrow);this.numItems+=1;this.firstItem||(this.firstItem=d,this.itemWidth=dojo.marginBox(d).w);this.handleParentResize();return d},clearItems:function(){for(;2<this.galleryRow.childNodes.length;)this.galleryRow.removeChild(this.galleryRow.childNodes[1]);this.numItemsToDisplay=this.iFirstItem=this.numItems=0;this.firstItem=
null;this.handleParentResize()},handleParentResize:function(){var c,d;0===this.zeroItemWidth&&(this.zeroItemWidth=dojo.marginBox(this.rootDiv).w);c=dojo.marginBox(this.rootDiv.parentNode).w;d=this.zeroItemWidth+this.numItems*this.itemWidth;0!==this.numItems&&(d>c?(this.leftArrow.style.visibility="visible",this.rightArrow.style.visibility="visible",this.numItemsToDisplay=Math.max(Math.floor((c-this.zeroItemWidth)/this.itemWidth),1)):(this.leftArrow.style.visibility="hidden",this.rightArrow.style.visibility=
"hidden",this.numItemsToDisplay=this.numItems),this.iFirstItem=Math.min(this.iFirstItem,this.numItems-this.numItemsToDisplay),this.drawGallery())},shiftLeft:function(){this.iFirstItem=Math.min(this.iFirstItem+1,this.numItems-this.numItemsToDisplay);this.drawGallery()},shiftRight:function(){this.iFirstItem=Math.max(this.iFirstItem-1,0);this.drawGallery()},drawGallery:function(){var c,d=this.iFirstItem,f=this.iFirstItem+this.numItemsToDisplay,a=this.firstItem;this.leftArrow.style.visibility="hidden";
this.rightArrow.style.visibility="hidden";for(c=0;c<d;)this.rightArrow.style.visibility="visible",a.style.display="none",a=a.nextSibling,c+=1;for(;c<f;)a.style.display="",a=a.nextSibling,c+=1;for(;c<this.numItems;)this.leftArrow.style.visibility="visible",a.style.display="none",a=a.nextSibling,c+=1;this.handleWindowResize()}});dojo.declare("js.LGTitleBar",js.LGGraphic,{constructor:function(){var c;this.iconUrl&&0<this.iconUrl.length&&(c={src:this.iconUrl},this.iconClass&&(c.className=this.iconClass),
g.create("img",c,this.rootDiv));this.title&&0<this.title.length&&(c={innerHTML:this.title},this.titleClass&&(c.className=this.titleClass),g.create("span",c,this.rootDiv),document.title=this.title);this.handleWindowResize()}})})},"js/lgonlineMap":function(){define("js/lgonlineMap","dojo/dom-construct dojo/on dojo/_base/lang dojo/_base/array dojo/Deferred esri/arcgis/utils esri/dijit/Popup js/lgonlineBase".split(" "),function(g,m,n,k,h,c,d){dojo.declare("js.LGMapDependency",js.LGDependency,{onDependencyPrep:function(c){this.mapObj=
c;this.inherited(arguments)}});dojo.declare("js.LGMap",js.LGGraphic,{constructor:function(){var f,a=null,b=this;this.ready=new h;f={ignorePopups:this.toBoolean(this.ignorePopups,!1)};f.mapOptions=this.mapOptions||{};f.mapOptions.showAttribution=!0;this.popup=new d(null,g.create("div"));f.mapOptions.infoWindow=this.popup;if(this.xmin&&this.ymin&&this.xmax&&this.ymax)try{a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax,spatialReference:{}},a.spatialReference.wkid=this.wkid?Number(this.wkid):
102100,a=new esri.geometry.Extent(a)}catch(k){a=null}this.ex&&(a=this.getExtentsFromString(this.ex));this.commonConfig&&this.commonConfig.bingMapsKey&&(f.bingMapsKey=this.commonConfig.bingMapsKey);this.webmap&&(this.mapId=this.webmap);c.createMap(this.mapId,this.rootDiv,f).then(function(c){b.mapInfo=c;c.map.spatialReference||(b.mapInfo.map.spatialReference=new esri.SpatialReference(102100));m(window,"resize",n.hitch(b.mapInfo.map,function(){b.mapInfo.map.resize();b.mapInfo.map.reposition()}));a&&
(a.spatialReference.wkid!==b.mapInfo.map.spatialReference.wkid?esri.config.defaults.geometryService?(c=new esri.tasks.ProjectParameters,c.geometries=[a],c.outSR=b.mapInfo.map.spatialReference,esri.config.defaults.geometryService.project(c).then(function(c){a=c[0];b.mapInfo.map.setExtent(a)})):b.log("LGMap_1: Need geometry service to convert extents from wkid "+a.spatialReference.wkid+" to map's "+b.mapInfo.map.spatialReference.wkid):b.mapInfo.map.setExtent(a));b.tempGraphicsLayer=b.createGraphicsLayer("tempGraphicsLayer");
b.positionHandle=b.subscribeToMessage("position",function(a){var c;a.spatialReference.wkid===b.mapInfo.map.spatialReference.wkid?b.publishMessage("highlightItem",a):4326===a.spatialReference.wkid&&102100===b.mapInfo.map.spatialReference.wkid?(a=esri.geometry.geographicToWebMercator(a),b.publishMessage("highlightItem",a)):esri.config.defaults.geometryService?(c=new esri.tasks.ProjectParameters,c.geometries=[a],c.outSR=b.mapInfo.map.spatialReference,esri.config.defaults.geometryService.project(c).then(function(c){a=
c[0];b.publishMessage("highlightItem",a)})):b.log("LGMap_1: Need geometry service to convert position from wkid "+a.spatialReference.wkid+" to map's "+b.mapInfo.map.spatialReference.wkid)});b.showFeatureHandle=b.subscribeToMessage("showFeature",function(a){b.publishMessage("highlightItem",a)});b.clickHandle=m(b.mapInfo.map,"click",function(a){b.publishMessage("mapClick",a)});b.ready.resolve(b)},function(){b.ready.reject(b)})},mapInfo:function(){return this.mapInfo},showPopupWithFeature:function(c,
a){this.popup.clearFeatures();this.popup.setContent(a.getContent());this.mapInfo.map.infoWindow.show(this.mapInfo.map.toScreen(c))},hidePopup:function(){this.mapInfo.map.infoWindow.hide()},setExtent:function(c){return this.mapInfo.map.setExtent(c)},centerAt:function(c){return this.mapInfo.map.centerAt(c)},setZoom:function(c){var a=this.mapInfo.map.getMinZoom(),b=this.mapInfo.map.getMaxZoom();0<=a&&0<=b&&(c=Math.max(a,Math.min(b,c)));return this.mapInfo.map.setZoom(c)},getMapExtentsAsString:function(){var c=
"";this.mapInfo&&this.mapInfo.map&&(c=this.getStringFromExtents(this.mapInfo.map.extent));return c},getStringFromExtents:function(c){var a=c.xmin.toFixed().toString()+","+c.ymin.toFixed().toString()+","+c.xmax.toFixed().toString()+","+c.ymax.toFixed().toString();(c=c.spatialReference)&&(c.wkid?a=a+","+c.wkid.toString():c.wkt&&(a=a+","+encodeURIComponent(c.wkt)));return a},getExtentsFromString:function(c){var a,b=null,d,g;a=c.split(",");1===a.length&&(g=c.indexOf("PROJCS"),0<g?(a=c.substr(0,g).split("%2C"),
a[4]=c.substr(g)):a=c.split("%2C"));try{b={xmin:Number(a[0]),ymin:Number(a[1]),xmax:Number(a[2]),ymax:Number(a[3]),spatialReference:{}},4<a.length?(d=Number(a[4]),isNaN(d)?b.spatialReference.wkt=decodeURIComponent(a[4]):b.spatialReference.wkid=d):b.spatialReference.wkid=102100,b=new esri.geometry.Extent(b)}catch(h){b=null}return b},getLayer:function(c){var a;k.some(this.mapInfo.itemInfo.itemData.operationalLayers,function(b){return b.title===c?(a=b.layerObject,!0):!1});return a},getLayerNameList:function(){var c=
[];k.forEach(this.mapInfo.itemInfo.itemData.operationalLayers,function(a){c.push(a.title)});return c},getOperationalLayers:function(){return this.mapInfo.itemInfo.itemData.operationalLayers},createGraphicsLayer:function(c){var a=new esri.layers.GraphicsLayer;a.id=c;return this.mapInfo.map.addLayer(a)},enablePopups:function(){this.mapInfo&&this.mapInfo.clickEventListener&&(this.mapInfo.clickEventHandle=m(this.mapInfo.map,"click",this.mapInfo.clickEventListener))},disablePopups:function(){this.mapInfo&&
this.mapInfo.clickEventHandle&&this.mapInfo.clickEventHandle.remove()}})})},"js/lgonlineOutput":function(){define("js/lgonlineOutput",["dojo/dom-construct","dojo/dom-class","dojo/_base/array","dojo/topic","js/lgonlineBase"],function(g,m,n,k){dojo.declare("js.LGNotes",js.LGObject,{constructor:function(){console&&this.notes&&n.forEach(this.notes,function(g){console.log(g)})}});dojo.declare("js.LGBusy",js.LGGraphic,{constructor:function(){this.busyImageClass&&m.add(this.rootDiv,this.busyImageClass)}});
dojo.declare("js.LGLogBox",js.LGDropdownBox,{constructor:function(){window.gLogMessageBox=this;touchScroll(this.rootDiv)},append:function(h){"string"===typeof h?g.create("div",{innerHTML:h,style:"margin:2px"},this.rootDiv):"object"===typeof h&&null!==h&&this.rootDiv.appendChild(h)}});dojo.declare("js.LGMessageBox",js.LGDropdownBox,{constructor:function(){this.content&&0<this.content.length&&(this.rootDiv.innerHTML=this.content);touchScroll(this.rootDiv)}});dojo.declare("js.LGPublishEcho",js.LGDropdownBox,
{handleTrigger:function(g){this.rootDiv.innerHTML=g.toString();this.setIsVisible(!0)}});dojo.declare("js.LGMessageWatch",js.LGObject,{constructor:function(){var g=this;k.subscribe("publish",function(c){g.showMessage("message from",c)});k.subscribe("receive",function(c){g.showMessage("received by",c)})},showMessage:function(g,c){var d="";if(c.data)try{d=JSON.stringify(c.data)}catch(f){d="<data>"}this.log(g+" "+c.id+': "'+c.tag+'" '+(d||""))}})})}}});
