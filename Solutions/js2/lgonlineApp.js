/* 
This source is a compressed form of part of the git commit 
3451ed0 Converted color definitions to Dojo Color for AGOL printing
Uncompressed source is available from https://github.com/Esri/local-government-online-apps 
*/ 
/*

 | ArcGIS for Local Government
 | Version 10.2
 | Copyright 2012 Esri
 |
 | Licensed under the Apache License, Version 2.0 (the "License");
 | you may not use this file except in compliance with the License.
 | You may obtain a copy of the License at
 |
 |    http://www.apache.org/licenses/LICENSE-2.0
 |
 | Unless required by applicable law or agreed to in writing, software
 | distributed under the License is distributed on an "AS IS" BASIS,
 | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 | See the License for the specific language governing permissions and
 | limitations under the License.
*/
define("js/lgonlineApp","js/lgonlineBase js/lgonlineCommand js/lgonlineDrawing js/lgonlineFrame js/lgonlineMap js/lgonlineOutput".split(" "),function(){return{}});
require({cache:{"js/lgonlineBase":function(){define("js/lgonlineBase","dojo/dom-construct dojo/dom dojo/on dojo/dom-style dojo/dom-class dojo/_base/array dojo/topic dojo/_base/lang".split(" "),function(n,k,q,h,l,a,f,g){dojo.declare("js.LGObject",null,{constructor:function(c){var d,a,e=this;void 0!==c&&dojo.safeMixin(this,c);this.checkPrerequisites&&this.checkPrerequisites();c={};this.rootId&&(c.id=this.rootId);this.rootClass?c.className=this.rootClass:c.style="display:none";void 0!==this.parentDiv?
(d=this.parentDiv,(a=k.byId(d))||(d=null)):d=null;a&&a.getLGObject&&a.getLGObject().addItem?(this.rootDiv=n.create("div",c),a.getLGObject().addItem(this.rootDiv)):this.rootDiv=n.create("div",c,d);this.rootDiv.getLGObject=function(){return e}},getRootDiv:function(){return this.rootDiv},deleteDivFromDom:function(){this.rootDiv&&this.rootDiv.parentNode.removeChild(this.rootDiv)},injectCSS:function(c){var d;d=document.createElement("style");d.setAttribute("type","text/css");d.styleSheet?d.styleSheet.cssText=
c:(c=document.createTextNode(c),d.appendChild(c));c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(d,c);return d},checkForSubstitution:function(c){var d,a=c;c&&1<c.length&&(d=c.substring(0,1),"@"===d?this.i18n&&(a=this.followAttributePath(this.i18n,c.substring(1))):"."===d&&(a=this.followAttributePath(null,c.substring(1))));return a},followAttributePath:function(c,d){var a,e=c,g;try{g=d.split(".");for(a=0;a<g.length;a+=1)e=null===e?k.byId(g[a]).getLGObject():e[g[a]]}catch(f){e=
null}return e},toBoolean:function(c,d){var a;if(!0===c)return!0;if(!1===c)return!1;if("string"===typeof c){a=c.toLowerCase();if("true"===a)return!0;if("false"===a)return!1}return void 0===d?!0:d},toNumber:function(c,d){if("number"===typeof c)return c;c=new Number(c);return!isNaN(c)?c:void 0===d?0:d},log:function(c,d){console&&console.log(c);d&&f.publish("error",c);window.gLogMessageBox&&window.gLogMessageBox.append(c)}});dojo.declare("js.LGGraphic",js.LGObject,{constructor:function(){q(window,"resize",
g.hitch(this,this.handleWindowResize));this.handleWindowResize()},setIsVisible:function(c,d){d?(h.set(this.getRootDiv(),"display","block"),h.set(this.getRootDiv(),"visibility",c?"visible":"hidden")):(h.set(this.getRootDiv(),"display",c?"block":"none"),h.set(this.getRootDiv(),"visibility","visible"))},getIsVisible:function(){return"none"!==h.get(this.getRootDiv(),"display")},toggleVisibility:function(){h.set(this.getRootDiv(),"display",this.getIsVisible()?"none":"block")},handleWindowResize:function(){void 0!==
this.fill&&!0===this.fill?this.fillParentDiv():void 0!==this.horizOffset&&void 0!==this.vertOffset&&this.alignOver(this.rootDiv,this.rootDiv.parentNode,this.horizOffset,this.vertOffset)},fillParentDiv:function(){var c;this.rootDiv.parentNode&&(c={left:"0px",top:"0px",width:this.rootDiv.parentNode.clientWidth+"px",height:this.rootDiv.parentNode.clientHeight+"px"},dojo.style(this.rootDiv,c))},alignOver:function(c,d,g,e){var f,h,b,p=this;c&&d&&(f=dojo.marginBox(c),h=dojo.marginBox(d),b={},"number"===
typeof g?b=this.insertHorizPositioningStyle(b,g,f,h):"object"===typeof g&&a.forEach(g,function(c){b=p.insertHorizPositioningStyle(b,c,f,h)}),"number"===typeof e?b=this.insertVertPositioningStyle(b,e,f,h):"object"===typeof e&&a.forEach(e,function(c){b=p.insertVertPositioningStyle(b,c,f,h)}),dojo.style(c,b))},insertHorizPositioningStyle:function(c,d,a,g){0<d?c.left=d+"px":0===d?c.left=Math.round((g.w-a.w)/2)+"px":c.right=-d+"px";return c},insertVertPositioningStyle:function(c,d,a,g){0<d?c.top=d+"px":
0===d?c.top=Math.round((g.h-a.h)/2)+"px":c.bottom=-d+"px";return c},applyTheme:function(c,a){l.remove(a||this.rootDiv,"appTheme2");l.add(a||this.rootDiv,"appTheme");c&&l.add(a||this.rootDiv,"appThemeHover")},applyThemeAltBkgd:function(c,a){l.remove(a||this.rootDiv,"appTheme");l.add(a||this.rootDiv,"appTheme2");c&&l.add(a||this.rootDiv,"appThemeHover")}});dojo.declare("js.LGDependency",null,{constructor:function(){var c,a=this;this.dependencyId&&(c=k.byId(this.dependencyId).getLGObject(),this.onDependencyPrep(c),
c.ready.then(function(){a.onDependencyReady()}))},onDependencyPrep:function(){return null},onDependencyReady:function(){return null}})})},"js/lgonlineCommand":function(){define("js/lgonlineCommand","dijit dojo/dom-construct dojo/dom dojo/on dojo/Deferred dojo/dom-style dojo/dom-class dojo/_base/array dojo/topic dijit/form/TextBox esri/dijit/BasemapGallery esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate js/lgonlineBase js/lgonlineMap".split(" "),function(n,k,q,h,l,a,f,g,c,
d,r,e,m,t){dojo.declare("js.LGDropdownBox",js.LGGraphic,{constructor:function(){var b=this;this.applyTheme(!1);this.trigger&&(c.subscribe("command",function(c){c!==b.trigger&&b.setIsVisible(!1)}),c.subscribe(this.trigger,function(c){b.handleTrigger(c)}))},handleTrigger:function(){this.toggleVisibility()}});dojo.declare("js.LGMapBasedMenuBox",[js.LGDropdownBox,js.LGMapDependency],{constructor:function(){this.ready=new l},onDependencyReady:function(){this.ready.resolve(this);this.inherited(arguments)}});
dojo.declare("js.LGBasemapBox",js.LGMapBasedMenuBox,{onDependencyReady:function(){var b,c,a=this.getBasemapGroup();b=this.rootId+"_gallery";c=(new n.layout.ContentPane({id:b,className:this.galleryClass})).placeAt(this.rootDiv);touchScroll(b);b=(new r({showArcGISBasemaps:!0,basemapsGroup:a,bingMapsKey:this.mapObj.commonConfig.bingMapsKey,map:this.mapObj.mapInfo.map},k.create("div"))).placeAt(this.rootDiv);c.set("content",b.domNode);b.startup();this.inherited(arguments)},getBasemapGroup:function(){var b=
null;this.basemapgroupTitle&&(this.basemapgroupOwner&&0<this.basemapgroupTitle.length&&0<this.basemapgroupOwner.length)&&(b={title:this.basemapgroupTitle,owner:this.basemapgroupOwner});return b}});dojo.declare("js.LGCallMethods",js.LGObject,{constructor:function(){var b,c=this;this.todo&&g.forEach(this.todo,function(a){try{if(b=q.byId(a.rootId))if(b=b.getLGObject())b[a.method](a.arg)}catch(d){c.log("LGCallMethods_1: "+d.toString())}})}});dojo.declare("js.LGButton",js.LGGraphic,{constructor:function(){var b;
this.applyTheme(!0);this.iconUrl&&(b={src:this.iconUrl},this.iconClass&&(b.className=this.iconClass),this.iconImg=k.create("img",b,this.rootDiv));this.displayText&&(b={innerHTML:this.checkForSubstitution(this.displayText)},this.displayTextClass&&(b.className=this.displayTextClass),k.create("div",b,this.rootDiv));this.tooltip&&(this.rootDiv.title=this.checkForSubstitution(this.tooltip))}});dojo.declare("js.LGRadioButton",js.LGButton,{constructor:function(){this.isOn=this.toBoolean(this.isOn,!1);this.setIsOn(this.isOn);
this.controller=null;h(this.rootDiv,"click",this.handleClick)},setController:function(b){this.controller=b},setIsOn:function(b){(this.isOn=b)?this.applyThemeAltBkgd(!0):this.applyTheme(!0)},handleClick:function(b){b=b.currentTarget.getLGObject();b.controller&&b.controller.selectMember(b)}});dojo.declare("js.LGRadioButtonController",js.LGObject,{constructor:function(){this.members=[];this.currentMember=null},addMember:function(b){this.members.push(b);b.setController(this)},selectMember:function(b){var c,
a=this;this.currentMember&&(this.currentMember.setIsOn(!1),this.currentMember=null);"number"===typeof b?0<this.members.length&&(b=Math.max(0,Math.min(b,a.members.length-1)),a.currentMember=a.members[b],a.currentMember.setIsOn(!0)):"string"===typeof b?g.some(this.members,function(c){return c.value===b?(a.currentMember=c,a.currentMember.setIsOn(!0),!0):!1}):b&&(c=b.rootId,g.some(this.members,function(b){return b.rootId===c?(a.currentMember=b,a.currentMember.setIsOn(!0),!0):!1}))},getCurrentMember:function(){return this.currentMember}});
dojo.declare("js.LGCommand",[js.LGButton,js.LGDependency],{constructor:function(){this.publish&&(this.clickHandler=h(this.rootDiv,"click",this.handleClick))},onDependencyPrep:function(){this.setIsVisible(!1);this.inherited(arguments)},onDependencyReady:function(){this.setIsVisible(!0);this.inherited(arguments)},handleClick:function(b){b=b.currentTarget.getLGObject();c.publish("command",b.publish);c.publish(b.publish,b.publishArg)}});dojo.declare("js.LGCommandToggle",js.LGCommand,{constructor:function(){var b=
this;this.iconDisabledUrl=this.iconDisabledUrl||this.iconUrl;this.isEnabled=this.toBoolean(this.isEnabled,!0);b.setIsEnabled(this.isEnabled);this.isVisible=this.toBoolean(this.isVisible,!0);b.setIsVisible(this.isVisible);this.triggerEnable&&c.subscribe(this.triggerEnable,function(){b.isEnabled=!0;b.setIsEnabled(b.isEnabled)});this.triggerDisable&&c.subscribe(this.triggerDisable,function(){b.isEnabled=!1;b.setIsEnabled(b.isEnabled)});this.triggerVisible&&c.subscribe(this.triggerVisible,function(){b.isVisible=
!0;b.setIsVisible(b.isVisible)});this.triggerInvisible&&c.subscribe(this.triggerInvisible,function(){b.isVisible=!1;b.setIsVisible(b.isVisible)})},setIsEnabled:function(b){(this.isEnabled=b)?(this.iconImg.src=this.iconUrl,f.add(this.rootDiv,"appThemeHover")):(this.iconImg.src=this.iconDisabledUrl,f.remove(this.rootDiv,"appThemeHover"))},handleClick:function(b){var c=b.currentTarget.getLGObject();c.isEnabled&&c.inherited("handleClick",arguments)}});dojo.declare("js.LGLaunchUrl",js.LGObject,{constructor:function(){c.subscribe(this.sameWinTrigger,
function(b){b&&window.open(b,"_parent")});c.subscribe(this.newWinTrigger,function(b){b&&window.open(b,"_blank")})}});dojo.declare("js.LGPrintMap",js.LGMapBasedMenuBox,{constructor:function(){var b,p=this;this.radioButtonController=new js.LGRadioButtonController;b=new js.LGRadioButton({rootId:this.rootId+"_landscape",parentDiv:this.rootId,iconUrl:this.landscapeButtonIconUrl,rootClass:this.orientationButtonClass,iconClass:this.orientationButtonIconClass,tooltip:this.checkForSubstitution(this.landscapeButtonTooltip),
value:this.landscapeServerSpec});b.setIsVisible(!0);this.radioButtonController.addMember(b);a.set(b.rootDiv,"display","inline-block");b=new js.LGRadioButton({rootId:this.rootId+"_portrait",parentDiv:this.rootId,iconUrl:this.portraitButtonIconUrl,rootClass:this.orientationButtonClass,iconClass:this.orientationButtonIconClass,tooltip:this.checkForSubstitution(this.portraitButtonTooltip),value:this.portraitServerSpec});b.setIsVisible(!0);this.radioButtonController.addMember(b);a.set(b.rootDiv,"display",
"inline-block");this.titleEntryTextBox=(new d({id:this.rootId+"_titleEntry",value:this.title,trim:!0,placeHolder:this.titleHint})).placeAt(this.rootId);a.set(this.titleEntryTextBox.domNode,"width","97%");f.add(this.titleEntryTextBox.domNode,this.titleClass);this.authorEntryTextBox=(new d({id:this.rootId+"_authorEntry",value:this.author,trim:!0,placeHolder:this.authorHint})).placeAt(this.rootId);a.set(this.authorEntryTextBox.domNode,"width","97%");f.add(this.authorEntryTextBox.domNode,this.authorClass);
b=new js.LGButton({rootId:this.rootId+"_doPrint",parentDiv:this.rootId,iconUrl:this.printButtonIconUrl,rootClass:this.printButtonClass,iconClass:this.printButtonIconClass,tooltip:this.checkForSubstitution(this.printButtonTooltip)});b.setIsVisible(!0);a.set(b.rootDiv,"display","inline-block");this.radioButtonController.selectMember(0);h(b.rootDiv,"click",function(){var b,a;c.publish(p.publishWorking);p.setIsVisible(!1);b=(b=p.radioButtonController.getCurrentMember())?b.value:null;a=new m;a.map=p.mapObj.mapInfo.map;
a.outSpatialReference=p.mapObj.mapInfo.map.spatialReference;a.template=new t;a.template.format=p.format||"PDF";a.template.layout=b||p.layout||"Letter ANSI A Landscape";a.template.layoutOptions={titleText:p.titleEntryTextBox.value,authorText:p.authorEntryTextBox.value,copyrightText:p.copyrightText};a.template.preserveScale=p.toBoolean(p.preserveScale,!1);a.template.showAttribution=!0;p.printTask.execute(a,function(b){c.publish(p.publishReady);c.publish(p.publishPrintUrl,b.url)},function(b){c.publish(p.publishReady);
p.log("Print failed: "+b.message,!0)})})},checkPrerequisites:function(){if(this.commonConfig.helperServices&&this.commonConfig.helperServices.printTask&&this.commonConfig.helperServices.printTask.url)this.printTask=new e(this.commonConfig.helperServices.printTask.url,{async:!1});else throw this.log("no print task configured"),"no print task configured";}});dojo.declare("js.LGFetchPrintedMap",[js.LGObject,js.LGMapDependency],{constructor:function(){this.fetchPrintUrl=null;this.printAvailabilityTimeoutMinutes=
this.toNumber(this.printAvailabilityTimeoutMinutes,10);this.printTimeouter=null},onDependencyReady:function(){var b=this;c.subscribe(this.triggerPrintUrl,function(a){clearTimeout(b.printTimeouter);b.fetchPrintUrl=a;c.publish(b.publishPrintAvailable);0<b.printAvailabilityTimeoutMinutes&&(b.printTimeouter=setTimeout(function(){c.publish(b.publishPrintNotAvailable)},6E4*b.printAvailabilityTimeoutMinutes))});c.subscribe(this.trigger,function(){null!==b.fetchPrintUrl&&c.publish(b.publish,b.fetchPrintUrl)})}});
dojo.declare("js.LGLocate",js.LGObject,{constructor:function(){var b=this,a;this.ready=new l;Modernizr.geolocation?(c.subscribe(this.trigger,function(){a=setTimeout(function(){alert(b.checkForSubstitution("@messages.geolocationTimeout"))},16E3);navigator.geolocation.getCurrentPosition(function(d){clearTimeout(a);b.log("go to "+d.coords.latitude+" "+d.coords.longitude);c.publish(b.publish,new esri.geometry.Point(d.coords.longitude,d.coords.latitude,new esri.SpatialReference({wkid:4326})))},function(c){clearTimeout(a);
switch(c.code){case c.PERMISSION_DENIED:c=b.checkForSubstitution("@messages.geolocationDenied");break;case c.TIMEOUT:c=b.checkForSubstitution("@messages.geolocationTimeout");break;default:c=b.checkForSubstitution("@messages.geolocationUnavailable")}alert(c)},{timeout:8E3})}),this.ready.resolve(b)):this.ready.reject(b)}});dojo.declare("js.LGSearch",js.LGObject,{constructor:function(){this.busyIndicator&&(this.busyIndicator=q.byId(this.busyIndicator).getLGObject())},search:function(){return null},toList:function(){return[]},
publish:function(b,a){c.publish(b,a)},sortByLabel:function(b,c){var a=0;b&&(c&&b.label&&c.label)&&(a=b.label.localeCompare(c.label));return a},getRepresentativePoint:function(b){var c;"point"===b.type?c=b:"polygon"===b.type?(c=b.getExtent().getCenter(),b.contains(c)||(c=b.getPoint(0,0))):"polyline"===b.type&&(c=b.getPoint(0,0));return c}});dojo.declare("js.LGSearchAddress",js.LGSearch,{constructor:function(){this.searcher=new esri.tasks.Locator(this.searchUrl);this.searcher.outSpatialReference=new esri.SpatialReference({wkid:this.outWkid});
this.params={};this.params.outFields=this.outFields;this.ready=new l;this.ready.resolve(this)},search:function(b,c,a){this.params.address={};this.params.address[this.addressParamName]=b;this.searcher.addressToLocations(this.params,c,a)},toList:function(b){var c,a=this,d=[];b&&g.forEach(b,function(b){c=!1;b.score>=a.minimumScore&&(a.validLocators?g.some(a.validLocators,function(a){if(b.attributes.Loc_name===a)return c=!0}):c=!0);c&&d.push({label:b.address,data:new esri.geometry.Point(b.location.x,
b.location.y,new esri.SpatialReference({wkid:102100}))})});return d},publish:function(b,a){c.publish(b,a)}});dojo.declare("js.LGSearchBoxByText",js.LGDropdownBox,{constructor:function(){var b=this,c,s,f,e,r,l,m,n;c=this.rootId+"_entry";k.create("label",{"for":c,innerHTML:this.checkForSubstitution(this.showPrompt)},this.rootId);s=(new d({id:c,value:"",trim:!0,placeHolder:this.hint,intermediateChanges:!0})).placeAt(this.rootId);a.set(s.domNode,"width","99%");c=k.create("div",{className:this.resultsListBoxClass},
this.rootId);f=k.create("table",{className:this.resultsListTableClass},c);e=k.create("tbody",{className:this.resultsListBodyClass},f);touchScroll(c);r=q.byId(this.searcher).getLGObject();l="";m=0;n=null;h(s,"change",function(){var c=s.get("value");l!==c&&(l=c,k.empty(e),clearTimeout(n),0<c.length&&(n=setTimeout(function(){var a,d,f;a=k.create("tr",null,e);k.create("td",{className:b.resultsListSearchingClass},a);d=m=(new Date).getTime();r.search(c,function(a){d<m||(k.empty(e),a=r.toList(a,c),f=(new Date).getTime(),
b.log("retd "+a.length+" items in "+(f-d)/1E3+" secs"),0<a.length&&g.forEach(a,function(c){var a;a=k.create("tr",null,e);a=k.create("td",{className:b.resultsListEntryClass,innerHTML:c.label},a);b.applyTheme(!0,a);h(a,"click",function(){r.publish(b.publish,c.data)})}))},function(c){b.log("LGSearchBoxByText_1: "+c.message);l="";k.empty(e)})},1E3)))})}});dojo.declare("js.LGSearchFeatureLayer",[js.LGSearch,js.LGMapDependency],{constructor:function(){if(!this.searchPattern||0>this.searchPattern.indexOf("${1}"))this.searchPattern=
"%${1}%";this.caseInsensitiveSearch=this.toBoolean(this.caseInsensitiveSearch,!0);this.ready=new l},onDependencyReady:function(){var b,c,a,d=",",f,e=null,h=this;try{if(b=this.mapObj.getLayer(this.searchLayerName),!b||!b.url)c=this.checkForSubstitution("@messages.searchLayerMissing");else{this.searchURL=b.url;g.forEach(b.fields,function(b){d+=b.name+","});g.every(this.searchFields,function(b){c=b;return 0<=d.indexOf(","+b+",")})||(a='"'+c+'"<br>',a+=this.checkForSubstitution("@messages.searchFieldMissing")+
"<br><hr><br>",a+=this.checkForSubstitution("@prompts.layerFields")+"<br>",1<d.length&&(a+=d.substring(1,d.length-1)),this.log(a,!0));this.objectIdField=b.objectIdField;this.publishPointsOnly="boolean"===typeof this.publishPointsOnly?this.publishPointsOnly:!0;this.searcher=new esri.tasks.QueryTask(this.searchURL);this.generalSearchParams=new esri.tasks.Query;this.generalSearchParams.returnGeometry=!1;this.generalSearchParams.outSpatialReference=this.mapObj.mapInfo.map.spatialReference;this.generalSearchParams.outFields=
[b.objectIdField].concat(this.searchFields);this.objectSearchParams=new esri.tasks.Query;this.objectSearchParams.returnGeometry=!0;this.objectSearchParams.outSpatialReference=this.mapObj.mapInfo.map.spatialReference;this.objectSearchParams.outFields=["*"];f=this.mapObj.mapInfo.itemInfo.itemData.operationalLayers;g.some(f,function(b){return b.title===h.searchLayerName?(e=new esri.dijit.PopupTemplate(b.popupInfo),!0):!1});this.mapObj.setPopup(e);this.log("Search layer "+this.searchLayerName+" set up for queries");
this.ready.resolve(this);this.inherited(arguments);return}}catch(r){c=r.toString()}a='"'+this.searchLayerName+'"<br>';a+=c+"<br><hr><br>";a+=this.checkForSubstitution("@prompts.mapLayers")+"<br><ul>";g.forEach(this.mapObj.getLayerNameList(),function(b){a+='<li>"'+b+'"</li>'});a+="</ul>";this.log(a,!0);this.ready.reject(this);this.inherited(arguments)},checkPrerequisites:function(){var b,a=this;if(this.searchFields&&0<this.searchFields.length)b=this.searchFields.split(","),this.searchFields=[],g.forEach(b,
function(b){a.searchFields.push(b.trim())});else throw this.log("missing search fields"),"missing search fields";},search:function(b,a,c){var d,f="",e,h="";!0===this.caseInsensitiveSearch?(d=b.toUpperCase(),e="UPPER(${0}) LIKE '"+this.searchPattern+"'"):(d=b,e="${0} LIKE '"+this.searchPattern+"'");d=d.replace(/'/g,"''");g.forEach(this.searchFields,function(b){f=f+h+dojo.string.substitute(e,[b,d]);h="  OR  "});0<f.length&&(this.generalSearchParams.where=f,this.searcher.execute(this.generalSearchParams,
a,c))},toList:function(b,a){var c=this,d=[],f,e,h=a.toUpperCase();b&&(b.features&&0<b.features.length)&&(g.forEach(b.features,function(b){e="";g.some(c.searchFields,function(a){return b.attributes[a]&&(f=b.attributes[a].toString(),0<=f.toUpperCase().indexOf(h))?(e=f,!0):!1});""===e&&(e="result");d.push({label:e,data:b.attributes[c.objectIdField]})}),d.sort(c.sortByLabel));return d},publish:function(b,a){var d,f,e=this;this.busyIndicator&&this.busyIndicator.setIsVisible(!0);this.objectSearchParams.where=
this.objectIdField+"="+a;this.searcher.execute(this.objectSearchParams,function(a){a&&a.features&&0<a.features.length?(d=a.features[0],f=e.publishPointsOnly?e.getRepresentativePoint(d.geometry):d,c.publish(b,f)):e.log("LGSearchFeatureLayer_1: no results");e.busyIndicator&&e.busyIndicator.setIsVisible(!1)},function(b){e.log("LGSearchFeatureLayer_2: "+b.message);e.busyIndicator&&e.busyIndicator.setIsVisible(!1)})}});dojo.declare("js.LGShare",js.LGObject,{constructor:function(){var b=this;this.busyIndicator&&
(this.busyIndicator=q.byId(this.busyIndicator).getLGObject());c.subscribe(this.trigger,function(){b.share()})},share:function(){var b=this,a,d;a=encodeURIComponent(this.getSubject());d=encodeURIComponent(this.getUrlToShare());this.tinyURLServiceURL&&0<this.tinyURLServiceURL.length?(this.busyIndicator&&this.busyIndicator.setIsVisible(!0),d=esri.substitute({url:d},this.tinyURLServiceURL),esri.request({url:d,handleAs:"json"},{useProxy:!1}).then(function(d){var e,f;try{if(e=b.followAttributePath(d,b.tinyURLResponseAttribute))f=
esri.substitute({subject:a,url:e},b.shareUrl),c.publish(b.publish,f)}catch(g){b.log("LGShare_1: "+g.toString())}b.busyIndicator&&b.busyIndicator.setIsVisible(!1)},function(a){b.log("LGShare_2: "+a.toString());b.busyIndicator&&b.busyIndicator.setIsVisible(!1)})):(d=esri.substitute({subject:a,url:d},this.shareUrl),c.publish(this.publish,d))},getSubject:function(){return""},getUrlToShare:function(){return this.getAppUrl()},getAppUrl:function(){return window.location.toString()}});dojo.declare("js.LGShareAppExtents",
[js.LGShare,js.LGMapDependency],{getSubject:function(){var b="";this.subject&&(b=this.checkForSubstitution(this.subject));return b},getUrlToShare:function(){var b=this.getAppUrl();return b+(0>b.indexOf("?")?"?":"&")+this.getMapExtentsArg()},getMapExtentsArg:function(){return"ex="+this.mapObj.getExtentsString()}})})},"js/lgonlineDrawing":function(){define("js/lgonlineDrawing",["dojo/topic","dojo/Deferred","dojo/_base/Color","js/lgonlineMap"],function(n,k,q){dojo.declare("js.LGHighlighter",[js.LGObject,
js.LGMapDependency],{onDependencyReady:function(){var h,l,a=this;this.highlighterLayer=a.mapObj.createGraphicsLayer("highlighterLayer");this.lineHiliteColor=new q(this.lineHiliteColor?this.lineHiliteColor:"#0000ff");this.fillHiliteColor=new q(this.fillHiliteColor?this.fillHiliteColor:[0,0,255,0.1]);this.intervalID=this.intervalTerminator=null;n.subscribe("highlightItem",function(f){var g,c,d;f&&(g=f.geometry?f.geometry:f,f.attributes&&(c=f.attributes),f.infoTemplate&&(d=f.infoTemplate),f=a.createHighlightGraphics(g,
c,d),l=(h=g.getExtent())?h.getCenter():g,a.showHighlight(f,l,a.highlightZoomLevel,c&&a.showFeaturePopup))})},createHighlightGraphics:function(h,l,a){var f,g=[];if("polyline"===h.type)g.push(new esri.Graphic(h,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.lineHiliteColor,3),l,a));else if("point"===h.type)for(f=0;4>=f;++f)g.push(new esri.Graphic(h,new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,2.5*(f+16),new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,
new dojo.Color(this.lineHiliteColor),3),new dojo.Color([0,0,0,0])),l,a));else g.push(new esri.Graphic(h,new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.lineHiliteColor,3),this.fillHiliteColor),l,a));return g},showHighlight:function(h,l,a,f){var g,c,d,r,e=this;l?g=this.mapObj.centerAt(l):(g=new k,g.resolve());g.then(function(){a?c=e.mapObj.setZoom(a):(c=new k,c.resolve());c.then(function(){1<h.length?
(e.intervalTerminator&&(clearTimeout(e.intervalTerminator),clearInterval(e.intervalID)),d=0,r=!0,e.intervalID=setInterval(function(){e.highlighterLayer.clear();e.highlighterLayer.add(h[d]);r?++d:--d;d===h.length?(r=!1,--d):0>d&&(r=!0,d=0)},120),e.intervalTerminator=setTimeout(function(){clearInterval(e.intervalID);e.intervalTerminator=null;e.intervalID=null;e.highlighterLayer.clear()},5E3)):(e.highlighterLayer.clear(),e.highlighterLayer.add(h[0]));f&&e.mapObj.showPopupWithFeature(l,h[0])})})}})})},
"js/lgonlineFrame":function(){define("js/lgonlineFrame","dojo/dom-construct dojo/on dojo/dom-style dojo/_base/array dojo/_base/lang js/lgonlineBase".split(" "),function(n,k,q,h,l){dojo.declare("js.LGColorizer",js.LGObject,{constructor:function(){var a="",f=this,g=["#fff","#333333","#5d5d5d","#5d5d5d"];h.some(this.colorTable,function(a){return f.theme===a.theme?(g=a.colors,!0):!1});a+=".appTheme{color:"+g[0]+";background-color:"+g[1]+"}";a+=".appTheme2{color:"+g[0]+";background-color:"+g[3]+"}";a+=
".appThemeHover:hover{background-color:"+g[2]+"}";this.injectCSS(a)}});dojo.declare("js.LGFrame",js.LGGraphic,{constructor:function(){var a;a={};this.headerDivId&&(a.id=this.headerDivId);this.headerDivClass&&(a.className=this.headerDivClass);this.headerDiv=n.create("div",a,this.rootDiv);this.applyTheme(!1,this.headerDiv);a={};this.contentDivId&&(a.id=this.contentDivId);this.contentDivClass&&(a.className=this.contentDivClass);this.contentDiv=n.create("div",a,this.rootDiv);this.handleWindowResize()},
handleWindowResize:function(){this.inherited(arguments);this.resizeContentDiv()},resizeContentDiv:function(){var a,f,g;this.headerDiv&&this.contentDiv&&(a=dojo.marginBox(this.rootDiv),f=dojo.marginBox(this.headerDiv),g=a.h-f.h,0<g&&(g={},g.top=f.h+"px",g.height=a.h-f.h+"px",q.set(this.contentDiv,g)))}});dojo.declare("js.LGGallery",js.LGGraphic,{constructor:function(){var a,f=this;a=n.create("table",null,this.rootDiv);this.applyTheme(!1,a);k(window,"resize",l.hitch(this,this.handleParentResize));this.rootDiv.getContentDiv=
function(){return f.addItem()};a=n.create("tbody",null,a);this.galleryRow=n.create("tr",null,a);a={innerHTML:"&lt;",style:{visibility:"hidden"}};this.arrowClass&&(a.className=this.arrowClass);this.leftArrow=n.create("td",a,this.galleryRow);this.applyTheme(!0,this.leftArrow);k(this.leftArrow,"click",l.hitch(this,this.shiftLeft));a.innerHTML="&gt;";this.rightArrow=n.create("td",a,this.galleryRow);this.applyTheme(!0,this.rightArrow);k(this.rightArrow,"click",l.hitch(this,this.shiftRight));this.zeroItemWidth=
dojo.marginBox(this.rootDiv).w;this.numItemsToDisplay=this.iFirstItem=this.numItems=this.itemWidth=0;this.firstItem=null;this.handleParentResize()},addItem:function(a){var f;f={};"string"===typeof a&&(f.innerHTML=a);this.itemClass&&(f.className=this.itemClass);f=n.create("td",f);"string"!==typeof a&&f.appendChild(a);this.galleryRow.insertBefore(f,this.rightArrow);this.numItems+=1;this.firstItem||(this.firstItem=f,this.itemWidth=dojo.marginBox(f).w);this.handleParentResize();return f},clearItems:function(){for(;2<
this.galleryRow.childNodes.length;)this.galleryRow.removeChild(this.galleryRow.childNodes[1]);this.numItemsToDisplay=this.iFirstItem=this.numItems=0;this.firstItem=null;this.handleParentResize()},handleParentResize:function(){var a,f;0===this.zeroItemWidth&&(this.zeroItemWidth=dojo.marginBox(this.rootDiv).w);a=dojo.marginBox(this.rootDiv.parentNode).w;f=this.zeroItemWidth+this.numItems*this.itemWidth;0!==this.numItems&&(f>a?(this.leftArrow.style.visibility="visible",this.rightArrow.style.visibility=
"visible",this.numItemsToDisplay=Math.max(Math.floor((a-this.zeroItemWidth)/this.itemWidth),1)):(this.leftArrow.style.visibility="hidden",this.rightArrow.style.visibility="hidden",this.numItemsToDisplay=this.numItems),this.iFirstItem=Math.min(this.iFirstItem,this.numItems-this.numItemsToDisplay),this.drawGallery())},shiftLeft:function(){this.iFirstItem=Math.min(this.iFirstItem+1,this.numItems-this.numItemsToDisplay);this.drawGallery()},shiftRight:function(){this.iFirstItem=Math.max(this.iFirstItem-
1,0);this.drawGallery()},drawGallery:function(){var a,f=this.iFirstItem,g=this.iFirstItem+this.numItemsToDisplay,c=this.firstItem;this.leftArrow.style.visibility="hidden";this.rightArrow.style.visibility="hidden";for(a=0;a<f;)this.rightArrow.style.visibility="visible",c.style.display="none",c=c.nextSibling,a+=1;for(;a<g;)c.style.display="",c=c.nextSibling,a+=1;for(;a<this.numItems;)this.leftArrow.style.visibility="visible",c.style.display="none",c=c.nextSibling,a+=1;this.handleWindowResize()}});dojo.declare("js.LGTitleBar",
js.LGGraphic,{constructor:function(){var a;this.iconUrl&&0<this.iconUrl.length&&(a={src:this.iconUrl},this.iconClass&&(a.className=this.iconClass),n.create("img",a,this.rootDiv));this.title&&0<this.title.length&&(a={innerHTML:this.title},this.titleClass&&(a.className=this.titleClass),n.create("span",a,this.rootDiv),document.title=this.title);this.handleWindowResize()}})})},"js/lgonlineMap":function(){define("js/lgonlineMap","dojo/dom-construct dojo/on dojo/_base/lang dojo/_base/array dojo/Deferred dojo/query esri/arcgis/utils dojo/topic dojo/_base/Color js/lgonlineBase".split(" "),
function(n,k,q,h,l,a,f,g,c){dojo.declare("js.LGMapDependency",js.LGDependency,{onDependencyPrep:function(a){this.mapObj=a;this.inherited(arguments)}});dojo.declare("js.LGMap",js.LGGraphic,{constructor:function(){var a,h,e=null,m=this;this.ready=new l;a={};a.mapOptions=this.mapOptions||{};a.mapOptions.showAttribution=!0;this.popup=new esri.dijit.Popup(null,n.create("div"));a.mapOptions.infoWindow=this.popup;if(this.xmin&&this.ymin&&this.xmax&&this.ymax)try{e={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,
ymax:this.ymax,spatialReference:{}},e.spatialReference.wkid=this.wkid?Number(this.wkid):102100,e=new esri.geometry.Extent(e)}catch(t){e=null}if(this.ex){h=this.ex.split(",");1===h.length&&(h=this.ex.split("%2C"));try{e={xmin:Number(h[0]),ymin:Number(h[1]),xmax:Number(h[2]),ymax:Number(h[3]),spatialReference:{}},e.spatialReference.wkid=4<h.length?Number(h[4]):102100,e=new esri.geometry.Extent(e)}catch(b){e=null}}this.commonConfig&&this.commonConfig.bingMapsKey&&(a.bingMapsKey=this.commonConfig.bingMapsKey);
this.lineHiliteColor=new c(this.lineHiliteColor||"#00ffff");this.fillHiliteColor=new c(this.fillHiliteColor||[0,255,255,0.1]);this.featureZoomFactor=this.featureZoomFactor||2;this.showFeaturePopup=this.toBoolean(this.showFeaturePopup,!0);this.webmap&&(this.mapId=this.webmap);f.createMap(this.mapId,this.rootDiv,a).then(function(a){m.mapInfo=a;a.map.spatialReference||(m.mapInfo.map.spatialReference=new esri.SpatialReference({wkid:102100}));k(window,"resize",q.hitch(m.mapInfo.map,function(){m.mapInfo.map.resize();
m.mapInfo.map.reposition()}));e&&(e.spatialReference.wkid!==m.mapInfo.map.spatialReference.wkid?esri.config.defaults.geometryService?(a=new esri.tasks.ProjectParameters,a.geometries=[e],a.outSR=m.mapInfo.map.spatialReference,esri.config.defaults.geometryService.project(a).then(function(a){e=a[0];m.mapInfo.map.setExtent(e)})):m.log("LGMap_1: Need geometry service to convert extents from wkid "+e.spatialReference.wkid+" to map's "+m.mapInfo.map.spatialReference.wkid):m.mapInfo.map.setExtent(e));m.tempGraphicsLayer=
m.createGraphicsLayer("tempGraphicsLayer");m.positionHandle=g.subscribe("position",function(a){if(a.spatialReference.wkid===m.mapInfo.map.spatialReference.wkid)g.publish("highlightItem",a);else if(4326===a.spatialReference.wkid&&102100===m.mapInfo.map.spatialReference.wkid)a=esri.geometry.geographicToWebMercator(a),g.publish("highlightItem",a);else if(esri.config.defaults.geometryService){var b=new esri.tasks.ProjectParameters;b.geometries=[a];b.outSR=m.mapInfo.map.spatialReference;esri.config.defaults.geometryService.project(b).then(function(b){a=
b[0];g.publish("highlightItem",a)})}else m.log("LGMap_1: Need geometry service to convert position from wkid "+a.spatialReference.wkid+" to map's "+m.mapInfo.map.spatialReference.wkid)});m.showFeatureHandle=g.subscribe("showFeature",function(a){m.popupTemplate&&(a.infoTemplate=m.popupTemplate);g.publish("highlightItem",a)});m.ready.resolve(m)},function(){m.ready.reject(m)})},mapInfo:function(){return this.mapInfo},setPopup:function(a){this.popupTemplate=a},showPopupWithFeature:function(a,c){this.popup.clearFeatures();
this.popup.setContent(c.getContent());this.mapInfo.map.infoWindow.show(this.mapInfo.map.toScreen(a))},setExtent:function(a){return this.mapInfo.map.setExtent(a)},centerAt:function(a){return this.mapInfo.map.centerAt(a)},setZoom:function(a){var c=this.mapInfo.map.getMinZoom(),e=this.mapInfo.map.getMaxZoom();0<=c&&0<=e&&(a=Math.max(c,Math.min(e,a)));return this.mapInfo.map.setZoom(a)},getExtentsString:function(){var a;a="";this.mapInfo&&this.mapInfo.map&&(a=this.mapInfo.map.extent,a=a.xmin.toFixed().toString()+
","+a.ymin.toFixed().toString()+","+a.xmax.toFixed().toString()+","+a.ymax.toFixed().toString()+","+a.spatialReference.wkid.toString());return a},getLayer:function(a){var c;h.some(this.mapInfo.itemInfo.itemData.operationalLayers,function(e){return e.title===a?(c=e.layerObject,!0):!1});return c},getLayerNameList:function(){var a=[];h.forEach(this.mapInfo.itemInfo.itemData.operationalLayers,function(c){a.push(c.title)});return a},getOperationalLayers:function(){return this.mapInfo.itemInfo.itemData.operationalLayers},
createGraphicsLayer:function(a){var c=new esri.layers.GraphicsLayer;c.id=a;return this.mapInfo.map.addLayer(c)},enablePopups:function(){this.mapInfo&&this.mapInfo.clickEventListener&&(this.mapInfo.clickEventHandle=k(this.mapInfo.map,"click",this.mapInfo.clickEventListener))},disablePopups:function(){this.mapInfo&&this.mapInfo.clickEventHandle&&this.mapInfo.clickEventHandle.remove()}})})},"js/lgonlineOutput":function(){define("js/lgonlineOutput",["dojo/dom-construct","dojo/dom-class","js/lgonlineBase"],
function(n,k){dojo.declare("js.LGBusy",js.LGGraphic,{constructor:function(){this.busyImageClass&&k.add(this.rootDiv,this.busyImageClass)}});dojo.declare("js.LGLogBox",js.LGDropdownBox,{constructor:function(){window.gLogMessageBox=this;touchScroll(this.rootDiv)},append:function(k){"string"===typeof k?n.create("div",{innerHTML:k,style:"margin:2px"},this.rootDiv):"object"===typeof k&&null!==k&&this.rootDiv.appendChild(k)}});dojo.declare("js.LGMessageBox",js.LGDropdownBox,{constructor:function(){this.content&&
0<this.content.length&&(this.rootDiv.innerHTML=this.content);touchScroll(this.rootDiv)}});dojo.declare("js.LGPublishEcho",js.LGDropdownBox,{handleTrigger:function(k){this.rootDiv.innerHTML=k.toString();this.toggleVisibility()}})})}}});
