/* 
This source is a compressed form of part of the git commit 
14d81b237dec3862 2013-12-18 07:57:23 -0800
Uncompressed source is available from https://github.com/Esri/local-government-online-apps 
*/ 
/*

 | ArcGIS Solutions
 | Version 10.2
 | Copyright 2012 Esri
 |
 | Licensed under the Apache License, Version 2.0 (the "License");
 | you may not use this file except in compliance with the License.
 | You may obtain a copy of the License at
 |
 |    http://www.apache.org/licenses/LICENSE-2.0
 |
 | Unless required by applicable law or agreed to in writing, software
 | distributed under the License is distributed on an "AS IS" BASIS,
 | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 | See the License for the specific language governing permissions and
 | limitations under the License.
*/
define("js/lgonlineApp","js/lgonlineBase js/lgonlineCommand js/lgonlineDrawing js/lgonlineEditing js/lgonlineFrame js/lgonlineMap js/lgonlineOutput".split(" "),function(){return{}});
require({cache:{"js/lgonlineBase":function(){define("js/lgonlineBase","dojo/dom-construct dojo/dom dojo/on dojo/dom-style dojo/dom-class dojo/_base/array dojo/topic dojo/_base/lang".split(" "),function(h,n,m,k,g,d,e,c){dojo.declare("js.LGObject",null,{constructor:function(a){var f,c,d=this;void 0!==a&&dojo.safeMixin(this,a);this.checkPrerequisites&&this.checkPrerequisites();a={};this.rootId&&(a.id=this.rootId);this.rootClass?a.className=this.rootClass:a.style="display:none";void 0!==this.parentDiv?
(f=this.parentDiv,(c=n.byId(f))||(f=null)):f=null;c&&c.getLGObject&&c.getLGObject().addItem?(this.rootDiv=h.create("div",a),c.getLGObject().addItem(this.rootDiv)):this.rootDiv=h.create("div",a,f);this.rootDiv.getLGObject=function(){return d}},getRootDiv:function(){return this.rootDiv},lgById:function(a){var f=null;(a=n.byId(a))&&a.getLGObject&&(f=a.getLGObject());return f},deleteDivFromDom:function(){this.rootDiv&&this.rootDiv.parentNode.removeChild(this.rootDiv)},injectCSS:function(a){var f;f=document.createElement("style");
f.setAttribute("type","text/css");f.styleSheet?f.styleSheet.cssText=a:(a=document.createTextNode(a),f.appendChild(a));document.body.appendChild(f);return f},checkForSubstitution:function(a){var f,c=a;a&&1<a.length&&(f=a.substring(0,1),"@"===f?this.i18n&&(c=this.followAttributePath(this.i18n,a.substring(1))):"."===f&&(c=this.followAttributePath(null,a.substring(1))));return c},followAttributePath:function(a,f){var c,d=a,e;try{e=f.split(".");for(c=0;c<e.length;c+=1)d=null===d?this.lgById(e[c]):d[e[c]]}catch(g){d=
null}return d},toBoolean:function(a,c){var d;if(!0===a)return!0;if(!1===a)return!1;if("string"===typeof a){d=a.toLowerCase();if("true"===d)return!0;if("false"===d)return!1}return void 0===c?!0:c},toNumber:function(a,c){if("number"===typeof a)return a;a=parseFloat(a);return!isNaN(a)?a:void 0===c?0:c},log:function(a,c){console&&console.log(a);c&&this.publishMessage("error",a);window.gLogMessageBox&&window.gLogMessageBox.append(a)},publishMessage:function(a,c){e.publish("publish",{id:this.rootId,tag:a,
data:c});e.publish(a,c)},subscribeToMessage:function(a,c){var d=this;e.subscribe(a,function(c){e.publish("receive",{id:d.rootId,tag:a,data:c})});e.subscribe(a,c)}});dojo.declare("js.LGGraphic",js.LGObject,{constructor:function(){m(window,"resize",c.hitch(this,this.handleWindowResize));this.handleWindowResize()},setIsVisible:function(a,c){c?(k.set(this.getRootDiv(),"display","block"),k.set(this.getRootDiv(),"visibility",a?"visible":"hidden")):(k.set(this.getRootDiv(),"display",a?"block":"none"),k.set(this.getRootDiv(),
"visibility","visible"))},getIsVisible:function(){return"none"!==k.get(this.getRootDiv(),"display")},toggleVisibility:function(){k.set(this.getRootDiv(),"display",this.getIsVisible()?"none":"block")},handleWindowResize:function(){void 0!==this.fill&&!0===this.fill?this.fillParentDiv():void 0!==this.horizOffset&&void 0!==this.vertOffset&&this.alignOver(this.rootDiv,this.rootDiv.parentNode,this.horizOffset,this.vertOffset)},fillParentDiv:function(){var a;this.rootDiv.parentNode&&(a={left:"0px",top:"0px",
width:this.rootDiv.parentNode.clientWidth+"px",height:this.rootDiv.parentNode.clientHeight+"px"},dojo.style(this.rootDiv,a))},alignOver:function(a,c,e,g){var h,m,k,n=this;a&&c&&(h=dojo.marginBox(a),m=dojo.marginBox(c),k={},"number"===typeof e?k=this.insertHorizPositioningStyle(k,e,h,m):"object"===typeof e&&d.forEach(e,function(a){k=n.insertHorizPositioningStyle(k,a,h,m)}),"number"===typeof g?k=this.insertVertPositioningStyle(k,g,h,m):"object"===typeof g&&d.forEach(g,function(a){k=n.insertVertPositioningStyle(k,
a,h,m)}),dojo.style(a,k))},insertHorizPositioningStyle:function(a,c,d,e){0<c?a.left=c+"px":0===c?a.left=Math.round((e.w-d.w)/2)+"px":a.right=-c+"px";return a},insertVertPositioningStyle:function(a,c,d,e){0<c?a.top=c+"px":0===c?a.top=Math.round((e.h-d.h)/2)+"px":a.bottom=-c+"px";return a},applyTheme:function(a,c){g.remove(c||this.rootDiv,"appTheme2");g.add(c||this.rootDiv,"appTheme");a&&g.add(c||this.rootDiv,"appThemeHover")},applyThemeAltBkgd:function(a,c){g.remove(c||this.rootDiv,"appTheme");g.add(c||
this.rootDiv,"appTheme2");a&&g.add(c||this.rootDiv,"appThemeHover")}});dojo.declare("js.LGDependency",null,{constructor:function(){var a,c=this;this.dependencyId&&(a=this.lgById(this.dependencyId),this.onDependencyPrep(a),a.ready.then(function(){c.onDependencyReady()}))},onDependencyPrep:function(){return null},onDependencyReady:function(){return null}});dojo.declare("js.LGDefaults",null,{constructor:function(){this.defaultValues={};this.listenForDefaultsTrigger&&this.listenForDefaultsUpdate()},listenForDefaultsUpdate:function(){var c=
this;this.subscribeToMessage(this.listenForDefaultsTrigger,function(d){c.defaultValues=d;c.onDefaultsUpdate()})},onDefaultsUpdate:function(){return null},changeDefaults:function(){this.broadcastDefaultsUpdate()},broadcastDefaultsUpdate:function(){this.broadcastDefaultsPublish&&this.publishMessage(this.broadcastDefaultsPublish,this.defaultValues)}})})},"js/lgonlineCommand":function(){define("js/lgonlineCommand","dojo/dom-construct dojo/dom dojo/on dojo/Deferred dojo/DeferredList dojo/dom-style dojo/dom-class dojo/_base/array dojo/_base/lang dojo/string dijit/form/TextBox dijit/layout/ContentPane esri/dijit/BasemapGallery esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/tasks/LegendLayer esri/dijit/PopupTemplate js/lgonlineBase js/lgonlineMap".split(" "),
function(h,n,m,k,g,d,e,c,a,f,l,q,p,r,s,t,u,v){dojo.declare("js.LGDropdownBox",js.LGGraphic,{constructor:function(){var b=this;this.applyTheme(!1);this.isShowable=!0;this.trigger&&(this.subscribeToMessage("command",function(c){c!==b.trigger&&b.setIsVisible(!1)}),this.subscribeToMessage(this.trigger,function(c){b.handleTrigger(c)}))},setShowable:function(b){this.isShowable=b;!this.isShowable&&this.getIsVisible()&&this.toggleVisibility()},handleTrigger:function(){this.isShowable&&this.toggleVisibility()}});
dojo.declare("js.LGMapBasedMenuBox",[js.LGDropdownBox,js.LGMapDependency],{constructor:function(){this.ready=new k},onDependencyReady:function(){this.ready.resolve(this);this.inherited(arguments)}});dojo.declare("js.LGBasemapBox",js.LGMapBasedMenuBox,{onDependencyReady:function(){var b,c,a=this.getBasemapGroup();b=this.rootId+"_gallery";c=(new q({id:b,className:this.galleryClass})).placeAt(this.rootDiv);touchScroll(b);b=(new p({showArcGISBasemaps:!0,basemapsGroup:a,bingMapsKey:this.mapObj.commonConfig.bingMapsKey,
map:this.mapObj.mapInfo.map},h.create("div"))).placeAt(this.rootDiv);c.set("content",b.domNode);b.startup();this.inherited(arguments)},getBasemapGroup:function(){var b=null;this.basemapgroupTitle&&(this.basemapgroupOwner&&0<this.basemapgroupTitle.length&&0<this.basemapgroupOwner.length)&&(b={title:this.basemapgroupTitle,owner:this.basemapgroupOwner});return b}});dojo.declare("js.LGCallMethods",js.LGObject,{constructor:function(){var b,a=this;this.todo&&c.forEach(this.todo,function(c){try{if(b=n.byId(c.rootId))if(b=
b.getLGObject())b[c.method](c.arg)}catch(d){a.log("LGCallMethods_1: "+d.toString())}})}});dojo.declare("js.LGButton",js.LGGraphic,{constructor:function(){var b;this.applyTheme(!0);this.iconUrl&&(b={src:this.iconUrl},this.iconClass&&(b.className=this.iconClass),this.iconImg=h.create("img",b,this.rootDiv));this.displayText&&(b={innerHTML:this.checkForSubstitution(this.displayText)},this.displayTextClass&&(b.className=this.displayTextClass),h.create("div",b,this.rootDiv));this.tooltip&&(this.rootDiv.title=
this.checkForSubstitution(this.tooltip))}});dojo.declare("js.LGRadioButton",js.LGButton,{constructor:function(){this.isOn=this.toBoolean(this.isOn,!1);this.setIsOn(this.isOn);this.controller=null;m(this.rootDiv,"click",this.handleClick)},setController:function(b){this.controller=b},setIsOn:function(b){(this.isOn=b)?this.applyThemeAltBkgd(!0):this.applyTheme(!0)},handleClick:function(b){b=b.currentTarget.getLGObject();b.controller&&b.controller.selectMember(b)}});dojo.declare("js.LGRadioButtonController",
js.LGObject,{constructor:function(){this.members=[];this.currentMember=null},addMember:function(b){this.members.push(b);b.setController(this)},selectMember:function(b){var a,d=this;this.currentMember&&(this.currentMember.setIsOn(!1),this.currentMember=null);"number"===typeof b?0<this.members.length&&(b=Math.max(0,Math.min(b,d.members.length-1)),d.currentMember=d.members[b],d.currentMember.setIsOn(!0)):"string"===typeof b?c.some(this.members,function(c){return c.value===b?(d.currentMember=c,d.currentMember.setIsOn(!0),
!0):!1}):b&&(a=b.rootId,c.some(this.members,function(b){return b.rootId===a?(d.currentMember=b,d.currentMember.setIsOn(!0),!0):!1}))},getCurrentMember:function(){return this.currentMember}});dojo.declare("js.LGCommand",[js.LGButton,js.LGDependency],{constructor:function(){this.publish&&(this.clickHandler=m(this.rootDiv,"click",this.handleClick))},onDependencyPrep:function(){this.setIsVisible(!1);this.inherited(arguments)},onDependencyReady:function(){this.setIsVisible(!0);this.inherited(arguments)},
handleClick:function(b){b=b.currentTarget.getLGObject();b.publishMessage("command",b.publish);b.publishMessage(b.publish,b.publishArg)}});dojo.declare("js.LGCommandToggle",js.LGCommand,{constructor:function(){var b=this;this.iconDisabledUrl=this.iconDisabledUrl||this.iconUrl;this.isEnabled=this.toBoolean(this.isEnabled,!0);b.setIsEnabled(this.isEnabled);this.isVisible=this.toBoolean(this.isVisible,!0);b.setIsVisible(this.isVisible);this.triggerEnable&&this.subscribeToMessage(this.triggerEnable,function(){b.isEnabled=
!0;b.setIsEnabled(b.isEnabled)});this.triggerDisable&&this.subscribeToMessage(this.triggerDisable,function(){b.isEnabled=!1;b.setIsEnabled(b.isEnabled)});this.triggerVisible&&this.subscribeToMessage(this.triggerVisible,function(){b.isVisible=!0;b.setIsVisible(b.isVisible)});this.triggerInvisible&&this.subscribeToMessage(this.triggerInvisible,function(){b.isVisible=!1;b.setIsVisible(b.isVisible)})},setIsEnabled:function(b){(this.isEnabled=b)?(this.iconImg.src=this.iconUrl,e.add(this.rootDiv,"appThemeHover")):
(this.iconImg.src=this.iconDisabledUrl,e.remove(this.rootDiv,"appThemeHover"))},handleClick:function(b){var c=b.currentTarget.getLGObject();c.isEnabled&&c.inherited("handleClick",arguments)}});dojo.declare("js.LGLaunchUrl",js.LGObject,{constructor:function(){this.subscribeToMessage(this.sameWinTrigger,function(b){b&&window.open(b,"_parent")});this.subscribeToMessage(this.newWinTrigger,function(b){b&&window.open(b,"_blank")})}});dojo.declare("js.LGPrintMap",js.LGMapBasedMenuBox,{constructor:function(){var b,
a=this;this.radioButtonController=new js.LGRadioButtonController;b=new js.LGRadioButton({rootId:this.rootId+"_landscape",parentDiv:this.rootId,iconUrl:this.landscapeButtonIconUrl,rootClass:this.orientationButtonClass,iconClass:this.orientationButtonIconClass,tooltip:this.checkForSubstitution(this.landscapeButtonTooltip),value:this.landscapeServerSpec});b.setIsVisible(!0);this.radioButtonController.addMember(b);d.set(b.rootDiv,"display","inline-block");b=new js.LGRadioButton({rootId:this.rootId+"_portrait",
parentDiv:this.rootId,iconUrl:this.portraitButtonIconUrl,rootClass:this.orientationButtonClass,iconClass:this.orientationButtonIconClass,tooltip:this.checkForSubstitution(this.portraitButtonTooltip),value:this.portraitServerSpec});b.setIsVisible(!0);this.radioButtonController.addMember(b);d.set(b.rootDiv,"display","inline-block");this.titleEntryTextBox=(new l({id:this.rootId+"_titleEntry",value:this.title,trim:!0,placeHolder:this.titleHint||this.checkForSubstitution(this.titleHintDefault)||""})).placeAt(this.rootId);
d.set(this.titleEntryTextBox.domNode,"width","97%");e.add(this.titleEntryTextBox.domNode,this.titleClass);this.authorEntryTextBox=(new l({id:this.rootId+"_authorEntry",value:this.author,trim:!0,placeHolder:this.authorHint||this.checkForSubstitution(this.authorHintDefault)||""})).placeAt(this.rootId);d.set(this.authorEntryTextBox.domNode,"width","97%");e.add(this.authorEntryTextBox.domNode,this.authorClass);b=new js.LGButton({rootId:this.rootId+"_doPrint",parentDiv:this.rootId,iconUrl:this.printButtonIconUrl,
rootClass:this.printButtonClass,iconClass:this.printButtonIconClass,tooltip:this.checkForSubstitution(this.printButtonTooltip)});b.setIsVisible(!0);d.set(b.rootDiv,"display","inline-block");this.radioButtonController.selectMember(0);m(b.rootDiv,"click",function(){var b,d,f=[],e;a.publishMessage(a.publishWorking);a.setIsVisible(!1);b=a.mapObj.getOperationalLayers();c.forEach(b,function(b){d=new u;d.layerId=b.id;f.push(d)});b=(b=a.radioButtonController.getCurrentMember())?b.value:null;e=new s;e.map=
a.mapObj.mapInfo.map;e.outSpatialReference=a.mapObj.mapInfo.map.spatialReference;e.template=new t;e.template.format=a.format||"PDF";e.template.layout=b||a.layout||"Letter ANSI A Landscape";e.template.layoutOptions={titleText:a.titleEntryTextBox.value,authorText:a.authorEntryTextBox.value,copyrightText:a.copyrightText,legendLayers:f};e.template.preserveScale=a.toBoolean(a.preserveScale,!1);e.template.showAttribution=!0;a.printTask.execute(e,function(b){a.publishMessage(a.publishReady);a.publishMessage(a.publishPrintUrl,
b.url)},function(b){a.publishMessage(a.publishReady);a.log("Print failed: "+b.message,!0)})})},checkPrerequisites:function(){if(this.commonConfig.helperServices&&this.commonConfig.helperServices.printTask&&this.commonConfig.helperServices.printTask.url)this.printTask=new r(this.commonConfig.helperServices.printTask.url,{async:!1});else throw this.log("no print task configured"),"no print task configured";}});dojo.declare("js.LGFetchPrintedMap",[js.LGObject,js.LGMapDependency],{constructor:function(){this.fetchPrintUrl=
null;this.printAvailabilityTimeoutMinutes=this.toNumber(this.printAvailabilityTimeoutMinutes,10);this.printTimeouter=null},onDependencyReady:function(){var b=this;this.subscribeToMessage(this.triggerPrintUrl,function(a){clearTimeout(b.printTimeouter);b.fetchPrintUrl=a;b.publishMessage(b.publishPrintAvailable);0<b.printAvailabilityTimeoutMinutes&&(b.printTimeouter=setTimeout(function(){b.publishMessage(b.publishPrintNotAvailable)},6E4*b.printAvailabilityTimeoutMinutes))});this.subscribeToMessage(this.trigger,
function(){null!==b.fetchPrintUrl&&b.publishMessage(b.publish,b.fetchPrintUrl)})}});dojo.declare("js.LGLocate",js.LGObject,{constructor:function(){var b=this,a;this.ready=new k;Modernizr.geolocation?(this.subscribeToMessage(this.trigger,function(){a=setTimeout(function(){alert(b.checkForSubstitution("@messages.geolocationTimeout"))},16E3);navigator.geolocation.getCurrentPosition(function(c){clearTimeout(a);b.log("go to "+c.coords.latitude+" "+c.coords.longitude);b.publishMessage(b.publish,new esri.geometry.Point(c.coords.longitude,
c.coords.latitude,new esri.SpatialReference({wkid:4326})))},function(c){clearTimeout(a);switch(c.code){case c.PERMISSION_DENIED:c=b.checkForSubstitution("@messages.geolocationDenied");break;case c.TIMEOUT:c=b.checkForSubstitution("@messages.geolocationTimeout");break;default:c=b.checkForSubstitution("@messages.geolocationUnavailable")}alert(c)},{timeout:8E3})}),this.ready.resolve(b)):this.ready.reject(b)}});dojo.declare("js.LGSearch",js.LGObject,{constructor:function(){this.busyIndicator&&(this.busyIndicator=
this.lgById(this.busyIndicator))},search:function(){return null},toList:function(){return[]},publish:function(b,c){this.publishMessage(b,c)},sortByLabel:function(b,c){var a=0;b&&(c&&b.label&&c.label)&&(a=b.label.localeCompare(c.label));return a},getRepresentativePoint:function(b){var c;"point"===b.type?c=b:"polygon"===b.type?(c=b.getExtent().getCenter(),b.contains(c)||(c=b.getPoint(0,0))):"polyline"===b.type&&(c=b.getPoint(0,0));return c}});dojo.declare("js.LGSearchAddress",[js.LGSearch,js.LGMapDependency],
{constructor:function(){this.searcher=new esri.tasks.Locator(this.searchUrl);this.searcher.outSpatialReference=new esri.SpatialReference({wkid:this.outWkid});this.params={};this.params.outFields=this.outFields;this.ready=new k},onDependencyReady:function(){this.params.searchExtent=this.mapObj.mapInfo.map.extent;this.ready.resolve(this);this.inherited(arguments)},search:function(b,c,a){this.params.address={};this.params.address[this.addressParamName]=b;this.searcher.addressToLocations(this.params,
c,a)},toList:function(b){var a,d=this,f=[];b&&c.forEach(b,function(b){a=!1;b.score>=d.minimumScore&&(d.validLocators?c.some(d.validLocators,function(c){if(b.attributes.Loc_name===c)return a=!0}):a=!0);a&&f.push({label:b.address,data:new esri.geometry.Point(b.location.x,b.location.y,new esri.SpatialReference({wkid:102100}))})});return f},publish:function(b,c){this.publishMessage(b,c)}});dojo.declare("js.LGSearchFeatureLayer",[js.LGSearch,js.LGMapDependency],{constructor:function(){if(!this.searchPattern||
0>this.searchPattern.indexOf("${1}"))this.searchPattern="%${1}%";this.caseInsensitiveSearch=this.toBoolean(this.caseInsensitiveSearch,!0);this.ready=new k},onDependencyReady:function(){var b,a,d,f=",",e,g=null,h=this,k=[];try{if(b=this.mapObj.getLayer(this.searchLayerName),!b||!b.url)a=this.checkForSubstitution("@messages.searchLayerMissing");else{this.searchURL=b.url;c.forEach(b.fields,function(b){f+=b.name+","});c.forEach(this.searchFields,function(b){0<=f.indexOf(","+b+",")&&k.push(b)});if(0===
k.length){a="";c.forEach(this.searchFields,function(b){0<a.length&&(a+=",");a+=b});d='"'+a+'"<br>';d=1<this.searchFields.length?d+this.checkForSubstitution("@messages.allSearchFieldsMissing"):d+this.checkForSubstitution("@messages.searchFieldMissing");d+='<br><hr>"'+this.searchLayerName+'"<br>';d+=this.checkForSubstitution("@prompts.layerFields")+"<br><ul>";c.forEach(b.fields,function(b){d+='<li>"'+b.name+'"</li>'});d+="</ul>";this.log(d,!0);this.ready.reject(this);this.inherited(arguments);return}this.searchFields=
k;this.objectIdField=b.objectIdField;this.publishPointsOnly="boolean"===typeof this.publishPointsOnly?this.publishPointsOnly:!0;this.searcher=new esri.tasks.QueryTask(this.searchURL);this.generalSearchParams=new esri.tasks.Query;this.generalSearchParams.returnGeometry=!1;this.generalSearchParams.outSpatialReference=this.mapObj.mapInfo.map.spatialReference;this.generalSearchParams.outFields=[b.objectIdField].concat(this.searchFields);this.objectSearchParams=new esri.tasks.Query;this.objectSearchParams.returnGeometry=
!0;this.objectSearchParams.outSpatialReference=this.mapObj.mapInfo.map.spatialReference;this.objectSearchParams.outFields=["*"];e=this.mapObj.mapInfo.itemInfo.itemData.operationalLayers;c.some(e,function(b){return b.title===h.searchLayerName?(g=new v(b.popupInfo),!0):!1});this.mapObj.setPopup(g);this.log("Search layer "+this.searchLayerName+" set up for queries");this.ready.resolve(this);this.inherited(arguments);return}}catch(m){a=m.toString()}d='"'+(this.searchLayerName||"")+'"<br>';d+=a+"<br><hr>";
d+=this.checkForSubstitution("@prompts.mapLayers")+"<br><ul>";c.forEach(this.mapObj.getLayerNameList(),function(b){d+='<li>"'+b+'"</li>'});d+="</ul>";this.log(d,!0);this.ready.reject(this);this.inherited(arguments)},checkPrerequisites:function(){var b,a=this;if(this.searchFields&&0<this.searchFields.length)b=this.searchFields.split(","),this.searchFields=[],c.forEach(b,function(b){a.searchFields.push(b.trim())});else throw this.log("missing search fields"),"missing search fields";},search:function(b,
a,d){var f,e="",g,h="";!0===this.caseInsensitiveSearch?(f=b.toUpperCase(),g="UPPER(${0}) LIKE '"+this.searchPattern+"'"):(f=b,g="${0} LIKE '"+this.searchPattern+"'");f=f.replace(/'/g,"''");c.forEach(this.searchFields,function(b){e=e+h+dojo.string.substitute(g,[b,f]);h="  OR  "});0<e.length&&(this.generalSearchParams.where=e,this.searcher.execute(this.generalSearchParams,a,d))},toList:function(b,a){var d=this,f=[],e,g,h=a.toUpperCase();b&&(b.features&&0<b.features.length)&&(c.forEach(b.features,function(b){g=
"";c.some(d.searchFields,function(a){return b.attributes[a]&&(e=b.attributes[a].toString(),0<=e.toUpperCase().indexOf(h))?(g=e,!0):!1});""===g&&(g="result");f.push({label:g,data:b.attributes[d.objectIdField]})}),f.sort(d.sortByLabel));return f},publish:function(b,a){var c,d,f=this;this.busyIndicator&&this.busyIndicator.setIsVisible(!0);this.objectSearchParams.where=this.objectIdField+"="+a;this.searcher.execute(this.objectSearchParams,function(a){a&&a.features&&0<a.features.length?(c=a.features[0],
d=f.publishPointsOnly?f.getRepresentativePoint(c.geometry):c,f.publishMessage(b,d)):f.log("LGSearchFeatureLayer_1: no results");f.busyIndicator&&f.busyIndicator.setIsVisible(!1)},function(b){f.log("LGSearchFeatureLayer_2: "+b.message);f.busyIndicator&&f.busyIndicator.setIsVisible(!1)})}});dojo.declare("js.LGSearchMultiplexer",js.LGSearch,{constructor:function(){var b=this,a;this.ready=new k;a=this.createSearchersList();(new g(a)).then(function(a){c.every(a,function(b){return b[0]})?b.ready.resolve(b):
b.ready.reject(b)})},createSearchersList:function(){var b=this,a=[];this.searchers=[];this.searchers=[];this.searcherNames&&c.forEach(this.searcherNames,function(c){if(c=b.lgById(c))b.searchers.push(c),a.push(c.ready)});return a},search:function(b,a,d){var f=[],e=[];c.forEach(this.searchers,function(a,d){var g=new k;e.push(g);a.search(b,function(e){e=a.toList(e,b);e=c.map(e,function(b){return{data:{iSearcher:d,itemData:b.data},label:b.label}});f=f.concat(e);g.resolve()},function(b){g.reject(b)})});
(new g(e)).then(function(b){var e=!0;d&&(e=!c.some(b,function(b){return!b[0]?(d(b[1]),!0):!1}));e&&a&&a(f)})},toList:function(b){return b},publish:function(b,a){this.searchers[a.iSearcher].publish(b,a.itemData)}});dojo.declare("js.LGSearchFeatureLayerMultiplexer",js.LGSearchMultiplexer,{createSearchersList:function(){var b=this,a=[],d=[];this.searchers=[];this.searchLayerName&&(d=this.searchLayerName.split(","));c.forEach(d,function(c){c=new js.LGSearchFeatureLayer({app:b.app,commonConfig:b.commonConfig,
i18n:b.i18n,webmap:b.webmap,rootId:b.rootId+"_"+b.searchers.length,parentDiv:b.parentDiv,dependencyId:b.dependencyId,busyIndicator:b.busyIndicator,publishPointsOnly:b.publishPointsOnly,searchPattern:b.searchPattern,caseInsensitiveSearch:b.caseInsensitiveSearch,searchLayerName:c.trim(),searchFields:b.searchFields});b.searchers.push(c);a.push(c.ready)});return a}});dojo.declare("js.LGSearchBoxByText",js.LGDropdownBox,{constructor:function(){var b=this,a,f,e,g,k,p,n;a=this.rootId+"_entry";h.create("label",
{"for":a,innerHTML:this.checkForSubstitution(this.showPrompt)},this.rootId);this.searchEntryTextBox=(new l({id:a,value:"",trim:!0,placeHolder:this.hint,intermediateChanges:!0})).placeAt(this.rootId);d.set(this.searchEntryTextBox.domNode,"width","99%");a=h.create("div",{className:this.resultsListBoxClass},this.rootId);f=h.create("table",{className:this.resultsListTableClass},a);e=h.create("tbody",{className:this.resultsListBodyClass},f);touchScroll(a);g=this.lgById(this.searcher);k="";p=0;n=null;m(this.searchEntryTextBox,
"change",function(){var a=b.searchEntryTextBox.get("value");k!==a&&(k=a,h.empty(e),clearTimeout(n),0<a.length&&(n=setTimeout(function(){var d,f,l;d=h.create("tr",null,e);h.create("td",{className:b.resultsListSearchingClass},d);f=p=(new Date).getTime();g.search(a,function(d){f<p||(h.empty(e),d=g.toList(d,a),l=(new Date).getTime(),b.log("retd "+d.length+" items in "+(l-f)/1E3+" secs"),0<d.length&&c.forEach(d,function(a){var c;c=h.create("tr",null,e);c=h.create("td",{className:b.resultsListEntryClass,
innerHTML:a.label},c);b.applyTheme(!0,c);m(c,"click",function(){g.publish(b.publish,a.data)})}))},function(a){b.log("LGSearchBoxByText_1: "+a.message);k="";h.empty(e)})},1E3)))})},toggleVisibility:function(){this.inherited(arguments);this.getIsVisible()&&this.searchEntryTextBox.focus()}});dojo.declare("js.LGShare",js.LGObject,{constructor:function(){var b=this;this.busyIndicator&&(this.busyIndicator=this.lgById(this.busyIndicator));this.subscribeToMessage(this.trigger,function(){b.share()})},share:function(){var b=
this,a,c;a=encodeURIComponent(this.getSubject());c=encodeURIComponent(this.getUrlToShare());this.tinyURLServiceURL&&0<this.tinyURLServiceURL.length?(this.busyIndicator&&this.busyIndicator.setIsVisible(!0),c=esri.substitute({url:c},this.tinyURLServiceURL),esri.request({url:c,handleAs:"json"},{useProxy:!1}).then(function(c){var d,f;try{if(d=b.followAttributePath(c,b.tinyURLResponseAttribute))f=esri.substitute({subject:a,url:d},b.shareUrl),b.publishMessage(b.publish,f)}catch(e){b.log("LGShare_1: "+e.toString())}b.busyIndicator&&
b.busyIndicator.setIsVisible(!1)},function(a){b.log("LGShare_2: "+a.toString());b.busyIndicator&&b.busyIndicator.setIsVisible(!1)})):(c=esri.substitute({subject:a,url:c},this.shareUrl),this.publishMessage(this.publish,c))},getSubject:function(){return""},getUrlToShare:function(){return this.getAppUrl()},getAppUrl:function(){return window.location.toString()}});dojo.declare("js.LGShareAppExtents",[js.LGShare,js.LGMapDependency],{getSubject:function(){var b="";this.subject&&(b=this.checkForSubstitution(this.subject));
return b},getUrlToShare:function(){var b=this.getAppUrl();return b+(0>b.indexOf("?")?"?":"&")+this.getMapExtentsArg()},getMapExtentsArg:function(){return"ex="+this.mapObj.getMapExtentsAsString()}});dojo.declare("js.LGFilterLayers1",js.LGMapBasedMenuBox,{constructor:function(){this.layers=[]},onDependencyReady:function(){var b;this.fieldname1&&(c.forEach(this.mapObj.mapInfo.itemInfo.itemData.operationalLayers,a.hitch(this,function(b){var a;if(b.layerObject&&"Feature Layer"===b.layerObject.type)for(a=
0;a<b.layerObject.fields.length;a+=1)if(b.layerObject.fields[a].name===this.fieldname1){b={layerObject:b.layerObject,fieldType:b.layerObject.fields[a].type};this.layers.push(b);break}})),this.applyFilter(),h.create("label",{innerHTML:this.hint1},h.create("div",{},this.rootId)),b=(new l({id:this.rootId+"_field1",value:this.value1,trim:!0,placeHolder:this.hint1,intermediateChanges:!0})).placeAt(this.rootId),d.set(b.domNode,"width","99%"),this.tooltip&&b.set("title",this.checkForSubstitution(this.tooltip)),
m(b,"change",a.hitch(this,function(){this.value1=b.value.trim();this.onValueChanged()})))},onValueChanged:function(){this.applyFilter()},applyFilter:function(){c.forEach(this.layers,a.hitch(this,function(b){this.setLayerDefinitionExpression(b.layerObject,b.fieldType);b.layerObject.clearSelection()}))},setLayerDefinitionExpression:function(b,a){var c=b.defaultDefinitionExpression;try{this.value1&&""!==this.value1&&("esriFieldTypeString"===a?c=f.substitute(this.defnExpression,{fieldname1:this.fieldname1,
value1:"'"+this.value1+"'"}):"esriFieldTypeInteger"===a&&(c=f.substitute(this.defnExpression,{fieldname1:this.fieldname1,value1:this.value1}))),b.setDefinitionExpression(c)}catch(d){}}});dojo.declare("js.LGFilterLayers1WithDefaults",[js.LGFilterLayers1,js.LGDefaults],{constructor:function(){this.changeDefaults()},onValueChanged:function(){this.inherited(arguments);this.changeDefaults()},changeDefaults:function(){this.defaultValues.value1=this.value1;this.defaultValues.fieldname1=this.fieldname1;this.inherited(arguments)}})})},
"js/lgonlineDrawing":function(){define("js/lgonlineDrawing",["dojo/Deferred","dojo/_base/Color","js/lgonlineMap"],function(h,n){dojo.declare("js.LGHighlighter",[js.LGObject,js.LGMapDependency],{onDependencyReady:function(){var h,k,g=this;this.highlighterLayer=g.mapObj.createGraphicsLayer("highlighterLayer");this.lineHiliteColor=new n(this.lineHiliteColor?this.lineHiliteColor:"#0000ff");this.fillHiliteColor=new n(this.fillHiliteColor?this.fillHiliteColor:[0,0,255,0.1]);this.intervalID=this.intervalTerminator=
null;this.subscribeToMessage("highlightItem",function(d){var e,c,a;d&&(e=d.geometry?d.geometry:d,d.attributes&&(c=d.attributes),d.infoTemplate&&(a=d.infoTemplate),d=g.createHighlightGraphics(e,c,a),0<d.length&&(k=(h=e.getExtent())?h.getCenter():e,g.showHighlight(d,k,g.highlightZoomLevel,c&&g.showFeaturePopup)))})},createHighlightGraphics:function(h,k,g){var d,e=[];if("polyline"===h.type)e.push(new esri.Graphic(h,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,this.lineHiliteColor,
3),k,g));else if("point"===h.type){if(!h.x||!h.y||isNaN(h.x)||isNaN(h.y))return e;for(d=0;4>=d;++d)e.push(new esri.Graphic(h,new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_CIRCLE,2.5*(d+16),new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color(this.lineHiliteColor),3),new dojo.Color([0,0,0,0])),k,g))}else h.type&&e.push(new esri.Graphic(h,new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,
this.lineHiliteColor,3),this.fillHiliteColor),k,g));return e},showHighlight:function(m,k,g,d){var e,c,a,f,l=this;k?e=this.mapObj.centerAt(k):(e=new h,e.resolve());e.then(function(){g?c=l.mapObj.setZoom(g):(c=new h,c.resolve());c.then(function(){1<m.length?(l.intervalTerminator&&(clearTimeout(l.intervalTerminator),clearInterval(l.intervalID)),a=0,f=!0,l.intervalID=setInterval(function(){l.highlighterLayer.clear();l.highlighterLayer.add(m[a]);f?++a:--a;a===m.length?(f=!1,--a):0>a&&(f=!0,a=0)},120),
l.intervalTerminator=setTimeout(function(){clearInterval(l.intervalID);l.intervalTerminator=null;l.intervalID=null;l.highlighterLayer.clear()},5E3)):(l.highlighterLayer.clear(),l.highlighterLayer.add(m[0]));l.toBoolean(d,!0)&&l.mapObj.showPopupWithFeature(k,m[0])})})}})})},"js/lgonlineEditing":function(){define("js/lgonlineEditing","dojo/dom-construct dojo/on dojo/_base/array dojo/_base/lang dojo/aspect esri/dijit/editing/TemplatePicker esri/dijit/editing/Editor js/lgonlineBase js/lgonlineMap js/lgonlineCommand".split(" "),
function(h,n,m,k,g,d,e){dojo.declare("js.LGEditTemplatePicker",js.LGMapBasedMenuBox,{constructor:function(){var c;c=dojo.byId(this.colorizerId).getLGObject();c=".templatePicker{border:1px solid transparent!important;}.templatePicker .dojoxGrid{background-color:transparent;}.templatePicker .dojoxGrid .dojoxGridScrollbox{background-color:transparent;}.templatePicker .dojoxGrid .dojoxGridRow{background-color:transparent;}.templatePicker .dojoxGrid .dojoxGridCell{border:1px solid transparent}.templatePicker .dojoxGrid .dojoxGridRow{border:1px solid transparent}.templatePicker .grid .dojoxGridRowOver{background-color:transparent;color:inherit;}.templatePicker .grid .dojoxGridRowOver .dojoxGridCell{background-color:transparent;color:inherit;}.templatePicker .dojoxGrid .dojoxGridCellFocus{border:1px solid transparent!important;}.templatePicker .dojoxGrid .dojoxGridRowOdd{background-color:transparent;}.templatePicker .dojoxGrid .selectedItem{border:1px solid transparent!important;color:"+
c.foregroundColor()+"!important;background-color:"+c.alternateBackgroundColor()+"!important}";this.injectCSS(c)},onDependencyReady:function(){var c=this,a,f,l;a=this.mapObj.mapInfo;this.layerInfos=[];this.layers=[];m.forEach(a.itemInfo.itemData.operationalLayers,k.hitch(this,function(a){var c=a.layerObject;c instanceof esri.layers.FeatureLayer&&c.isEditable()&&!(a.capabilities&&"Query"===a.capabilities)&&(this.layerInfos.push({featureLayer:c}),this.layers.push(c))}));0===this.layers.length?this.setShowable(!1):
(f=a.map,this.setIsVisible(!1,!0),a=h.create("div",{className:this.templatePickerHolderClass}),h.place(a,this.rootId),l=h.create("div"),h.place(l,a),l=new d({featureLayers:this.layers,rows:"auto",columns:2,grouping:!0},l),l.startup(),touchScroll(a),this.setIsVisible(!1,!1),f={map:f,templatePicker:l,toolbarVisible:!1,layerInfos:this.layerInfos},l=h.create("div"),h.place(l,a),a=new e({settings:f},l),a.startup(),g.before(a,"_applyEdits",function(a){m.forEach(a,function(a){a.adds&&c.preprocessEditAdds(a);
a.updates&&c.preprocessEditUpdates(a);a.deletes&&c.preprocessEditDeletes(a)})}));this.inherited(arguments)},preprocessEditAdds:function(c){return c},preprocessEditUpdates:function(c){return c},preprocessEditDeletes:function(c){return c}});dojo.declare("js.LGEditTemplatePickerWithDefaults",[js.LGEditTemplatePicker,js.LGDefaults],{preprocessEditAdds:function(c){c.adds[0].attributes[this.defaultValues.fieldname1]=this.defaultValues.value1;return c}});dojo.declare("js.LGEditAttributes",[js.LGObject,js.LGMapDependency],
{onDependencyReady:function(){this.inherited(arguments);this.clickHandle=this.subscribeToMessage("mapClick",function(c){console.log(c.type)})}})})},"js/lgonlineFrame":function(){define("js/lgonlineFrame","dojo/dom-construct dojo/on dojo/dom-style dojo/_base/array dojo/_base/lang js/lgonlineBase".split(" "),function(h,n,m,k,g){dojo.declare("js.LGColorizer",js.LGObject,{constructor:function(){var d,e="",c=this,a=["#fff","#333333","#5d5d5d","#5d5d5d"];this.colors=[];k.some(this.colorTable,function(a){return c.theme===
a.theme?(c.colors=a.colors,!0):!1});if(this.colors.length<a.length)for(d=this.colors.length;d<a.length;d+=1)this.colors.push(a[d]);e+=".appTheme{color:"+this.colors[0]+";background-color:"+this.colors[1]+"}";e+=".appTheme2{color:"+this.colors[0]+";background-color:"+this.colors[3]+"}";e+=".appThemeHover:hover{background-color:"+this.colors[2]+"}";this.injectCSS(e)},foregroundColor:function(){return this.colors[0]},backgroundColor:function(){return this.colors[1]},hoverColor:function(){return this.colors[2]},
alternateBackgroundColor:function(){return this.colors[3]}});dojo.declare("js.LGFrame",js.LGGraphic,{constructor:function(){var d;d={};this.headerDivId&&(d.id=this.headerDivId);this.headerDivClass&&(d.className=this.headerDivClass);this.headerDiv=h.create("div",d,this.rootDiv);this.applyTheme(!1,this.headerDiv);d={};this.contentDivId&&(d.id=this.contentDivId);this.contentDivClass&&(d.className=this.contentDivClass);this.contentDiv=h.create("div",d,this.rootDiv);this.handleWindowResize()},handleWindowResize:function(){this.inherited(arguments);
this.resizeContentDiv()},resizeContentDiv:function(){var d,e,c;this.headerDiv&&this.contentDiv&&(d=dojo.marginBox(this.rootDiv),e=dojo.marginBox(this.headerDiv),c=d.h-e.h,0<c&&(c={},c.top=e.h+"px",c.height=d.h-e.h+"px",m.set(this.contentDiv,c)))}});dojo.declare("js.LGGallery",js.LGGraphic,{constructor:function(){var d,e=this;d=h.create("table",null,this.rootDiv);this.applyTheme(!1,d);n(window,"resize",g.hitch(this,this.handleParentResize));this.rootDiv.getContentDiv=function(){return e.addItem()};
d=h.create("tbody",null,d);this.galleryRow=h.create("tr",null,d);d={innerHTML:"&lt;",style:{visibility:"hidden"}};this.arrowClass&&(d.className=this.arrowClass);this.leftArrow=h.create("td",d,this.galleryRow);this.applyTheme(!0,this.leftArrow);n(this.leftArrow,"click",g.hitch(this,this.shiftLeft));d.innerHTML="&gt;";this.rightArrow=h.create("td",d,this.galleryRow);this.applyTheme(!0,this.rightArrow);n(this.rightArrow,"click",g.hitch(this,this.shiftRight));this.zeroItemWidth=dojo.marginBox(this.rootDiv).w;
this.numItemsToDisplay=this.iFirstItem=this.numItems=this.itemWidth=0;this.firstItem=null;this.handleParentResize()},addItem:function(d){var e;e={};"string"===typeof d&&(e.innerHTML=d);this.itemClass&&(e.className=this.itemClass);e=h.create("td",e);"string"!==typeof d&&e.appendChild(d);this.galleryRow.insertBefore(e,this.rightArrow);this.numItems+=1;this.firstItem||(this.firstItem=e,this.itemWidth=dojo.marginBox(e).w);this.handleParentResize();return e},clearItems:function(){for(;2<this.galleryRow.childNodes.length;)this.galleryRow.removeChild(this.galleryRow.childNodes[1]);
this.numItemsToDisplay=this.iFirstItem=this.numItems=0;this.firstItem=null;this.handleParentResize()},handleParentResize:function(){var d,e;0===this.zeroItemWidth&&(this.zeroItemWidth=dojo.marginBox(this.rootDiv).w);d=dojo.marginBox(this.rootDiv.parentNode).w;e=this.zeroItemWidth+this.numItems*this.itemWidth;0!==this.numItems&&(e>d?(this.leftArrow.style.visibility="visible",this.rightArrow.style.visibility="visible",this.numItemsToDisplay=Math.max(Math.floor((d-this.zeroItemWidth)/this.itemWidth),
1)):(this.leftArrow.style.visibility="hidden",this.rightArrow.style.visibility="hidden",this.numItemsToDisplay=this.numItems),this.iFirstItem=Math.min(this.iFirstItem,this.numItems-this.numItemsToDisplay),this.drawGallery())},shiftLeft:function(){this.iFirstItem=Math.min(this.iFirstItem+1,this.numItems-this.numItemsToDisplay);this.drawGallery()},shiftRight:function(){this.iFirstItem=Math.max(this.iFirstItem-1,0);this.drawGallery()},drawGallery:function(){var d,e=this.iFirstItem,c=this.iFirstItem+
this.numItemsToDisplay,a=this.firstItem;this.leftArrow.style.visibility="hidden";this.rightArrow.style.visibility="hidden";for(d=0;d<e;)this.rightArrow.style.visibility="visible",a.style.display="none",a=a.nextSibling,d+=1;for(;d<c;)a.style.display="",a=a.nextSibling,d+=1;for(;d<this.numItems;)this.leftArrow.style.visibility="visible",a.style.display="none",a=a.nextSibling,d+=1;this.handleWindowResize()}});dojo.declare("js.LGTitleBar",js.LGGraphic,{constructor:function(){var d;this.iconUrl&&0<this.iconUrl.length&&
(d={src:this.iconUrl},this.iconClass&&(d.className=this.iconClass),h.create("img",d,this.rootDiv));this.title&&0<this.title.length&&(d={innerHTML:this.title},this.titleClass&&(d.className=this.titleClass),h.create("span",d,this.rootDiv),document.title=this.title);this.handleWindowResize()}})})},"js/lgonlineMap":function(){define("js/lgonlineMap","dojo/dom-construct dojo/on dojo/_base/lang dojo/_base/array dojo/Deferred esri/arcgis/utils esri/dijit/Popup js/lgonlineBase".split(" "),function(h,n,m,
k,g,d,e){dojo.declare("js.LGMapDependency",js.LGDependency,{onDependencyPrep:function(c){this.mapObj=c;this.inherited(arguments)}});dojo.declare("js.LGMap",js.LGGraphic,{constructor:function(){var c,a=null,f=this;this.ready=new g;c={ignorePopups:this.toBoolean(this.ignorePopups,!1)};c.mapOptions=this.mapOptions||{};c.mapOptions.showAttribution=!0;this.popup=new e(null,h.create("div"));c.mapOptions.infoWindow=this.popup;if(this.xmin&&this.ymin&&this.xmax&&this.ymax)try{a={xmin:this.xmin,ymin:this.ymin,
xmax:this.xmax,ymax:this.ymax,spatialReference:{}},a.spatialReference.wkid=this.wkid?Number(this.wkid):102100,a=new esri.geometry.Extent(a)}catch(k){a=null}this.ex&&(a=this.getExtentsFromString(this.ex));this.commonConfig&&this.commonConfig.bingMapsKey&&(c.bingMapsKey=this.commonConfig.bingMapsKey);this.webmap&&(this.mapId=this.webmap);d.createMap(this.mapId,this.rootDiv,c).then(function(c){f.mapInfo=c;c.map.spatialReference||(f.mapInfo.map.spatialReference=new esri.SpatialReference(102100));n(window,
"resize",m.hitch(f.mapInfo.map,function(){f.mapInfo.map.resize();f.mapInfo.map.reposition()}));a&&(a.spatialReference.wkid!==f.mapInfo.map.spatialReference.wkid?esri.config.defaults.geometryService?(c=new esri.tasks.ProjectParameters,c.geometries=[a],c.outSR=f.mapInfo.map.spatialReference,esri.config.defaults.geometryService.project(c).then(function(c){a=c[0];f.mapInfo.map.setExtent(a)})):f.log("LGMap_1: Need geometry service to convert extents from wkid "+a.spatialReference.wkid+" to map's "+f.mapInfo.map.spatialReference.wkid):
f.mapInfo.map.setExtent(a));f.tempGraphicsLayer=f.createGraphicsLayer("tempGraphicsLayer");f.positionHandle=f.subscribeToMessage("position",function(a){var c;a.spatialReference.wkid===f.mapInfo.map.spatialReference.wkid?f.publishMessage("highlightItem",a):4326===a.spatialReference.wkid&&102100===f.mapInfo.map.spatialReference.wkid?(a=esri.geometry.geographicToWebMercator(a),f.publishMessage("highlightItem",a)):esri.config.defaults.geometryService?(c=new esri.tasks.ProjectParameters,c.geometries=[a],
c.outSR=f.mapInfo.map.spatialReference,esri.config.defaults.geometryService.project(c).then(function(c){a=c[0];f.publishMessage("highlightItem",a)})):f.log("LGMap_1: Need geometry service to convert position from wkid "+a.spatialReference.wkid+" to map's "+f.mapInfo.map.spatialReference.wkid)});f.showFeatureHandle=f.subscribeToMessage("showFeature",function(a){f.popupTemplate&&(a.infoTemplate=f.popupTemplate);f.publishMessage("highlightItem",a)});f.clickHandle=n(f.mapInfo.map,"click",function(a){f.publishMessage("mapClick",
a.mapPoint)});f.ready.resolve(f)},function(){f.ready.reject(f)})},mapInfo:function(){return this.mapInfo},setPopup:function(c){this.popupTemplate=c},showPopupWithFeature:function(c,a){this.popup.clearFeatures();this.popup.setContent(a.getContent());this.mapInfo.map.infoWindow.show(this.mapInfo.map.toScreen(c))},setExtent:function(c){return this.mapInfo.map.setExtent(c)},centerAt:function(c){return this.mapInfo.map.centerAt(c)},setZoom:function(c){var a=this.mapInfo.map.getMinZoom(),d=this.mapInfo.map.getMaxZoom();
0<=a&&0<=d&&(c=Math.max(a,Math.min(d,c)));return this.mapInfo.map.setZoom(c)},getMapExtentsAsString:function(){var c="";this.mapInfo&&this.mapInfo.map&&(c=this.getStringFromExtents(this.mapInfo.map.extent));return c},getStringFromExtents:function(c){var a=c.xmin.toFixed().toString()+","+c.ymin.toFixed().toString()+","+c.xmax.toFixed().toString()+","+c.ymax.toFixed().toString();(c=c.spatialReference)&&(c.wkid?a=a+","+c.wkid.toString():c.wkt&&(a=a+","+encodeURIComponent(c.wkt)));return a},getExtentsFromString:function(c){var a,
d=null,e;a=c.split(",");if(1===a.length){var g=c.indexOf("PROJCS");0<g?(a=c.substr(0,g).split("%2C"),a[4]=c.substr(g)):a=c.split("%2C")}try{d={xmin:Number(a[0]),ymin:Number(a[1]),xmax:Number(a[2]),ymax:Number(a[3]),spatialReference:{}},4<a.length?(e=Number(a[4]),isNaN(e)?d.spatialReference.wkt=decodeURIComponent(a[4]):d.spatialReference.wkid=e):d.spatialReference.wkid=102100,d=new esri.geometry.Extent(d)}catch(h){d=null}return d},getLayer:function(c){var a;k.some(this.mapInfo.itemInfo.itemData.operationalLayers,
function(d){return d.title===c?(a=d.layerObject,!0):!1});return a},getLayerNameList:function(){var c=[];k.forEach(this.mapInfo.itemInfo.itemData.operationalLayers,function(a){c.push(a.title)});return c},getOperationalLayers:function(){return this.mapInfo.itemInfo.itemData.operationalLayers},createGraphicsLayer:function(c){var a=new esri.layers.GraphicsLayer;a.id=c;return this.mapInfo.map.addLayer(a)},enablePopups:function(){this.mapInfo&&this.mapInfo.clickEventListener&&(this.mapInfo.clickEventHandle=
n(this.mapInfo.map,"click",this.mapInfo.clickEventListener))},disablePopups:function(){this.mapInfo&&this.mapInfo.clickEventHandle&&this.mapInfo.clickEventHandle.remove()}})})},"js/lgonlineOutput":function(){define("js/lgonlineOutput",["dojo/dom-construct","dojo/dom-class","dojo/_base/array","dojo/topic","js/lgonlineBase"],function(h,n,m,k){dojo.declare("js.LGNotes",js.LGObject,{constructor:function(){console&&this.notes&&m.forEach(this.notes,function(g){console.log(g)})}});dojo.declare("js.LGBusy",
js.LGGraphic,{constructor:function(){this.busyImageClass&&n.add(this.rootDiv,this.busyImageClass)}});dojo.declare("js.LGLogBox",js.LGDropdownBox,{constructor:function(){window.gLogMessageBox=this;touchScroll(this.rootDiv)},append:function(g){"string"===typeof g?h.create("div",{innerHTML:g,style:"margin:2px"},this.rootDiv):"object"===typeof g&&null!==g&&this.rootDiv.appendChild(g)}});dojo.declare("js.LGMessageBox",js.LGDropdownBox,{constructor:function(){this.content&&0<this.content.length&&(this.rootDiv.innerHTML=
this.content);touchScroll(this.rootDiv)}});dojo.declare("js.LGPublishEcho",js.LGDropdownBox,{handleTrigger:function(g){this.rootDiv.innerHTML=g.toString();this.setIsVisible(!0)}});dojo.declare("js.LGMessageWatch",js.LGObject,{constructor:function(){var g=this;k.subscribe("publish",function(d){g.showMessage("message from",d)});k.subscribe("receive",function(d){g.showMessage("received by",d)})},showMessage:function(g,d){var e=JSON.stringify(d.data);this.log(g+" "+d.id+': "'+d.tag+'" '+(e||""))}})})}}});
